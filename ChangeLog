ChangeLog for XBoard/WinBoard
-----------------------------

(latest entries created by git log --no-merges --pretty="%ai %an <%ae>:%n%s%n%n%b" vlast.. )

2011-10-02 22:25:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let WB Makefile build non-JAWS version by default

Accidentally the JAWS=2 setting had slipped in with the latest change.

2011-10-02 19:42:20 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix compile errors WinBoard

Unfortunately the patch that made unknown options in settings files
non-fatal forgot to commit the changes in the winboard files for this.

2011-10-01 15:02:30 -0700 Arun Persaud <arun@nubati.net>:
release of version 4.5.3

2011-10-01 14:58:14 -0700 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.

2011-09-29 20:31:23 -0700 Arun Persaud <arun@nubati.net>:
better contrast for XBoard icon on a dark background

2011-09-30 19:04:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Limit width of menu bar in XBoard

This is a rather course hack to prevent that the menu bar well determine
the window width, leaving white space next to the board, for small
square size. Rather than extending the tinyLayout regime, where only the
first letter of the menu names would be printed to save space, this
patch causes a gradual transition, where the number of letters shown
for each menu item goes down with the board width.

2011-09-26 15:44:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress playing of book moves with weight 0

Bookmoves with weight 0 could be played when the sum of the weights
of all moves from the position was 0. So it was not possible to suppress
the only move by giving it weight 0. This is now corrected.

2011-09-22 17:34:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement NVDA support in JAWS version

The patch is included when we set the switch JAWS=2 in the makefile.
Note that compiling with NVDA enabled requires the header file for
the nvdaControllerClient to be present in the winboard directory,
and that this file is not included in the WinBoard sources!

2011-09-10 22:35:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix playing sounds when -soundProgram is empty

It made no sense to just send the names of the sound files to the shell.
So the soundProgram isnow tested for being an empty string, and if so,
PlaySound() is aborted.

2011-09-10 13:50:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix AppendComment

The joining of two comments was not performed correctly if the second
one had the braces yet to be added: the closing brace was not added in
that case.

2011-08-22 22:40:00 -0700 Arun Persaud <arun@nubati.net>:
new developer release

2011-06-08 17:16:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Clear Engine-Output pane when initializing engine

This to prevent output from the previous game hanging there during the
next game, when the engine that is really playing is in book and
doesn't produce thinking output there.

2011-08-20 20:22:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement paging in XBoard Game List

The XBoard Game List window could not display more than ~1900 games,
probably due to limitations to an Xaw listbox. Now the games are listed
in 'pages' of 1000 games, through which one can step by clicking the
"previous page" and "next page" lines at the top or bottom of the listbox.

2011-08-20 19:54:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Better fix of crash on empty game list

An empty list is now replaced by a list containig a simple message.

2011-08-19 19:55:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix use of random in XBoard shuffle dialog

An explicit use of rand() occurred, in stead of the (configured)
place-holder random().

2011-08-07 15:13:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix missing files in file browser

The file browser was throwing away the first two files, assuming
they were "." and "..". Alas, this is no longer true on every Linux.
Now we actuallyc compare for these names, before skipping them.

2011-06-18 12:51:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update window title after last game of match

The result printed behind player names during a match would still be the one
without the game, differing from what the popup would show, which looked
sloppy enough for people to complain about it.

2011-06-29 13:29:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Don't one-click move when legality testing is off


2011-06-22 11:02:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Restore echo after ^C in ICS password


2011-06-17 21:19:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove stray else

Due to an erroneous else, the window parameters of Move History were
not retreived (and thus incorrectly saved) when the Engine Output was up.

2011-06-14 18:47:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make non-existing option in settings file non-fatal

It is rather difficult to recover from a situaton where the settings
file contains an unknown option (e.g. because you downgraded to a
previous version that had fewer options), especially in WinBoard, where
the user settings file is in a hidden folder, and people might not be
able to find it, let alone edit it. By just skipping the line with the
offending option, rather than generating a fatal error, when reading
from a settings file, such options will be automatically purged from the
file as soon as you save settings.
  Small problem is that the user cannot be warned, as the initialization
has not progressed far enough at this point to generate error popups. In
XBoard we can at least print to the console, but in WinBoard there is no
warning at all. But the worst thing that can happen is that new options
in a settings file of a more advanced version will revert to their
defaults.

2011-06-14 18:17:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix default of -remoteUser

This has to be an empty string, rather than NULL, to prevent XBoard from
segfaulting when the -gateway option is used.

2011-06-14 13:32:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -at and -opt options as alternative for @

Windows XP and Vista shortcuts do not display command lines with @ in
them correctly, and these optionsprovide a work-around for that.

2011-06-14 12:46:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix empty-string option values in XBoard


2011-06-14 12:40:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on switching sound in Vista

When choosing a new sound the wave form of the old one was free'ed, but
because built-in sounds are not really malloc'ed, this led to a crash.

2011-06-10 11:58:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix type of shuffleOpenings

This was a Boolean option, and thus accessed by the args.h code as such,
while it was declared as an int (and used in backend.c as such). This
could have led to problems with different endianness.

2011-06-08 18:02:31 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parameter handling in adapter command

A backslash was not considered the end of an option name, which was
fatal for UCCI2WB, which needs %fd\\%fcp in its command line.

2011-06-08 17:20:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix display of last move of last match game

When a game was adjudicated (e.g. because XBoard detected mate) GameEnds
would trigger an exit if it was the last game of the match, and thus
never returned, while the ShowMove was called only after return from
Adjudicate. An extra ToNrEvent is now used in GameEnd in this case to
cause ShowMove to be called before exiting. (Ugly kludge...)

2011-05-14 10:05:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Obey san feature when sending book moves

Book moves were always sent in long algebraic, even when the engine had
said it wanted to receive SAN.

2011-05-08 13:53:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix vscrolling in XBoard Engine-Output window

After clicking the memos they scrolled to the bottom, because SetFocus
put the insertion point at the very end of the text. This behavior is
now reserved for text-edits containing less than 100 characters.

2011-05-08 13:22:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix button sizing in generic popup


2011-05-08 11:28:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
No clearing of Engine-Output memos on stat01


2011-08-12 12:08:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix generic-popup failure after empty engine-settings dialog

The error exit ofthe Engine #N Settings dialog in case of an engine without
options forgot to clear currentCps, with as a result that the generic popup
thought every subsequent popup was an empty one, and kept repeating the
'engine has no options' error message for every dialog.

2011-05-04 15:42:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Display note in stead of empty engine-settings dialog XB


2011-08-19 18:47:13 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on empty Engine Settings dialog

The generic popup was not foolproof against this.

2011-07-27 18:47:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Force Move History refresh after loading/reverting variation

The Move History window was not refreshed after switching to or from
a variation if that variation happened to have the same length as
the main line. Now a change in storedGames since the previous refresh will
force a full refresh to avoid this. For this to work, storedGames
did have to be decremented after ToNrEvent in PopInner, because ToNrEvent
calls HistorySet before the history is restored, so we don't want
it to snatch away the full refresh. A call to HistorySet had to be
added after PopInner is done restoring the move history.

2011-07-27 17:45:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Popdown Comment window on new game

What is in this window cannot possibly remain valid, and can even be harmful.

2011-07-21 18:38:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix translation of spoken composite messages

The JAWS version composes messages to speak from piece names and numbers,
and the resulting messages will not be in the language file. So translation
has to be applied not on the total message in SayString, but on the
atoms from wich itis synthesized.

2011-07-20 15:29:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix translatability of Spartan Chess menu item WB


2011-07-20 15:22:13 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove some duplicats from WB language template file


2011-07-20 15:10:52 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Create some space in WB dialogs for translations


2011-06-29 13:00:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix JAWS reading of Engine Settings dialog

Group boxes are suppressed, as JAWS turns out to be allergic to them
(always reading the entire content of the group box when an item in it
is selected). Put 'browse' on the browse buttons, even though it does
not fit (JAWS reads it anyway). All conditionalon the JAWS flag.

2011-06-29 12:58:13 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Unfinished sound during ICS examining


2011-06-23 21:18:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reorder controls in Engine Setings dialog WB

To get tabbing through the controls in left-to-right order, they are
now added to the template structure in that order.

2011-06-23 14:02:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add tab stops in WB generic popup

The WinBoard generic popup did not put tab stops on push buttons,
including the OK and cancel button, with as a consequence that these were
skipped when tabbing through the dialog controls. In addition the tabbing
could not begin before the user selected one of the controls with the mouse.
  Now all buttons have tab stops, and the cancel button is given focus
when the dialog pops up.

2011-05-04 10:07:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Silence more rpm warnings


2011-05-02 15:00:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix zippy-partner bug

When ZippyControl matched something that the colorizaton code did not,
it was parsed multiple times, slowly being eaten away from the beginning.

2011-05-01 20:33:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix warnings XBoard file browser

All the prototypes have been moved to selfile.h, to force uniformity.
The order of the #include files xstat.h and selfile.h had to be
swapped, to make sure 'struct stat' is a nown type atthe time of
prototype declaration. The event handler SFmotionList is considered
wrong type because of its third argument (XMotionEvent in stead of
XEvent), and had to be casted to (XtEventHandler) when passed to
XtAddEventHandler.

2011-05-01 19:12:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some warnings and header-file improvement

Ther were lot of 'extern' declarations in the x-files, so called
'imports from xboard.c', (sometimes backend.c) which logically belonged
in xboard.h (backend.h) to ensure their uniform definition. These have
now been moved there. Some prototypes have been added in xboard.h as
well, for functions that needed calling from xoptions.c.

2011-04-29 23:23:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Engine Settings button options in WinBoard

Due to a leftover statement from debugging the -file and -path options
patch, the buttons were broke.

2011-04-25 00:06:09 -0700 Arun Persaud <arun@nubati.net>:
release of version 4.5.2


2011-04-25 00:04:33 -0700 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.

2011-04-19 15:15:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix gettext macros in option dialogs

The strings in the tables were using _() in stead of N_().

2011-04-19 15:07:31 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix shogipixmaps

Some pixmaps forptomoted pieces had wrong background color, others had a
wrong name (so the one with the correct name was missing).

2011-04-19 08:27:38 -0700 Arun Persaud <arun@nubati.net>:
new developer release


2011-04-18 20:58:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on using Engine #1 Settings in ICS non-zippy mode

If XBoard is compiled with zippy the Engine #1 Settings menu was not
grayed out even when you don't run in zippy mode, and using it would
then crash XBoard.

2011-04-17 19:12:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Change texture-install directory to pixmaps/textures


2011-04-17 17:36:32 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Limit install of sound files to those in menu

The sounds directory is set to .../xboard/sounds, and only ten
sounds are kept (all non-spoken).

2011-04-17 17:27:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove some bitmaps from install

Some files in the bitmaps source directory need not be installed,
because they are there only to be linked to the binary in a build
without LIBXPM, are README files or conversion programs. I left only the
stuff that is in a Debian binary package in .../xboard/bitmaps.xchess.

2011-04-17 16:34:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Configure some default sounds

The move sound is set to Wood Thunk; the sounds for tell and challenge
events to Phone and Gong, respectively.

2011-04-17 16:17:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Change default sounds in Xboard menu

All spoken sounds are removed now. Thud, Click and Ching are replaced by
Wood Thunk, Slap and Cymbal; Car Horn and Pop are added.

2011-04-16 10:36:31 -0700 Arun Persaud <apersaud@lbl.gov>:
configure: enable silent rules by default


2011-04-16 10:28:16 -0700 Arun Persaud <apersaud@lbl.gov>:
configure: added install directory for bitmaps files: .../games/xboard/bitmaps/default/


2011-04-16 10:25:33 -0700 Arun Persaud <apersaud@lbl.gov>:
configure: added install of sounds in .../games/xboard/sounds/default


2011-04-16 09:54:26 -0700 Arun Persaud <apersaud@lbl.gov>:
configure: renamed bitmapdir to pixmapsdir, since it installed only pixmaps. also changed name of default dir

pixmaps will now be installed under .../games/xboard/pixmaps/default/

2011-04-17 12:46:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make user wav file available for try-out in sound dialog

The GenericReadout was adapted to be able to read a single selected
value, so that the callback to the 'play' button in the sounds dialog
could get the name of the 'user WAV file' without accepting all settings
for the other sounds (which should only happen on 'OK', and might still
be cancelled in stead).

2011-04-16 13:40:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix gamelist highlight

Reopening the gamelist should highlight the current game.

2011-04-16 10:25:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix size limit on 'save as diagram'

In stead of a fixed-size buffer the diagram-save code now uses an
allocated buffer with size calculated from the bitmap parameters to
retreive the bitmap data, so it should work for all sizes.

2011-04-15 19:18:46 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix switching between pixmap and bitmap pieces

There were still several flags that had to be reset when redoing the
graphics initialization. The Debian patch to use a default bitmap
directory when none is given but monoMode is selected or forced, is
moved to a more sensible place, so that it does not disturb matters when
compiled without LIBXPM (when we do have built-in bitmaps).

2011-04-15 15:41:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix running of clock during hash allocation engine

In TwoMachinesEvent we now wait for the second engine to acknowledge the
'ping' after 'new', to make sure it is done allocating hash in reaction
to the preceding 'memory' command, before the clock for the game is
started.

2011-04-15 15:47:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove outline-pieces option from board-options dialog

This option does not exist in XBoard (yet).

2011-04-14 15:59:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file

Descriptions of the new XBoard menu dialogs are included in the docs.

2011-04-14 21:06:49 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reorganize texi description


2011-04-13 13:14:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Block selection of a directory when file is needed

When we are not browsing merely to obtain a name to put in a text edit,
but really must return an open file pointer, selection of a directory
(ending in '/') can no longer be OK'ed in the file browser. (XBoard
tends to segfault when offered garbage for game or position file...)

2011-04-13 12:23:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let double-click select file in file browser

A second click on the already selected entry now has the same effect as
pressing the OK button.

2011-04-12 17:06:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Couple mouse wheel to v-scrolls in file browser

A newly added mouse-wheel event handler was made to call the v-scroll
callback routines with parameters to step one entry. The button-press
handler for the lists themselves was also made to intercept the wheel
events (buttons 4 and 5), to prevent they would select an entry, and
make them scroll in stead as well.

2011-04-13 11:15:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix changing of float setting by generic popup

Changing a float setting (so far the only one is in the Load Options
dalog) did not always work, because the old value was clipped to (int),
so that changing it back to an integer value might erroneously conclude
there was no change.

2011-04-13 16:15:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on closing dialogs in wrong order

When a menu dialog was closed when it still had an open file-browse
daughter, which could be done through the system menu X on the title
bar, later closing of the file browser caused a crash. This is solved by
keeping track of the fact that there is such a daughter through a global
flag, and ignoring the pop-down command if there is one.

2011-04-13 16:33:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix startup focus of board window

When there were open auxiliary windows, these would have focus on
starting up XBoard. The XtSetKeyboardFocus call added in XBoard main()
was ineffective in curing that. It has now been replaced by a call to
XSetInputFocus, which does do the job. By giving input focus to the form
widget, rather than the board widget, XBoard will be immediately
sensitive to all key bindings.

2011-04-13 15:48:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix game-list highight error when filtered (WB)

When the gamelist was filtered, the game that was highlingted was the
n-th game in the list rather than the n-th game in the file, when the
latter was loaded (and n did not exceed the number of filtered games).
This is fixed now by searching for the line in the listbox that starts
with the game number n, rather than taking the n-th line.

2011-04-12 10:13:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix saving of XBoard fonts with spaces in name

SaveFontArg now prints quotes around the saved font string, so that the
general option-argument parser doesnot stop at the first space it sees.

2011-04-10 22:50:32 -0700 Arun Persaud <apersaud@lbl.gov>:
new developer release

2011-04-10 22:47:59 -0700 Arun Persaud <apersaud@lbl.gov>:
updated Changelog, NEWS, etc.

2011-04-10 20:32:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix use of game/position file in first match game

When a match was started from the menu, it was not paying attention to
game and position files. (Later games were.) The code that handled this
in the initialization when a match is started through the command line
was made into a routine MatchEvent, which can be called from the menu
proc too.

2011-04-07 23:19:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix path browsing in WinBoard

The routine BrowseForFolder was still declared as static in woptions.c,
while it was used from wsettings.c.

2011-04-09 20:55:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on opening ICS Text Menu

The patch for the color defaults had broken the ICS Text Menu.

2011-04-06 10:56:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Refinements to generic popup and color picker

*) The text part of a checkbox can now be clicked to toggle the option.
*) Typing <Enter> in single-line text edits is ignored
*) Using a spin button now sets focus to the affected text edit, with
the insert position at the end.
*) Using the sample field or an RGB button sets focus to the
corresponding text edit, with the insert position at the end.
*) The adjust buttons now work in reverse, with a D button for "darker".
*) Editing a color field causes the sample field to update to the new
color when you type <Enter>.
*) The color pickers now define a default color, which can be instated
by clicking on the sample field.
*) Fix some 64-bit pointer warnings

2011-04-05 17:05:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let file browser filter on extension

A new text field is added in the file-browse dialog, to hold (space-
separated) extensions, on which the filenames are then filtered. This
field is initialized by the caller, depending on what we need the file
for, but can be changed by the user. (Directories are always displayed!)
  Changes in the extension field  become effective after typing a return
in it. Escape typed in the extension field gives focus to the filename
field, and restores the contents. Escape in the filename field cancels
the dialog, return ther OKs it. The extension filter of the browser is
initialized to the extension (if any) of the file currently in the text
edit you are browsing for.
  When re-opening the file browser from the XBoard File menu, and there
is no suggested filename, it will now start with the last succesfully
opened name as suggestion. Calling the browser with a NULL argument
for the suggested filename requests that (unlike calling with an empty
string, which will start it in the current directory). To make this
work smoothly, the filebrowser saves the last used name on entry, so it
can be restored on cancel, so that a cancelled browse session really
erases all memory of it.

2011-04-04 19:26:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix animation masks on changing piece pixmaps

The animation masks were not remade when new pieces were loaded
interactively through the board-options dialog.

2011-04-04 19:09:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix linegap option in board dialog

The lineGC was not recalculated, so the grid lines stayed the same
thickness. In addition, setting the line-gap override to -1 now
retrieves the original line gap that belongs to the current board size.

2011-03-05 23:27:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make a kind of ICS text menu in XBoard as a dialog

The dialog with buttons can be opened from the View menu. It is
configured by the option -icsMenu; a default setting for this is
included in the master settings file.
  The commands specified by the -icsMenu can now contain $name and $input
keywords, which will be replaced by the current primary selection, or
text the user types, respectively. Commands that contain $name will not
be sent when the current selection is empty. Commands that do not
contain $input will be sent to the ICS immediately; otherwise they will
be placed in the ICS Input Box, with the cursor at the point of the
$input, and input focus given to the Input Box, so the user can start
typing. When a command is prefixed by "$add " it will be appended to the
existing ICS Input Box contents, rather than replace it.
  The items now have to be separated by ";\n", and button text from
command by ';' (with optional linefeed). This allows configuring of
multi-line commands, as a single linefeed no longer has special
sigificance.

2011-03-31 13:36:05 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo ICS input box with generic popup

This box is just a single text edit, but the complexity is in the added
callbacks. These callbacks remain in xboard.c, and were altered to
access the edit through the option.handle field.

2011-04-03 12:54:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Activate -path and -file options

In XBoard the generic popup was prepared for this. In WinBoard, for
-path options the BrowseFolder routine is used, and had to be made
global (prototype in winboard.h).

2011-04-02 18:40:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let generic popup generate Engine Settings dialog


2011-04-02 18:36:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Merge SettingsPopUp into GenericPopUp

Based on currentCps the values read from the dialog are sent to the
engine, or stored into the option.target in the callback, and fetched
from the option.target in the PopUp. The currentCps is cleared in the
generic popdown of a transient dialog.

2011-03-06 10:11:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make generic dialog popup reentrant

To allow persistent dialogs to be implemented through the generic popup,
it must be possible to have several dialogs open at the same time, and
thus make sure the popdowns under the cacel or close-window button know
which one to pop down. To this end an array shells[] is created that
takes over the function of settingsShell, and GenericPopUp gets an extra
parameter telling it which element to use for storing the dialog shell.
This number is then also passed to the callbacks that trigger popdown.
This was a bit nasty for the CatchDeleteWindow stuff, which passes user
data to the callback as text strings.
Keep a separate up/down indicator, so that shell widgets can be kept
for persistent dialogs. Also keep a currentOption per dialog type.
  The coordinates and size of the window is read out and stored in a
WindowPlacement structure, (if one is specified for that dialog), when
the dialog is popped down. When initialized the structure is also used
to set the window parameters when the dialog is created. (The idea being
that the structure was saved in the settings file.)
  The routine MarkMenu checkmarks a given menu item, and logs it for the
given dialog type, so that a later popdown automatically unchecks is.

2011-02-25 12:14:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement Machine Match menu item and options dialog

An item to start a match from the menu is added, similar to what
WinBoard has. (The code is duplicated, so I guess it should be moved to
the back-end now, as MachineMatchEvent(), but it was tiny.) A dialog in
the Options menu was added with the aid of the generic popup, and allows
the user to set the load Game / Position File and Index.

2011-04-01 14:54:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Create General-Options dialog

The generic popup is used to implement a General-Options dialog, which
contains all Boolaen options that used to be set directly from the main
Options menu, plus a spin option for the flash count and flash rate.
The corresponing options are removed from the main Options menu, but the
whole thing is made conditional on a compiler switch OPTIONSDIALOG.
The dialog needs an OK callback for sending an altered ponder-state to
the engine. (Why isn't this option disabled in -ncp mode, btw?)
A spin control is added to adjust -animateSpeed between 5 and 100.
Add dropMenu and showTargetSquares item as well.

2011-04-01 18:16:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo new-variant dialog with generic popup

Some special code was added in GenericPopUp() to force buttons of the
type needed in the New Variant dialog (wide, colored, greyed-out on
variant type). The dialog was implemented with these, and callbacks for
the buttons directly exit the dialog, without the need for OK. New spin
controls are added to the dialog for adjusting the board format.

2011-04-01 14:48:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Redo common-engine dialog with generic popup

The ponder option was removed, as it is already in the main Options
menu, and would require nastiness in the OK callback. Added book options
in common-engine dialog.

2011-02-24 13:32:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redo adjudications dialog through generic popup

We dropped the periodic-updates option, as it is already in the main
Option menu.

2011-04-01 21:56:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make sounds dialog for XBoard

This uses the combo boxes. A 'play' button isimplemented for a test
sound. A sound directory is introduced, and can be set through the
dialog. A default setting for -soundDirectory is added to xboard.conf.

2011-04-01 23:11:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add ICS options dialog


2011-04-01 21:52:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add board dialog XBoard

The GenericPopUp() is used to implement a dialog for board options. The
board dialog needs to trigger redraw and redefinition of the
colors, through an OK callback. Color-pickers are used for the 6 basic
color settings.
  To allow changing board settings during the session (i.e. from a menu
dialog), the routines to allocate resources have to free the resources
for the previous settings first. This patch take care of XtCreateGCs(),
preventing re-creation of resources that are unchangeable (such as the
grid color), and calling XtReleastGC() on GCs that can be changed.
To prevent resource leaks the old pixmaps are deleted before making new
ones on second or later calls of CreateXPMPieces().

2011-04-03 11:39:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add browse button to generic popup

Options of type FileName and PathName cause a browse button to be added
behind the text field. The SpinCallback is used to handle the
button presses, and invokes the file browser dialog to obtain a
filename, which is then copied to the text field.

2011-04-01 21:49:26 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make generic XBoard popup, and implement 2 dialogs

The Engine-Settings dialog of XBoard was cloned to work on predefined
lists of (XBoard) options, rather than engine options. An extra field
was added to the Option struct, to hold a pointer to the XBoard variable
that should hold the option setting, so on OK'ing the dialog the altered
values can be copied there. Not usable for options which should trigger
an action (like redraw, or sending something to the engine).
A Load Game, Save Game and ICS Options dialog were then defined by
tables fed to GenericPopUp(). Options set from these dialogs were removed
from the main Option menu, which removes a lot of code from xboard.c
(for checkmarking, disabling the menu items).
  A button defined in the GenericPopUp can attain the color indicated
by a previous text field, and add a callback to change the color in a
spin-like manner (but using R G B W in stead of + - butons).
The EndMark option can specify a callback, to be used on OK.
A non-zero max field in the Option descriptor will be used to set the
width of ComboBox, TextBox and Button optons.
The elements are chained such that extra space goes fully into the input
fields. A label type is added for clarifying texts that would not fit in
the option names. A break-type (pseudo-)option is added. Make OK and
cancel button suppressable in generic popup (by 2 bit of the option.min
field).

2011-04-03 11:34:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add file-browser option to just return name

By passing mode "f" the file browser dialog will not open the selected
file at all, so it can be used to retreive the name for the benefit of a
file-browser button to a -file option. A mode "p" will limit the
selection to directories only, to browse for a path.

2011-04-03 13:15:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Put insertion point at end of text on SetFocus


2011-04-05 23:47:34 -0700 Arun Persaud <apersaud@lbl.gov>:
fixed 64 bit warnings by casting integers to intptr_t before casting to int


2011-04-05 23:24:24 -0700 Arun Persaud <apersaud@lbl.gov>:
removed check and #includes for malloc.h, since it's not needed

hopefully this doesn't break things on non-linux systems. OS X seems to be ok, not sure about others ;)

2011-04-03 20:23:49 -0700 Arun Persaud <apersaud@lbl.gov>:
check if malloc.h is present before including it

OS X 10.6 doesn't have malloc.h, so it complained.

2011-04-03 20:01:36 -0700 Arun Persaud <apersaud@lbl.gov>:
Fix bug introduced in commit 89b4744: removed a "/" and forgot to add it in the config file

removed a "/" to make OS X happy, but forgot to add the "/" again in the xboard.conf.in file

2011-03-12 14:08:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix display of promotion piece in ICS superchess

In Great Shatranj and Superchess promoted Pawns were displayed as shadow
piece because these variants had holdings, while captured pieces should
go back into the holdings unchanged, rather than reverted to Pawns.

2011-03-07 23:11:00 -0800 Arun Persaud <apersaud@lbl.gov>:
fixed wrong default for polyglotDir mentioned in docs.

Thanks to Hans Aberg for reporting it.

2011-03-05 12:39:01 -0800 Arun Persaud <apersaud@lbl.gov>:
Fix "make install" on Os X10.6.6 (removed a "/")

seems like an extra "/" made "make install" unhappy

2011-03-02 22:23:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bugs in FRC castling rights

When parsing a castling move in FRC when no rights existed, the parser
returned 0 (= EndOfFile) rather than ImpossibleMove. The recognition of
the absence of rights was not adapted to the new encoding NoRights in
stead of -1.

2011-03-01 23:42:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parsing bug of FRC castling

The code that was supposed to intercept castling when no rights existed
in FRC was not adapted to the new encoding for this by NoRights, rather
than -1, and furthermore returned 0 (= EndOfFile) rather than
ImpossibleMove. Not sure if the former would manifest itself in any
way, but the latter seems bad.

2011-03-01 23:32:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix two bugs in reading position diagram

When reading a game without FEN tag, a position diagram is used to set
the initial position. This calls CharToPiece() with a '.' as argument,
because that is the position-diagram way to indicate empty squares.
altered CharToPiece() over time this would be recognized as the first
undefined piece or, more recently, the first piece without nickName,
which is a white Pawn. Now it returns EmptySquare again in that case.
A second problem was that for position diagrams in braces the brace was
not in the list of ignored characters, and would cause the reading to
get out of phase, so that the side to move was not recognized.

2011-02-26 21:12:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix flipBlack option XBoard with board texture

In XBoard -flipBlack is implemented by swapping white and black pieces,
because the Shogi bitmaps from XShogi are made that way. But the mask
used to cut out the whole in the board texture to fit the piece was not
swapped, both when drawing static pieces, as well as during animation.

2011-02-25 14:38:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Improve repairing damage of arrow highlight XBoard

With line gap the highlight arrow necessitated redrawing of the entire
board, to repair damage on the grid. This interfered with flashing of
pieces, which was only done on selective redraws. In stead of forcing a
total repaint we now just redraw the grid lines.

2011-02-23 16:41:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix unintended translation in debug file

The words "first" and "second" (cps->which) were sometimes used in
context that should definitely not be translated. (e.g. the indicator
for which engine printed/got the line in the debug file.) So translation
is now deferred to all uses in popups.

2011-02-23 16:29:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix nps bug

The nps settingwas tested for being > 0 in stead of >=0, so that the
case of CPU time was not properly handled.

2011-02-24 19:06:27 +0100 Kamil Blank <caceel@gmail.com>:
Added missing fclose()

(tiny change)
Signed-off-by: Arun Persaud <apersaud@lbl.gov>

2011-02-20 16:12:19 -0800 Arun Persaud <apersaud@lbl.gov>:
release of version 4.5.1

2011-02-20 16:10:16 -0800 Arun Persaud <apersaud@lbl.gov>:
updated Changelog, NEWS, etc.

2011-02-20 20:36:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix two typos in option names in texi file

Polyglot was capitalyzed

2011-02-20 00:03:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some resource leaks

Some files were opened not closed in XBoard, when loading XIM images
(which I doubt anyone ever does) but also when copying the clipboard
(which has the potential of being done very often). There was also some
code that would not work if conditional code which is permanently
disabled would be enabled.

2011-02-17 20:17:04 -0800 Arun Persaud <apersaud@lbl.gov>:
new developer release

2011-02-17 20:14:38 -0800 Arun Persaud <apersaud@lbl.gov>:
updated Changelog, NEWS, etc.

2011-02-17 15:40:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix MSVC snprintf problem

In MSVC snprintf has to be redefined as _snprintf, and this happens
conditionally in config.c. But the latter was not #included in help.c.

2011-02-16 19:41:27 -0800 Arun Persaud <apersaud@lbl.gov>:
updated configure.ac to check for Xaw header files

check for Xaw header files when --without-Xaw3d was given. Before the test was
only done when Xaw3d was specified, but could not be found.

If Xaw3d or Xaw can't be found, print a hopefully useful error message and exit the configure script.

2011-02-16 12:03:22 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix ICS channel 0

Channel 0 messages were not displayed in the console, because the test
for channel number considered every non-numeric or non-existent handle
in a chatbox to be zero. So the messages were diverted to a non-exsting
chatbox. Now it test first for the handle to start with a digit.

2011-02-15 19:13:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make language choice from menu persistent

Set appData.language to the chosen language file, or empty if English is
chosen, so that the choice is saved with the settings. Increase the
number of possible language choices from 5 to 20. (After all, we already
have 7 now!)

2011-02-14 11:09:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix showing of user move after adjudication

The correction of the fishy patch (removing ShowMove() from Adjudicate())
had broken the adjudication of user moves (that actually did work before
the fishy patch, because there the gobal fromX/Y and toX/Y do contain
the correct values for the move to be shown). An entered move that led
to adjudication (like a checkmate) now was not displayed at all. Adding
an extra ShowMove() after (successful) return of Adudicate() solves it.

2011-02-13 23:49:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Xiangqi King facing

The Spartan patch had broken the CheckTest for Xiangqi, because cl.check
was cleared after the King-facing test, rather than before it.

2011-02-13 22:30:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix variant janus size prefix

The default board size of Janus Chess was not consistently taken to be
10x8, which resulted the name to be sent as 10x8+0_janus to the engine.

2011-02-13 12:18:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Alfil bug

The test for Alfil (suppressing single steps on the Elephant) contained
a wrong logical operator, so that it could never be active. It also
failed to include Xiangqi as variant with traditional Alfil. This led to
one-step moves of the Elephant in these variants, and false check or
unreliable mate detections.

Fix move of Xiangqi Elephant

2011-02-09 23:19:09 -0800 Arun Persaud <apersaud@lbl.gov>:
fixed configure script to correctly detect Xaw3d library


2011-02-06 22:07:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix unmarked translation

The file-browser wndowtitle in WB was not marked for translation.

2011-02-04 10:27:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put warning in HTML help

A warning is added that the help file is not yet updated for the new
menu organzation.

2011-02-04 10:22:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix 64-bit Windows compilability

The API interface for Set/GetWindowLong has been changed for 64-bit
Windows, both in the name of the call as in the arguments.

2011-02-04 10:21:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix MSVC compilability

Both the makefile and the project file had to be adapted for the new
source file history.c, and the new location of parser.c.

2011-02-05 10:11:58 -0800 Arun Persaud <apersaud@lbl.gov>:
added missing #includes and missing prototypes to filebrowser

thanks to Max Funk for reporting. Now using HAVE_DIRENT_H.

Also cleaned up missing prototypes and some casts.

2011-02-05 09:21:48 -0800 Arun Persaud <apersaud@lbl.gov>:
added missing header file for sprintf


2011-02-03 08:50:50 -0800 Arun Persaud <apersaud@lbl.gov>:
added history.c to the tar-ball. Needed for Winboard


2011-01-31 23:03:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix deselection of greyed-out variant button (WB)

In Windows a disabled radiobutton refuses to deselect when you select
another (enabled) button from the group. There are then 2 buttons
checked, and the code to readout the buttons took the first one. Now it
is changed to take the first enabled one.

2011-02-03 08:28:15 -0800 Arun Persaud <apersaud@lbl.gov>:
Revert "Implement -reset option feature in WinBoard"

This reverts commit efecf86cd9b54072c6a2f38d62f1d775e69c545b.

picked the wrong commit from HGM's git tree.

2011-02-01 22:01:12 -0800 Arun Persaud <apersaud@lbl.gov>:
add DIFFSTAT and SHORTLOG to tar-ball

was only in the v4.4.x branch and not in master

2011-01-30 09:52:15 -0800 Arun Persaud <arun@nubati.net>:
release of version 4.5.0

2011-02-01 07:41:04 -0800 Arun Persaud <apersaud@lbl.gov>:
changed size of borders around squares from 0 to 1 as a default

this way highlights show up again.

2011-01-29 20:11:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement -reset option feature in WinBoard

2011-01-30 10:12:08 -0800 Arun Persaud <arun@nubati.net>:
updated Changelog, NEWS, etc.

2011-01-30 09:56:39 -0800 Arun Persaud <arun@nubati.net>:
updated parser.c form parser.l

2011-01-29 19:59:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Clean up fishy patch

None of the ShowMove() calls in Adjudicate() was working, because when
this code was taken out of HandleMachineMove() it was taken outside the
scope of the local fromX, fromY etc. there, so that it started using the
global variables from the mouse driver. As these usually contain -1,
this suppressed move animation and highlighting. All these calls have
now been removed, and ShowMove() is called after a positive return (from
HandleMachineMove(), so within the correct scope).
This improves the previous fix, which led to some flicker, because the
erroneous ShowMove() calls did draw the new board (instantly), wich in
the fishy patch was then immediately overwritten by the old position, to
start animation. This drawing of the old position is now no longer
needed either.

2011-01-29 13:36:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update RTF file

The RTF file is adapted to the new menu organization.

2011-01-29 13:31:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file

The highlight-with-arrow and one-click-move menu items are described.
The highlightMoveWithArrow and variations option are described.
Load Next /Previous Position descriptions are moved to File menu.
The description for entering variations is updated (using Shift key).
The remark that editing holdings is impossible is removed.
Spartan Chess is added to the list of supported variants.

2011-01-28 18:35:48 -0800 Arun Persaud <arun@nubati.net>:
Updated copyright notice to 2011


2011-01-24 15:01:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Greyout unavailable variants in New Variant dialog

The WB radio-button code is refactored to be driven from a list (which
must be kept in phase with the variant definitions in common.h!). It now
also checks if the first engine supports the variant, and greys out the
item if it isn't. XB now also makes this check. Slight re-ordering of
10x8 variants there, to have the more common on top.
If no radio button is selected, keep old variant even on OK.

2011-01-19 11:10:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Move clock-click code to back-end

Some duplicated (or should-be-duplicated) code for handling clicks on
the clocks from the XBoard and WinBoard front-ends was merged and
relocated to the back-end, so it can be shared. Noticeable was that
XBoard allowed turn change in ICS examine mode by clock clicking,
while WinBoard did not. WB, on the other hand, allowed clock adjustment.

2011-01-16 23:15:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix legality testing of drop moves

Drops of noexistent pieces (i.e. with a piece indicator letter that is
not corresponding to any defined piece) are now parsed as
ImpossibleMove, rather than IllegalMove, so they are also rejected with
legality testing off.

2011-01-17 00:28:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WB Sound Options greyout and remove some grossness

The sound and ICS Options menu items in WB were accessed 'by position',
with fixed defined positions (always messing up any reorganization of
the menus when you forgot to redefine the position constants in
winboard.h). And not only that, but for completely mysterious reasons,
the greying of the sound item greyed out the game-list options (above
it) in stead when it was defined as 9, and the ICS options (below it)
when it was 10 !!!. Now they are addressed 'by command' (and the
position definitions are removed), which fixes things.

2011-01-25 21:35:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Re-instate load next/prev position menu items

As positions do not use something similar to the game list, these are
still useful. For some reason I could not get Alt+Shift+PgUp/Dn to work,
so I settled for Shift+PgUp/Dn.

2011-01-16 21:56:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove superfluous copying of machine move

There was explicit code in HandleMachineMove() and FinishMove() to put
the move in the moveList, while MakeMove() already does this later in a
more reliable way by calling CoordsToComputerAlgebraic(). This
superfluous code is removed now.

2011-01-16 21:44:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix spurious mate test in Edit Game mode

When entering a game, it was terminated by the mate test even when
legality checking was switched off (so that mates might not be reliably
recognized). The mate test is now made dependent on legality testing.

2011-01-16 21:37:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix type-in of drop moves

Drop moves entered through the move type-in already come in the (piece,
DROP_RANK, x, y) format, rather than having a holdings from square. This
caused UserMoveEvent to consider them illegal when testing if the
piecewas of the side to move, and when this was fixed, to recognize
Knight drops as coming from between board and holdings (and thus
illegal).

2011-01-16 21:31:42 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix move type-in truncating game

Starting a new variation by keeping Shift pressed did not work when
OK'ing the move type-in, because there was some code ther that truncated
the game. While this could be safely left to UserMoveEvent, which it
calls, as the situation is not different from entering moves through the
mouse.

2011-01-11 16:12:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix legality testing for promotions

Turns out WB has never tested for the legality of the chosen promotion
piece, and would allow promotion to King innorml chess even with
legality testing on (when entered through the keyboard)! Now strict
testing is done, outlawing Pawns and Kings (or Unicorns in
Knightmate). Only in suicide / giveaway Kings are stillallowed, and in
spartan a black King if you do not have two yet.(And promotion
toLnce,representing Hoplite Pawn,is forbidden there.)

2011-01-11 11:34:07 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reset 50-move counter on all pawn-like Lance moves

Now the Lance represents a Pawn-like piece not only in variant fairy,
but anywhere outside Shogi / Superchess, its moves should also reset the
50-move counter in those cases. Especially important for Spartan Chess,
where the Lance actually participates.

2011-01-11 11:18:15 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix logo repainting

The logos were not repainted when the main window was moved out of the
display area, and then back into view. The reason for this is
unknown, as the PaintProc calls HDCDrawPosition, which was calling
DrawLogoOnDC. But the logos were not drawn, (or on an expose event
sometimes half drawn!) despite the fact that the rest of the board was.
The drawing of logos now has been decoupled from drawing the board,
and has been moved to a separate routine DisplayLogos() (in analogy to
DisplayBothClocks()). This is cleaner anyway, as the logos usually do
not change when the board does. So apart from in PaintProc, it has only
to be called when the mode changes (ModeHighlight()) or on swap clocks.
This seems to fix the problem.

2011-01-10 20:36:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix time in PGN info

Saving of the thinking time in the PGN was broken by the patch that
removed the race condition in the clock switching, because that moved
the incrementing of forwardMostMove to behind the code that used fmm to
index pvInfoList. As a result the time was stored in the slot for the
opponent's previous move. The value is corrected now.

2011-01-09 00:24:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fishy fix

The move that delivers checkmate in two-machines mode is not animated
when adjudication is on. There then also is no highlighting of this move
Redrawing the board and calling ShowMove fixes it. Which is rather
strange, because ShowMove was already called in Adjudicate (when it
adjudicates), before GameEnds. For reasons that are not understood this
call to ShowMove() (which calls AnimateMove()) is not effective.

2011-01-09 00:21:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reset machine colors after match

The colors each engine playse are set to the originals after the last
match game, so that a new match or two-machines game will not have
swapped colors.

2011-01-09 00:15:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reset win/loss counters before match

The win/loss counters were not reset, because the code counted on them
being initialized to zero. But with matches startable from the menu,
this is no longer true after the first match.

2011-01-09 00:08:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Show move that causes false illegal-move claim

Without claim testing XBoard takes back moves that an engine objects to.
But when the engine is forfeited for a false claim, the move should of
course stay. So the claim test is moved to before the take-back.

2011-01-09 00:05:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Spartan promotion to King

Promotions toKing were refused when in check, because XBoard thought
they would not resolve the check. Now the promotion is actually
performed before doing the check test.

2011-01-05 17:31:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WB font-based piece rendering on variant switch

The piece bitmaps were only created from the font characters when the
number of ranks or files changed, because it was done in
InitDrawingSizes(). This caused missing pieces when changing to a
variant on the same board that used other pieces. Now InitDrawingSizes()
is called for any variant switch.

2011-01-05 17:25:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix right-alignment pproblem in WB ICS window

Use of Ctrl-R to summon the context menu still trickled through to the
default text-edit window routine, and caused right-alignment. This was
because the text-edit reacts on keyDown rather than the character event.
KeyDown of R with Ctrl pressed is now also intercepted and ignored.

2011-01-03 13:04:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix chat window title

The title was using the engine name, rather than the ICS handle, which
did not work outside zippy mode. Now it only uses the engine name when
no ICS handle is known. The titleis now also subjected to translation.

2011-01-03 12:50:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix spurious reading of old game title by JAWS

Because focus was switched to the board window before loading the
selected game from the game list, the titlebar still contained the
name of the previously loaded game, which would spontaneously be read by
JAWS. Now the focus switch is done after loading the new game (which
updates the window title.)

2011-01-03 12:37:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add variant Spartan Chess

In the WB menu it takes the place of the defunct Twilight Chess item.
The setup routine needed patching for setting up Lances in stead of
Pawns for black, the check test had to be adapted to handle duple check,
Alfil and Dragon moves were fine tuned in this variant to make the exact
moves, and the promotion popup was adapted to show King and interpret
Rook and Bishop as Dragon and Alfil for black. The Alfil now always
moves as Modern Elephant except in Shatranj and Courier.

2011-01-03 12:23:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix mate test

Due to a bug in logical operators drops were tried for mate evasions
even in non-drop games, which broke it in Superchess and Great Shatranj,
and wasted CPU time in other variants.

2011-01-05 17:19:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix promotion suffixon disambiguated piece moves

The promotion suffixon piecemoves that needed disambiguation was not
passedon to the back-end in most variants. Now it is passed on in any
variant.

2011-01-03 12:08:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix promotion of Pawn-like Lance

In variants where the Lance is used to represent an unorthodox Pawn, it
must promote when it reaches last rank. With legality testing on,
however, the promoChar was ignored in ApplyMove in this case. The
promotion suffix also was not appended in SAN moves.

2011-01-03 11:57:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WB promotion popup

The promotion popup did not work properly in variants where black did
not use the pieces that white wanted to promote to. Now the character
for the selected piece is taken from the piece encodings of the side to
move. In addition, selection of undefined pieces is ignored.

2011-01-02 14:17:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in parsing variations

The moves parsed from a variation were stored in the moveList without
appended linefeed. This caused errors if the variation extended to
beyond the end of the main line,into a hitherto unused part of the move
list, as the linefeed was then not there from the overwritten move. As a
result moves sent to the engine were concatenated, triggering
illegal-move messages and bringing the engine out of phase.

2011-01-02 14:11:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Define Ctrl-R as right-click in WB Comment dialog

To allow JAWS users to load a variation through the keyboard, Ctrl-R is
equated to a right click at the position of the caret or selection.

2011-01-02 14:10:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow starting a variation from keyboard entry in WB-JAWS

The status of the shift key is remembered when space is pressed to
select a board square.

2011-01-02 14:06:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Disable some accelerators in JAWS version

Single-key accelerators that could result in irreversible data loss are
undesirable, because the risk of accidentally pushing them is too large.
So the non-Alt duplicates of next/previous game/position are disabled,
as are Home and End for Revert and Truncate Game. JAWS users will have
to rely on the menus for those functions.

2011-01-02 13:59:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Group engine-output memos with engine names

The engine names are now defined just before the text edits, so that
JAWS 11 will read the engine name when the memo for the output of that
engine is selected. (JAWS 10 will still read the NPS, as it reads in
geometrical order.)

2011-01-02 13:55:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put nr CPU earlier in tab cycle of WB Common Engine dialog

By defining the max CPU control after hash size, the tabbing steps
through the controls in geometrical (and logical) order, rather than
having the max CPU in between the book controls.

2010-12-29 23:47:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update WB language template file


2010-12-29 23:41:27 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Subject JAWS menu and spoken strings to translation


2010-12-29 23:37:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let JAWS SayString buffer full sentence

The meaning of the flag parameter of SayString was changed to indicate
buffering of flushing. On flushing a message of a single space is used
as a kludge to indicate interruptability. Calls to force flushing where
added everywhere.

2010-12-29 23:32:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Adapt JAWS menu to new menu organization

The menus did not correspondto the texts after translation of the main
menu bar.

2010-12-29 23:18:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Translate menus after creation of JAWS menu


2010-12-29 23:07:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix ICS context menu for JAWS

The Ctrl+R key did select text at the mouse pointer in stead of at the
curser, now that up and down-click were combined.

2010-12-29 23:04:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reorganize order of WB New Variant dialog controls

The definitions are re-ordered so that at least JAWS 11 will speak the
board-size elements properly.

2010-12-29 22:57:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix order of elements in WB time-control dialog

Someleading texts were defined after the text edit they referred to,so
that JAWS 11 associated them to the wrong one. A tab stop was added to
the time-odds label, to make JAWS speak it.

2010-12-29 22:51:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change tabbing order in WB sounds dialog

The 'Play' button now gets focus immediately after the controls for
selecting the sound, rather than at the end of the dialog (after OK).

2010-12-29 22:47:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove tab stops on first radio button of WB dialogs

The New Variant and Board dialogs had a tab stop on the first radio
button,so that tabbing toit would automatically select variant
normal or size tiny. Now it tabs straight to the current size, without
changing anything. (Important for JAWS users.)

2010-12-29 22:45:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put OK/Cancel last in tab cycle of some WB dialogs


2010-12-29 22:29:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix duplicate menu character for Edit Comment

Edit Comment did have the same shortcut character as Copy Game. Changed
to m now.

2010-12-11 11:18:56 -0800 Arun Persaud <arun@nubati.net>:
fixed automake process: xboard.conf couldn't be generated if $srcdir was not the current directory


2010-12-11 09:50:48 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2010-12-05 18:01:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Subject WB context menus to translation

The innerloopof the menu translation has been made into a separate
routine. This now uses GetMenuItemInfo() in stead of ModifyMenu() to
better preserve menu breaks. Menu #10 is used for context menus (from
the routine that pops them up), and for this number the orignal texts
are not saved in menuText. (This is not needed, because the menu is
created everytime anew from the resource data.)

2010-12-05 15:00:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update translation template

Add the new menu items; add some notes.

2010-12-05 14:04:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Resize buttons in WB engine-settings dialog

The OK and cancel buttons were to narrow for most translations, and were
a non-standard order as well.

2010-12-05 13:56:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add one-click move control to WB general-options dialog

This is a duplicate of the one in the ICS options dialog, but the latter
is inaccessible in non-ICS modes, and one-click move is now
alsoavailable in engine mode.

2010-12-05 13:51:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Create space in dialogs for translation

The translated texts often did not fit, because controls were defined
needlessly small (when there was empty space between them). In these
cases they have been enlarged to consume all available space. Some
dialogs are made wider.

2010-12-05 13:47:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add handle for translator acknowledgement

An empty string is printed in the about box, which can be 'translated'
to a message acknowledging the translator.

2010-12-05 13:43:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use default logo for user

When no logo with the name of the current user is found, use dummy.bmp.

2010-12-05 15:46:34 -0800 Arun Persaud <arun@nubati.net>:
added rlwrap tip to FAQ


2010-12-03 23:24:06 -0800 Arun Persaud <arun@nubati.net>:
replace hard coded paths with path from configure script

use $datadir and subdirectories to store some data files. Also make files in xboard.conf use correct path.

2010-12-03 23:02:09 -0800 Arun Persaud <arun@nubati.net>:
fixed a typo in the configure script output


2010-12-03 21:46:00 -0800 Arun Persaud <arun@nubati.net>:
added a desktop file

taken from the openSUSE project

2010-12-03 22:44:02 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Edit Game/Position checkmarking in WinBoard

Because the entries in Edit and Mode menu were pure duplicats, the
entries in the wrong menu (Edit) were checkmarked while active. By
defining different IDs for those in the Edit menu, those in the Mode
menu are checkmarked again.

2010-12-03 10:07:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add XBoard menu items for arrow highlight and one-click move

These items are put in the options menu; the 'Old Save Style' item is
removed.

2010-12-03 09:27:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Provide menus for editing WinBoard engine and server lists

The Edit Tags dialog in the WB front-end is adapted to act as a general
edit for string variables, by giving it an extra parameter to indicate
where to store the edited result. Menu items are added to invoke this
dialog for editing the /first, /secondChessProgramNames and /icsNames
options. This solves the problem that people would have to edit an ini
file that they can no longer locate (because the %APPDATA% folder has
different names and locations in the various Windows versions, and is
often a hidden folder on top of that).
There is a slight memory leak here, as the memory for the previous
value of the altered string option is not freed.

2010-12-02 16:18:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure arrow highlighting as default in XBoard

Set -highlightMoveWithArrow true in the xboard.conf file, and specify a
lineGap of 0 to make that efficient (and the wood theme even nicer).

2010-12-02 15:56:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Port highlighting with arrow to XBoard

Unfortuntely this duplicates a fair amount of code in the front end.
Removing the arrow is done by a total repaint if there is a non-zero
lineGap, because the clever algorithm for selective redrawing (based
on damage) that XBoard uses does not repair damage to the grid lines.
For lineGap=0, however, (for which the arrow is mainly intended) the
damage mechanism is used, and the damaged squares are determined by
tracing out the arrow in 64 steps, and marking all squares in the
neighborhood as damaged.

2010-12-02 15:55:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Strip CR from xboard.c


2010-12-02 14:21:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let user decide if he wants highlights in blindfold mode

Remove the automaticsuppression ofhighlighting.

2010-12-02 00:24:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix fag-fell marker with logos on

The flag-fell marker "(!)" that is displayed in the clock in WinBoard in
two-machines mode was printed twice when the clock was split over two
lines (as with logos on).

2010-12-01 18:57:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Also exempt variant seirawan from eval-scale doubling

It is not really a drop game, so a scale from -7 to 7 in the eval graph
is good enough (like variants great and super).

2010-12-01 10:33:13 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure EGTB cache size in adapterCommand

The hash size, nr of CPUs and EGTB path are transferred through the WB
protocol interface commands memory, cores and egtpath. But there is no
WB command for detailing the EGTB cache size. So the value of the
command-line option -defaultCacheSizeEGTB has to be sent to Polyglot
through its startup command to make it known to UCI engines.

2010-11-30 22:46:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Move Hint and Book items to Engine menu in XBoard


2010-11-30 22:17:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Correct the key bindings fo view menu in texi file

The mentioned bindings for Game List and Eval Graph were wrong.

2010-11-30 21:25:07 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix sub-variation display with negative score

The test if the displayed score was the pvInfo score failed for negative
scores, because floats are truncated towards zero. So the previous fix
of spurious score/depth info was not working when the score was
negative.

2010-11-30 18:27:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Peel PV out of comment

Arena stores engine PVs not in variation format, but within both braces
and parentheses, before the score/depth info. This caused XBoard to
overlook the score/depth info, (frustrating, e.g., the eval graph),
while the PV would not be accessible for walking it as a variation.
The routine that extracts the score/depth from a comment now has
been made more clever, to recognize a leadin PV in the comment, and then
place it in front of the comment as variation (by moving the opening
brace to behind it). For some reason it does not work if the PV and
score/depth were separated by a newline, but this happens quite rarely.

2010-11-30 18:23:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow line-straddling result comments

Some GUIs (in particular Arena) do not have the decency to keep the
result comment on a single line. In this case the parser rules would not
recognize it, and treat it as a normal comment, plus an undetailed PGN
result. The rules are now fixed to allow linefeeds in the comment, and
between comment and PGN result. To correctly process the comment further
(e.g. in game-list lines) the linefeeds are replaced by spaces in the
back-end routines that do use the result comment.

2010-11-30 12:22:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Write key bindings in XBoard menus

Unfortunately tabs are not understood in menu texts, so fine-tuning
through spaces is necessary to get some sort of ragged alignment.

2010-11-29 18:01:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure XBoard to use wood board texture by default

The texture pixmaps are sought in /usr/share/games/xboard, with names
wood_l.pm and wood_d.xpm. I guess the " make install" should be adapted
to put them there. XBoard is resitent to non-existence of the files,
btw. It simply ignores the arguments in that case.

2010-11-29 17:48:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Configure -inc as volatile option in XBoard

XBoard users are not used to options being persistent, and thus have
many scripts assuming the timeIncrement is -1 when they don't specify it
on the command line, and want to specify -mps. But a persistent -inc of
0 fom a preious session would then force their -mps to zero, causing
big-time confusion.

2010-11-29 17:36:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make WinBoard clocks translation-proof

With logos on, the splitting of the clock over two lines assumed the
lengths of the words "white" and "black" would always be 5. Used strlen.

2010-11-29 14:57:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Improve drawing of highlight arrow

A diagonal arrow sometimes had a notch in the shaft because of
independent rounding of the starting and ending point coordinates.
Furthermore the width of the shaft was unnecessary variable(as a
function of direction) because half the width was rounded and then used
twice. Now rounding of end-points is always done towards a fixed grid
of square centers, which keeps diagonals purely diagonal, and one side
of the shaft is drawn relative to the other side, after the
position of the latter has been rounded, so any rounding error affects
the shaft width only once.

2010-11-29 10:25:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Alter descriptionof Analyze File menu item

This menu item has been given a new function, so a new description was
needed.

2010-11-29 10:15:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add description of Game List Options in texi file


2010-11-29 09:58:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update texi file for new menu organization

The descriptions are shuffled around and organized into sections
corresponding to the new main menus. Where necessary the name of the
items was changed to their new names. The items removed from the File
menu (the next/previous/same stuff) are nowmoved to the section "other
shortcut keys", as the key bindings for some of them are still active.

2010-11-29 09:06:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update info on key bindings in texi file

The texi file was still listing the old XBoard key bindings. Where
necessary this is now changed to the new (WinBoard) bindings, and all
the new bindings were added.

2010-11-29 09:04:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add XBoard key bindings for Revert and Truncate

Use Home key as accelerator for Revert, End for Truncate, as in WinBoard.

2010-11-28 23:12:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Divorce the Edit and Show Tags/Comment menu items

In WinBoard the items in the Edit and View menu for Tags and Comment now
have different IDs, so they can be independently controlled. Only the
items in the View menu are check-marked. The items still do the same.

2010-11-28 23:08:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Alter WinBoard menu text

The texts are slightly adapted, mostly by choosing more convenient
tabbing characters for the new menu organization. The translation
template is updated accordingly.

2010-11-28 20:24:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let move-history window scroll to bottom after adding move

By activating the scrollbar of the viewport through XtCallActionProc
the move-history window is scrolled to the bottom.

2010-11-27 14:38:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Shogi promotion popup

The texts were adapted to shogi by printing new text items over the
Queen and Knight buttons, but these did not alwys cover it. Now the text
on the buttons is changed as it should be. Also the window title is
adapted.

2010-11-26 11:22:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Apply gettext macros to menu texts

Now texts and references are separated, the texts in the tables can be
decorated with the N_() macro, so that the _() macro no longer has to be
applied when they are used. (This makes the texts appear in the .po
files.)

2010-11-26 11:12:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Adapt some XBoard menu texts

The "Show" prefix is removed from the "View" menu items, as this seems
implied. An ellipsis is added to the Engine #N Settings items, which
could not be there before, because periods in a menu name would break
any reference to it. For some other names the ellipsis was deleted.
(These were not refered to, but who knows what we will do in the future.)

2010-11-26 11:03:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Separate menu text from menu name in XBoard

The text string in the menu-definition tables was used both for the menu
text, as well as for referencing the items from the code (for enabing or
checkmarking). Now these can be defined separately, so that altering the
menu texts is possible without breaing any references to the item.
(Moving them to another menu would still break XBoard, though!)
Currently the texts and names are still the same.

2010-11-26 10:48:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix XBoard menu translation

The gettext macro N_() was applied to the menu definition tables, but
this would break any translation, as these items are both used as menu
texts as well as reference for enabling and checkmarking. The routines
that create the menus already apply _() dynamically to these items when
they are used as menu texts.

2010-11-26 10:10:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Restrict drops in variant seirawan to back rank

Drops aren't really llowed at all in Seirawan Ches, but there exists an
engine that supports a variant where drops on the back-rank are allowed.

2010-11-25 19:44:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let Analyze File annotate the loaded game

By not suppressing the auto-play loop in AnalyzeFle mode, we step
through the game while the engine is analyzing, and store the PV info
that the engine produces, as well as the full PV (as variation comment)
with each move.

2010-11-25 19:41:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Revive Analyze File menu item in WB

We will keep this menu after all, becase it can be given a new meaning.

2010-11-25 19:31:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix spurious scores in comments

The comment popup is also used to display engine PV info, but when the
contents of the window is written back when we select a variation,
it was treated as a real comment. This is fixed now by checing in
ReplaceComment() if the comment starts with the PV info, and if so,
ignore the latter. This solves the problem, but I guess the real bug is
that selecting a variation tries to write the comment even if it did not
change.

2010-11-25 19:26:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Display error for wrong use of Machine Match


2010-11-24 13:30:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reorganize XBoard menus


2010-11-24 11:02:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Reorganize WinBoard menus

New main menus Edit, View and Engine are added; the step menu
disappears. The menu items are redistributed over the new menus.
Sometimes duplicates are created. No adaptation of short-cut characters
as made yet (as this affects translation).

2010-11-20 20:20:27 -0800 Arun Persaud <arun@nubati.net>:
removed trailing whitespaces from NEWS


2010-11-20 20:19:30 -0800 Arun Persaud <arun@nubati.net>:
merged readme_HGM.txt into the NEWS file

seems like a better place for the release notes, although those releases where not officially part of GNU, but the NEWS file already covers similar releases, so it might as well cover all of them.

2010-11-20 18:24:19 -0800 Arun Persaud <arun@nubati.net>:
typo in date of developer release

but will leave the tagged version as it is, since it's still a unique version number

2010-11-20 18:11:01 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2010-11-20 18:12:41 -0800 Arun Persaud <arun@nubati.net>:
added latest version of parser.c


2010-11-20 18:05:56 -0800 Arun Persaud <arun@nubati.net>:
updated Changelog, etc for developer release


2010-11-20 16:22:00 -0800 Arun Persaud <arun@nubati.net>:
Revert "adding gnu-readline support"

This reverts commit c95ef32a700132a134f335f857ca6f1b6f3c169f.

Conflicts:
	backend.c

better to use the (relatively) new ICS input box then add readline support.

2010-11-20 16:19:32 -0800 Arun Persaud <arun@nubati.net>:
Revert "bugfix: fixed readline support with icslogon option"

This reverts commit b9cdd7422ad1037d7376bce4f8f2db2669396e83.

Conflicts:
	backend.c

better to use the (relatively) new ICS input box then add readline support.

2010-11-19 23:10:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make Hoplite moves irreversible in Spartan Chess

Consider Lance moves in variant Fairy (where the Lance represents the
Spartan Hoplite Pawn) as Pawn moves, so they reset the 50-move counter.

2010-11-19 21:09:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Give Lance moves of Amazon in variant super

Now that Lance is no longer a wild-card piece the moves of Amazon must
be programmed explicitly, to keep the possibbilty to play Superchess
with legality testing on.

2010-11-19 18:32:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change representation of Bede in variant fairy initial position

This used to be Lance, but the promoted Bishop (Dragon Horse)
is more applicable. Especially now that Lance is supposed to move like a
Berolina Pawn.

2010-11-19 18:28:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make yyskipmoves also suppress examining of drop moves

Not sure if this does any good, but it seemed illogical that this would
happen in all other moves, but not drops.

2010-11-19 18:23:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Define moves for Dragon Horse outside Shogi

Let it move like Bishop + Wazir + Dababba.

2010-11-17 13:40:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix safety crash when appending comments

The length limit imposed on safeStrCpy was one too short when copying
an existing comment to the space allocated for the longer (concatenated)
one. It allowed no space for the terminating '\0'.

2010-11-17 13:38:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix safeStrCpy

The test for when to terminate a non-fiting string was one off, and the
debug message was written stdoutin stead of debugFP.

2010-11-16 12:40:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix default holdings size for variant seirawan

The holdings for 7 pieces werealways considered an overrule, so that the
variant name was prefixed with "8x8+7_".

2010-11-15 11:36:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix home-dir crash

When confronted with a path name starting with ~ and not containing a /
XBoard would segfault.

2010-11-14 21:45:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix one-click moving on up-click

(First) up-clicks were not always ignored: in Edit-Game mode with
one-click moving enabled this could lead to a capture being made on
the down-click, and the recapture on the correspoding up-click.
This has now been corrected, and only the down-click of a first click
can lead to selecting a piece or a one-click move.

2010-11-15 18:15:40 -0800 Arun Persaud <arun@nubati.net>:
fixed buffer size for snprintf


2010-11-13 23:04:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Accept Seirawan-style gating suffixes

The parser rules were extended to accept / as an equivalent of = in
promotion-suffix notation (e.g. Nf3/H in stead of Nf3=H).

2010-11-13 22:55:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use Falcon and Alfil as built-ins for Seirawan chess

Where available (size 49 and 72) we use Falcon for Archbishop and Alfil
for Chancelor, to better conform to the Seirawan names Hawk and Elephant.

2010-11-13 20:02:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement entering gating moves with mouse

A move with a back-rank piece that starts when a piece in the holdings
is selected will be interpreted as a gating move in variant seirawan.
The front-end uses a 'gatingPiece' selected this way todisplay it on the
from square during animate dragging.

2010-11-13 18:56:15 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement variant seirawan

Set upthe position, including Hawk and Elephant in holdings, in
InitPostion(). Suppress putting captured pieces in holding. Let
promoChar indicate gating in ApplyMove(). Remove gated pieces from
the holdings there. Let GenLegal() generate RxK-type castlings to act as
base for gating on Rook square. Gatings are tested for legality
based on the holdings content and whether they occur on the back
rank. Disambiguate() also tests this. Make sure the gated pieces are
printed as move suffixes in CoordsToAlgebraic().

2010-11-13 18:42:27 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add -variant seirawan to menu


2010-11-13 22:52:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix acceptance of null-move with legality testing off

A second click on the same piece was interpreted as a to-square rather
than deselection of the piece.

2010-11-13 22:49:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix one-click bug

Disambiguate was imagining captures, so an only capture by double
clicking your own piece did not always work.

2010-11-13 20:08:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix mouse-driver buglet

The highlights were not cleared on moves that went vertically off board.

2010-11-12 17:17:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
List some undocumented commands as compliant

The engine->GUI commands setboard and setup are now always printed in
the debug file as well.

2010-11-12 17:05:22 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
List Hint with compliant commands

This command was omitted, so that in some -engineDebugOutput modes it
would not appear in the debug file.

2010-11-12 17:02:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Restrict use of escape expansion

Only expand escape sequences like \n and \t in telluser(error) comamnds
that ask for it by preficing the messages by double backslash. Otherwise
backward copatiblity is too severely broken for messages that display
DOS-style filenames.

2010-11-12 13:56:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make safeStrCpy safe

SafeStrCpy was causing a lot of out-of-bound write accesses, as it was
always writing the character at the length limit of the destination.
Now no memory is accessed that is is not needed to hold the copy.

2010-11-07 21:37:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow clicked name internal to the icsMenu command string

A command in the /icsMenu that was specified to contain the selected
text or clicked word always appended this word at the end. Now the user
can also configure it to appear in the middle, by putting a %s in the
command string where he wants it to appear.

2010-11-07 21:33:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let Engine #2 Settings start second engine

If the second engine is not yet running, it would be impossible to use
the settings dialog for it, as the features have not been received and
the dialog will be empty. So the user could not adjust the engine
parameters before starting a match. Using this menu now automatically
starts the engine, and delays the appearence of the popup untill the
features are received, using a similar mechanism as in
TwoMachinesEventIfReady().

2010-11-01 19:40:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Newly lexed parser.c


2010-11-06 19:55:31 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in parsing illegal Pawn captures

When a pawn move of type exf5 was illegal, the parser made an attempt to
interpret it as e.p. capture of f5. This, however, messed up the move,
so that it was now permanently mistaken for e5xf6. Even in cases with
legality testing off, where you would want the original move to be
accepted despite the fact that it was illegal.

2010-11-06 19:49:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Keep last PV while clearing engine-output display

When ponder is on, the display is cleared immediately when the last line
of thinking output appears by the appearing ponder output. So you would
never get the chance to see it. This line is now re-written after
clearing, so it appears at the bottom of the output for the next search.

2010-11-06 19:45:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Give Lance moves of Berolina Pawn

In stead of using it as a wildcard piece, the Lance gets the moves of
the Berolina Pawn (straight capture, diagonal move). The initial double
osh can be a ump, though. (So it is really a Hoplite Pawn from Spartan
Chess.)

2010-11-06 19:42:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use SAN even on illegal moves

If there is only one piece of type T, moves like Ta1 or Txa1 are never
ambiguous, so adding the from square is just cumbersome.

2010-11-06 19:34:53 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use normal SAN for wildcard pieces

SAN often can also be used with pieces we don't know the moves of, e.g.
if there is only one of that type. We just always get rank or file
disambiguators if there are more (even when they might be unnecessary).

2010-11-06 14:52:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some warnings

Unused variables were removed from parser.l

2010-11-06 14:43:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow arbitrary nesting of sub-variations in PGN input

The parsing of subvariations is moved out of the state-machine parsing,
to allow arbitrary nesting. In stead of the entire sub-variation being
parsed by lex as Comment, it now returns Open and Close for the
corresponding parentheses, which are then handled in a wrapper routine
for yylex(): Myylex(). Problem was that yy_text is supposed to return
the entire parsed text of the returned symbol, which thus has to be
collected. To make this possible, yylex has to return everything that it
parses, (even white space!), and a symbol "Nothing" was added to return
in parsing rules that before just ate away irrelevant text without
returning anything.

2010-11-06 21:48:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement setup (engine-GUI) command

This allows the frst engine (when legality testing is off) to overrule
the default opening position, in reply to the variant command. Syntax is
"setup (PIECE_TO_CHAR_TABLE) FEN_STRING"
where the FEN string is interpreted in the context of the given
pieceToCharTable (which is optional, and only delimeted by parethesis if
it is present).
Sendng the position to the second engine is delayed until the first
engine has responded to the ping after the new-game sequence, to make
sure it gets the chance to alter the position before it is sent to the
second engine. This feature is useful for playing variants that WinBoard
does not even know the opening positon for, and can be used even if they
are shuffle variants.

2010-11-06 14:19:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Restrict use of a2a3 kludge

The kudge to send "a2a3" in stead of "black" to get black to move is
fatally flawed in varants that have no Pawn on a2. So in that case we
revert to use of the deprecated "black" command.

2010-11-02 13:06:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remember values set by -firstOptions, -secondOptions

When an engine announces its option features, and the option name
matches that of a setting given in -first/secondOptions, the engine is
sent hte specified value, but this value was not remembered as current
value (but the latter  was left at the engine-announced default),
leading to inconsistent behavior in the Engine #N Settings dialog.

2010-11-01 19:26:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make test for valid promotion piece color-dependent

This is needed to make it work in variants where white and black have
different armies; quite likely white will promote to pieces that do not
exist in the black army, so we really have to make sure we test if the
white (upper-case) piece exists in this case.

2010-11-01 19:23:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove validity test on promochar from parser

The backend routines Disambiguate() and LegalityTest() will catch
invalid promotions, so no need to do it here.

2010-10-31 23:37:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add the actual size-33 Shogi bitmaps

These were forgotten in the original commit that fixed the .rc file.

2010-10-31 13:20:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Delete some stale promotion code

The correction of the promotion piece to Ferz in Shatran-like variants
in ApplyMove() was no longer needed, as the new promotion code already
does this in the move parser.

2010-10-31 13:08:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Augment moves of some fairy pieces

To get better disambiguation in variants that have to be played with
legality testing off, the Elephant is given also one-step moves (making
it a so-called Modern Elephant) in -variant fairy and great. The Dragon
King (Crowned Rook), which had no moves defined for it outside Shogi at
all, has been given Rook moves plus an orthogonal 2-jump, so that it
can get SAN moves when used as Dababba or Short Rook. (Illegal moves
currently aways force long algebraic notation...)

2010-11-08 22:57:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix safeStrCpy patch, WinBoard

The use of sizeof on pointers was detected through the same method as
the previous patches, this time while compiling WinBoard. A typo in
jaws.c was fixed as well.

2010-11-08 23:03:13 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix for safeStrCpy patch for XBoard

By a trick (temporarily redefining safeStrCpy in common.h as
((char*) (a=1/(4-3rdArgument))) ) a compile-time warning (division by 0)
could be generated for every occurrence where the size argument was equal
to 4, i.e. where the 1st argument was likely a pointer rather than an
array. These cases are now fixed. The file xoptions.c, which is the
only ne that does not #include common.h had to be fixed by making
the #define in the file itself.

2010-10-31 13:16:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix spurious promotions with legality testing off

The recent promotion patch had broken playing without legality testing
completely: without legality testing one always gets the piece that was
asked for, but a NULLCHAR should not be taken as a request for a piece!
But it was, and this resulted in any moved piece turning into a white
Pawn! For true promotions the piece was always black, which was also not
very useful.

Also revert to the use of '+' as internal Shogi promoChar, because
pre-processing turns out not to be possible when reading a game file.
In stead parse any trailing '+' on moves as promoChar. Downside: '++'
can no longer be recognized as checkmate symbol.

2010-10-29 22:54:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make deferral default in Shogi promotions

Because '+' is intercepted by the parser as check indicator, Shogi moves
are pre-processed to change a trailing '+' into an internally used
alternative '^'. The testing if a promotion character is OK is now done
in LegalityTest() and Disambiguate(), which return ImpossibleMove when
the character does not correspond to any piece, and IllegalMove when in
Shogi anything other than '^' or '=' is used. (Except for the ICS
notations.) On output, in CoordsToComputerAlgebraic() and
CoordsToAlgebraic(), the '^' is translated back to '+'.

2010-10-28 17:51:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Animate piece explosions in drag-drop moves and in XB

This required some code restructuring: the decision if an explosion is
needed is now taken in a new routine Explode() in the backend. This then
calls the front-end driver, and it returns the info if there was an
explosion or not, so the caller (AnimateMove() or the mouse driver) can
take action to repair the damage to the board caused by the blast wave.
A front-end driver for XBoard is provided as well, so that both
click-click (and replay, which is the same) and drag-drop atomic
captures are animated in XB as well as WB.
Explosions on rejected moves are suppressed.

2010-10-28 13:53:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress promotion popup if piece will explode

In atomic, a Pawn capture to last rank is not really a promotion.
Fix choice to Queen.

2010-10-28 18:42:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make Knight hop first straight, then diagonal

It used to be the other way around, which looked pretty illogical in
Xiangqi: to see Horses, which are blockable pieces there, move over an
occupied square.

2010-10-27 20:04:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let -oneClickMove also work in EditGame mode

There is really no reason why people that lke one-clcik moves enough to
switch them on would not want to use them too when editing a game.
This solves a nast inconsistency, as before it used to work in -ncp mode
on the _first_ move, as the mode is then BeginningOfGame, and not yet
EditGame, and we do want it to work for BeginningOfGame, as this is
also the game mode when you start playing as white.

2010-10-27 19:40:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make -flipBlack and -allWhite option volatile

As these options are very Shogi specific, and the variant is volatile,
it seems logical to make them also volatile. Not completely sure about
-allWhite, though. It cold be useful if you want, for example, to play
wth dark-brown pieces for black, as any color but black looks much
better with outline pieces than with solid pieces.

2010-10-27 19:33:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Provide some sample board-texture pixmaps

Wood and marble themes are provided as textures for light and dark
squares, plus two complete Xiangqi boards (wood and evenly colored).
These should probably not goint the distro tar ball.

2010-10-27 19:25:56 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
The -overrideLineGap option is made to work in XBoard

Although XBoard already allowed this in the -boardSize specification,
it is still seful to globally disable grid lines, e.g. for an
oriental Xiangqi board. And it converges XB and WB.

2010-10-27 19:18:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement board textures in XBoard

The -darkBackTextureFile and -liteBackTextureFile options now wrk in
XBoard too, for loading a pixmap that will be used to cut out the dark
and light square backgrounds. The cutting algorithm is such that the
pixmap image is completely restored if the size was that of the total
board (e.g. a drawing of a Xiangqi board).

2010-10-27 12:11:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Complete WB (western) bitmaps for Shogi at size 33

The Lance was not replacing Queen in some sizes where the bitmaps were
already available, and new bitmaps for the promotion Golds were added.

2010-10-22 20:30:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make starting new variation dependent on shift key

The shift key is read during mouse events, and posted in a global
variable, which can then be used by the back-end. The decision to start
a new variation (pushing the game tail rather than clipping it off) when
entring a move in Edit Game or Analyze mode is made dependent on this.
The move-typein also records the shift-key state.

2010-10-22 20:25:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix merging bug

A %g format was used to print an int in sending the level command,
because decimal points were dropped when merging patches. Also an unused
variable was removed to suppress a warning.

2010-10-18 19:50:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add set of shogi pixmaps for XBoard

The -size 64 pieces from gShogi (and originally XShogi) are made
suitable for loading by XBoard, through redefining the transparent
background color as either light or dark square color. These bitmaps are
not included in the XBoard build, and perhaps should not even be
included in the source distribution, but made available in a separate
distribution?

2010-10-18 19:46:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Implement -flipBlack in XBoard

When -flipBlack is true, the white and back piece pixmaps are swapped in
flipView. The idea is that the black pieces are upside-down versions of
the white (Shogi) pieces, so that swapping white and black in effect
turns all pieces upside down, which is what should happen in flipView.

2010-10-11 21:06:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Disable some very verbose debug printing

The internationalization seems debugged enough to do without them.

2010-10-11 20:52:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add option -variations to control variation-tree walking

Just so that users can switch it off if the find it annoying.

2010-10-11 21:01:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow full promotion suffixes on SAN piece moves

This facilitates the parsing of (non-standard) Shogi moves in ICS
protocol. It can also be useful for Seirawan Chess, where a future
implementation of it can use promotion suffixes to indicate gating.

2010-10-11 14:07:02 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow lower-case piece indicator in drop-move notation

As it seems that XBoard also sends such moves in zippy play, it seems
more fair to recognize them from the engine as well.

2010-10-10 21:26:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in ICS variant switch for Shogi

Because a test for 8x8 variants was done by <= VariantShogi,
rather than <, spurious move-list fetching occurred in Shogi.

2010-10-10 21:23:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WinBoard Lance bug

The choice between Lance and Queen was made on appData.variant, in stead
of gameInfo.variant. Because of this it was not always up-to-date in ICS
games.

2010-10-10 21:15:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Adapt WinBoard to Shogi implementation on Variant ICS

The Variant ICS does not use the '+P' notation for promoted pieces,
neither in the board, nor in SAN, but simply indicates any Gold by 'G',
and uses 'H' and 'D' for +B  and +R. The Shogi promotion code in
LegalityTest() and Disambiguate(), which are used in move Parsing, are
adapted to handle this. Deferred promotions sent to the ICS now use an
== suffix.

2010-10-10 21:07:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Inherit promoted-info that ICS does not give from previous board

The ICS does not tell us in Crazyhouse (or Shogi) if a piece is
primordial or a promoted pawn (or a promoted other piece). We now derive
this info from the previous board. The option -disguisePromotedPieces
controls this feature.

2010-10-10 21:03:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Limit multi-session clock handling to non-ICS games

In ICS games a time forfeit crashed XBoard, apparently because the
fullTimeControl string is not properly set when we try to use it to see
if a sudden-death session is indeed the last session.

2010-10-08 11:47:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Change evalgraph scale in drop games

Score swings tend to be much larger in Crazyhouse and Shogi, so the
vertical rangee in those games is doubled to (-14, 14).

2010-10-13 23:05:05 -0700 Arun Persaud <arun@nubati.net>:
bugfix: fixed readline support with icslogon option

The icslogon option sends the login and password, so we don't need to handle
special cases for the readline buffer.

2010-10-07 20:35:26 -0700 Arun Persaud <arun@nubati.net>:
fixed some typos that were introduced during the sprintf->snprintf changes


2010-10-07 11:59:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix uninitialized variable in book code

The variable ' power' was used uninitialized in case -bookVariation was
set to 0, which can be an error even if it was only multiplied by zero.

2010-10-06 14:20:03 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix menu translation bug

The menuText array was declared too small, so that the last entry of the
File menu got out of bounds and was overwritten by the first of the Mode
menu.

2010-10-05 21:14:08 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow -timeIncrement to be a float

The increment can now be fractional seconds. The printing in
ParseTimeControl() and SendTimeControl() is done with %g format, so that
for integer increment there is backward compatibility with the old level
command.

2010-03-30 20:24:49 -0700 Arun Persaud <arun@nubati.net>:
adding gnu-readline support

should make the user interface for xboard a bit nicer. In the end we want to have a separate input window, but this probably will have to wait until the GTK version.

2010-09-24 21:17:50 -0700 Arun Persaud <arun@nubati.net>:
added warning if icsLogon file couldn't be opened


2010-09-24 21:10:28 -0700 Arun Persaud <arun@nubati.net>:
security fix: replaced some strcat with strncat

there is still more to do

2010-09-19 20:55:01 -0700 Arun Persaud <arun@nubati.net>:
add option for silent builds

this can be enabled for automake versions >1.11 by calling ./configure --enable-silent-rules.
It should still work for older automake versions too

2010-09-19 13:16:40 -0700 Arun Persaud <arun@nubati.net>:
bugfix: missing array index


2010-09-19 12:19:44 -0700 Arun Persaud <arun@nubati.net>:
added new case for (Chessmove) 0 in common.h

this cleans up a few more -Wall messages

2010-09-17 21:47:22 -0700 Arun Persaud <arun@nubati.net>:
cleaned up -Wall warnings (apart from settings some parentheses)

removed unsused variables, etc mostly everything from -Wall -Wno-parenthesis

2010-09-17 20:36:54 -0700 Arun Persaud <arun@nubati.net>:
sizedefaults has 9 members, the last line of the array (NULL) only set 7.


2010-09-12 20:04:03 -0700 Arun Persaud <arun@nubati.net>:
security fix: replaced sprintf with snprintf

replaced most sprintf with snprintf. There are still some left where for example a pointer is used and is allocated in the line before, which should be fine... and some others.

2010-09-10 23:36:23 -0700 Arun Persaud <arun@nubati.net>:
security fix: replaced strcpy with safeStrCpy from backend.c

see comment in backend.c on how to use safeStrCpy. This was already added by AS, but only used in 3 places.

2010-10-04 11:50:38 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Enhance multi-session TC clock handling

Some new TC types are introduced: Bronstein and free sessions. The
former is implemented by letting an exclamation point '!' in front of an
increment (in the -tc string) indicate that the increment is limited to
the time actually used on the previous move. The latter is an interval
of given duraton in which you can do any number of moves (even zero),
before the next session starts. This is needed for implementing Shogi
byoyomi-type TC, as a first session, followed by a session of fixed-time
per move. The latter can now be specified with the -tc argument as a
degenerate case of Bronstein, where the time on the clock is <= the
increment (so that it is never possible to think longer than the
increment). A TC of 5 min + 10 sec byoyomi can then be indicated as
300:10+!10.

The sessions are now separated by ':' in stead of '+', and all times in
the TC string are converted to seconds first (in ParseTimeControl), so
the fullTCstring can now be directly used in a PGN tag.

Note that this patch only addresses clock handling; the engine will not
be informed yet if the TC type or parameters change at the start of new
session!

2010-10-04 09:32:18 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove promotion-piece encoding from ChessMove type

The shizophrenic way to indcate promotion pieces in the XBoard code
(sometimes using a promoChar, at other times relying on moveType) was
cured by combining all promotion move types (such as WhitePromotionRook)
into a single one (WhitePromotion), and relying on promoChar to specify
the piece. This solves the problem of promoting to new piece types in
variants, which formerly also required addition of new move types.

In Shogi the '+' character is now consistently used to indicate
promotions (and recognized in ApplyMove), rather than 'q' or
PieeToChar(BlackQueen), as the latter did not work in minivariants where
the Queen (representng the Lance) did not partcipate.

2010-10-03 20:50:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Pass promoChar to SendMoveToICS

SendMoveToICS was the only place where the promotion piece was derived
from moveType, rather than an explicity passed promoChar.

2010-10-04 09:41:11 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress spurious use of SAN castling in mini variants

King moves from a central file to the king-side-castled position (1
square away from the right corner) were intercepted and printed as O-O
in CoordsToAlgebraic. But on a 5x5 board (mini-Shogi!) this caught the
normal King move Kc1-d1 as well. The castling notation is now reserved
for King moves larger than one step.

2010-10-04 08:21:19 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make Shogi promotion zone board-size dependent

In stead of using a fixed size of 3 ranks, we use BOARD_HEIGHT/3, which
would translate to 1 rank for mini-Shogi (5x5) and 2 ranks for Judgkin's
Shogi (6x6), which are indeed what these variants need.

2010-10-03 19:58:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make board-size overrule options volatile

The options -boardWidth, -boardHeight and -holdingSize were legacies
from the day choosing a variant would not automatically set a board
size. As a result they are seldomly used anymore. The first real
application is mini-Shogi (on 5x5 board), and it turned out very
annoying if the 5x5 settings persisted to the next session, where you
almost certainly want to play another variant.

2010-10-04 09:16:47 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Strip DOS line endings from parser.l


2010-09-16 18:58:37 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Extend mate test to drop games

MateTest() in case of no legal moves now also looks if there are legal
drops that can resolve the check. This provides reliable mate testing in
Crazyhouse and Shogi, so these are now made subject to adjudications too.

2010-09-16 18:48:29 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Extend legality testing to drop moves

LegalityTest() can nowbe called with (internal-format) drop moves, and
delegates their testing to a new routine LegalDrop(). This routine
performs the 'no-pawn-on-back-rank' test that used to be in
UserMoveTest (which now calls LegalityTest also for drop moves).
The more complex Shogi case is also handled (except for Pawn mate
drops) in LegalDrop().

2010-09-16 18:25:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Revert splitting of UserMoveEvent

This splitting into UserMoveTest and FinishMove was no longer needed,
now that the new mouse driver no longer calls UserMoveTest to figure out
if a move is a promotion, and XBoard and WinBoard are unified in this
respect. It was counter-productive, because UserMoveTest was not able to
change the fromX, fromY (call-by-value) parameters for passing them to
FinishMove, so it had to defer the conversion of drop moves to internal
format to the latter, while it did not belong there. (Because
DropMenuEvent already delivers the moves in internal format.) This
whole kludgy construction was therefore abandoned, by going back
to the original 4.2.7 calling scheme, where UserMoveEvent completely
pre-processes the move, and when it is valid, calls FinishMove directly.

2010-09-16 18:02:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix silent bug in drop moves

In ApplyMove() the piece on the from square was accessed and used before
we tested for drop moves. As drop moves have off-board from-squares this
led to out-of-bound array access, which apparently was usually harmless.

2010-09-16 17:43:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow parsing of upper-case machine moves

Dubious patch, as it caters to non-compliancy. Some variant engines are
very non-compliant, though.

2010-09-16 17:38:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Prevent transmission of spurious promo char to other engine

The parser now strps off spurious promotion characters.
New move types "White/BlackNonPromotion" had to be introduced for this,
to indicate NormalMoves that could have been a promotion, to make sure
the '=' suffix of Shogi deferred promotions survives.

2010-09-16 20:44:37 -0700 Arun Persaud <arun@nubati.net>:
fixed internationalization for winboard

in the original commit some files were forgotten. This should fix it.

2010-08-29 21:07:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix JAWS bug saying side to move in ICS play

This was done the wrong way around.

2010-08-27 14:08:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make WB run-time language switch possible from menu

This is a rather involved patch that might not be worth it. It is
difficult, because translation of things that live forever is not easy
to invert (menus, the auxiliary windows). We hae to remember all
original, English texts there to be able to put them back,or
re-translate. Still does not fully work, although the menus and
temporary dialogs now are all OK.

2010-08-27 14:35:46 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update WB translation template

The language.txt file now also contains all translatable strings from
the C source files, rather than jsut the resource.

2010-08-27 14:14:51 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update docs

Add descriptions for machine-match menu support and enhanced book
control, nick-name options and language.

2010-08-27 13:59:09 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add some forgotten translation hooks

The general-options, file-browse dialogs and the about box did not call
Translate() yet. Also translate contents of combo boxes. Some small bug
fixes.

2010-08-27 13:28:33 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Do not translate game-end messages in PGN

The messages themselves are not subjected to _(), but in stead their
displaying in DisplayMove is subjected to T_().

2010-08-23 13:23:22 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Internationalization for WinBoard

A function Translate() was added, which uses a list of item dialogs,
reads their value, and replaces it by a translation (if available). It
also reads the window title and sets a translation. Calls to this
routine are added in the initialization code of every dialog callback.
In addition all translatable strings in the WnBoard front end are marked
by the gettext macro _(). Because WB is not gettexted yet, a hard
re-definition of this macro is added in each file using it, to the
string-translation routine T_() supplied in winboard.c.
Code to read the translation file, and translate the menu texts is added
in winboard.c. In backend.c the meaning of the gettet macros is
redefined for the WIN32 case.

2010-08-23 13:07:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Make the ID of all WB dialog items unique

Mnany static dialog texts did share the ID -1 (IDC_STATIC). But to
replace tet at run-time for translation purposes, they need to be
addressed individually. So they were given new IDs, with symbols defined
for those.

2010-08-23 12:48:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Mark XBoard result messages for internationalization

The GNU gettext macro _() is used with the game-end messages. This might
be controversial, as they will appear in the PGN as well. But only as a
comment. We can always decide not to supply a translation.

2010-08-23 12:43:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Do not exit after match when match started from menu

The codelooks weird, but matchMode == 2 in this case. We then use
DisplayNote() to report the match result.

2010-08-23 12:39:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Trivial-draws recognition improved in Xiangqi

Now based on a routine "SufficientDefence". If both have it, it is draw.

2010-08-20 17:46:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update .dev files

The relocation of parser.c and the addition of history.c was not yet
incorporated in the devcpp proect files.

2010-08-19 13:45:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix some MSVC compile errors

Some statements has moved up stream of declaratons, which is an error
that gcc is forgiving about, but where MSVC is strict.

2010-08-14 14:01:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Improved patch for expansion of WB settings-file name

The expansion of environment variables now allows multiple environment
variables in the path name. Tested on %HOMEDRIVE%%HOMEPATH%\winboard.ini
and %APPDATA%\winboard.ini.

2010-08-07 16:53:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add -colorNickNames option

This option allows non-standard designation of side to move in FENs.
(Useful for Xiangqi, where white is indicated often as r(ed), and Shogi,
where white is s(ente) or b(lack), and black is g(ote) or w(hite).)
Can also be used for FENs in a local language. A match of theinput
character with the nick name translates it to the standard; this means
the standard will continue to be recognized, unless it was defined as a
nick name.

2010-08-07 16:39:16 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Tricked by the grossnes

Some WB menu items were referenced by a hard number. As items had been
added over the years, the wrong menu items were grayed. In particular
the Options -> Adjudication menu was grayed out, in -ncp mode, where
this was intended for the Sounds dialog. This accidentally proved
useful, until we started to apply adjudictions also to the Human moves.
Then it was suddenly undesirable, and a small mystery why it happened at
all, when I tried to change it. The numbers are now corrected to the new
locatons of the items in the menus.

2010-08-07 16:35:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow match to be started from WB menu

A menu item Machine Match was added in the Mode menu to switch to
matchMode. A persistent option /defaultMatchGames determines the number
of games. A control was added to the Options -> Common Engine dialog to
set this option.

2010-08-07 16:26:35 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add some book-control options

Options /bookDepth and /bookVariation have been added to control the use
of the GUI book. In WinBoard the Optons -> Common Engine dialog now
contains fields to set them.

2010-08-07 00:15:57 -0700 Arun Persaud <arun@nubati.net>:
new developer release


2010-08-06 11:18:34 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Repair exit-popup deadlock patch

Relocating the exit popup call had made it lose access to the message it
should print, because it was declared only in an inner code block, by
the same name: buf[]. Deleting the inner declaration fixes it.

2010-08-04 11:00:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix erors when compiling with --disable-zippy

The file args.h contained a codeblock in #ifdef ZIPPY, in stead of
fields.

2010-08-01 13:27:23 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix zippy handling of draw offers from ICS

The patch by DM to fix the problem introduced by the coloration of
zippy-matched commands (namely that the coloration code beat the zippy
draw recognition to it, and ate the draw offer away) was only targeting
ICC. The new fix should work on any ICS (by using the same pattern in
zippy as in the colorization code).

2010-08-01 13:15:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix regression in colorization of zippy-matched commands

The patch by Daniel Mehrman from 4.2.pre8 was not properly merged, so
that in XBoard no coloration would take place of ICS commands that were
matched by zippy. (It was using &i as input pointer, rather than &backup.
The XBoard-specific code now has been deleted completely, to remove a
seemingly needless dependence on _WIN32_ of the back-end. Both WB and XB
now use the XBoard method, to only match zippy commands when logged in.

2010-07-31 22:48:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Suggest default file name in browser dialog

The argument 'def' to FileNamePopUp() was not passed through to the new
file-browser routine, which got NULL in stead, and thus started with an
empty input field.

2010-07-30 23:28:57 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Define /firstUCI and /secondUCI as synonyms for /fUCI, /sUCI

Because the %s expansion of WB options in the /fcp and /scp lines only
works for options that contain 'first' or 'second', and /fUCI thus did
not work, PSWBTM had to rely on the cumbersome /firstIsUCI=true to
install UCI engines. (The latter option should be deprecated really;
the UCI-ness of the engines is a volatile option, so it makes no sense
to supply a way to set them both to false or true. One only needs to be
able to set it to the non-default state.)

2010-07-30 23:21:50 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Add string option /pieceNickNames

This (volatile) option allows definition of alternate letters for the
pieces, which will be recognized next to the standard symbols as given
in the /pieceToCharTable on input. (Output always uses the standard.)
This can be useful for reading PGN from another language, or
non-compliant FENs (e.g. using B and N for E and H in Xiangqi).
  The format of the argument is the same as for /pieceToCharTable.
Because the nickNames are consulted before the standard table, it is
possible to redefine a standard name as a nick for another piece.

2010-07-30 23:10:42 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix deadlock in match-result display

At the end of a match, GameEnds() was recursively calling itself,
through DisplayFatalError() and ExitEvent(), and the latter was then
delaying until the calling GameEnds() terminated. (Which it would of
course never do before ExitEvent returned; fortunately there was a tim
limit to this delay, but in XBoard it was 10 sec in stead of 10 msec.)
 Now the calling of DisplayFatalError() (to show the result popup) is
delayed until after GameEnds completes (and resets the anti-recursion
flag 'endingGame'), so that it is simply executed a second time, unaware
of the earlier call. But this second time it does not do anything,
because the gameMode ws set to EndOfGame the first time, and the writing
of the PGN is blocked by the checksum being still the same.

2010-07-12 11:10:17 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix WinBoard game-list title

Number of displayed games and WDL stats were always appended to the
existing title, leading to an ever-growing title in the game-list
window. Now the old actual title is ignored, and the starts is appended
to the original title "Game List". (In the future we could use the
filename here?)

In addition, the title was not updated when re-opening the game-list
window, while the stats could change if filtering was active when the
window was closed. (In that case the filter is cleared on re-opening, so
the number of displayed games changes.) Now a title-update (after
recalculating the stats) is done every time the game-list window is
opened.

2010-07-11 11:06:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Refactoring of material-draws adjudication code

Insufficient mating material is now determined per side individually, by
testing for MatingPotential of each side. If both lack mating potential
the game is adjudicated as draw (if the -materialDraws option is set).

This way MatingPotential() can later also be used to correct losses by
forfeit to draws (which currently is only done when the opponent has a
bare King).

The accuracy of this type of adjudication in Xiangqi has been highly
improved.

2010-07-11 10:54:59 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in sending cores command to engine

The cores command was alwas sent to the engine(s) when the user changed
it through the menu, even when the engine had sent feature smp=0 (which
is default anyway). NewSettingEvent() was patched to send the new
setting conditionally, based on the engine properties as recorded in
ChessProgramStates first, second; In this particular case it now
consults cps->maxCores. (Note the code for testing the second engine
contains some dirty pointer arithmetic.)

2010-07-11 10:42:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix oneClickMove bug

When checking for unique captures, no attention was payed to the option
setting, so the capture was also made when the option was off.

2010-07-11 10:39:28 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove duplicate testing for cores feature

The testing for this BooleanFeature occurred twice.

2010-07-11 10:35:13 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove misspelled prototype

NewSettingEvent occurred, next to the correct one, in misspelled form.

2010-07-05 10:00:01 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parsing of SAN shogi promotions

A missing promotion character defaults to promotion in the move type,
but the promotion character was not set when this happened in variant
shogi. And it is especially important there, as the promotion character
'+' will always be missing, as the parser will take it to be a 'check'
symbol, and strip it from the move.

2010-07-05 09:55:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix variant switch on PGN loading

When the PGN specified an essentially different variant, the
piece bitmaps were not properly adapted, because the switch was done by
calling InitPosition(), rather than Reset(). (The latter would destroy
the PGN tags info.) We now added an explicit call to ResetFrontEnd(),
(which is normally done from Reset()).

2010-07-05 09:51:53 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Adjudicate Xiangqi material draws with Advisor-less Cannons

Used the Queen counter for counting Cannons. Note that material draws
with stale Pawns (i.e. on the back rank) are not yet adjudicated.

2010-07-05 09:34:21 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Remove font settings from master settings file

xboard.conf should not contain general font settings (not specific to
one board size) with specified point size. In fact it should not even
specify sizable fonts, as the new system would make specification of a
general font overrule the size-specific settings in the .xboardrc file,
so the persistence of fonts would be completely broken.

2010-06-30 10:52:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Cut board squares out of texture bitmap more cleverly

When the bitmap is larger than the entire board, the squares are now cut
out of the center of the virtual squares from subdividing the bitmap, so
that they stay centered on the grid of a Xiangqi board bitmap. If the
board size exceeds that of the bitmap, the old algorithm is still used,
as the centering would make the edge squares exceed the bitmap, and
cause a black rim around the board.

2010-06-30 10:49:12 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow -flipBlack to work with font-based piece rendering

In addition the font-based pieces will also be flipped vertically in
flipView for variant shogi when -flipBlack is off.

2010-06-30 10:46:43 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow font-based piece rendering in board sizes below petite

At least for variants that use unorthodox pieces, so that switching back
to using bitmaps is not really an option anyway.

2010-06-30 10:41:25 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Ignore checks in 50-move count for Xiangqi

Both checks and evasions are discounted; this is only done after the
naive counting exceeds the maximum, so during most of the game it causes
no CPU load.

2010-06-05 14:38:47 -0700 Arun Persaud <arun@nubati.net>:
removed some garbage from configure.ac that got added a while ago


2010-05-25 21:20:27 -0400 Clint Adams <schizo@debian.org>:
Remove unnecessary double equals from configure.ac.


2010-05-28 11:07:06 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix e.p. bug in xiangqi with -serverMoves option

Sideway Pawn moves were written as e.p. captures in the file with moves,
which led to disappearence of pieces in the viewer.

2010-05-28 11:05:00 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Repair score printing with -serverMoves option

A previous patch had moved MakeMove to before the update of pvInfoList,
so that the score/depth info would not appear in the file with moves.

2010-05-28 11:02:54 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Repair animate dragging

The previous patch had left a stray semicolon in the mouse handler.

2010-05-10 10:32:19 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix game end during dragging

The stale-first-click fix interfered with proper handling of a piece
being dragged when a game suddenly ended (because of opponent resign,
or caling the flag), because up-clicks when the from-square was reset
were completely ignored. Now such an 'unmatched' upclick calls
DragPieceEnd() and redraws the board.

2010-05-10 10:09:36 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Pop down old tags on loadng new game in WinBoard

ResetFrontEnd(), called from Reset(), did not do this in WinBoard
(unlike XBoard), so that the tags from the previous game were left on
display when -autoDisplayTags was off.

2010-05-09 22:15:27 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Reverse mousewheel action

Apparently WinBoard was stepping in the opposite direction through the
game in reaction to the mousewheel as every other GUI in existence.

2010-05-09 22:07:30 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in sending "usermove" when forcing book moves

The keyword "usermove" was copied to the buffer, but not sent before it
was overwritten by the actual book move.

2010-05-06 17:23:24 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix engine stall on perpetual-check evasion

The adjudication code had already put the engine in force mode after
postponing the actual adjudication to the next move. Now first determine
if we want to adjudicate now, and with which result, before stopping the
engine and ending the game.

2010-05-06 16:37:04 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Let move parser return ImpossibleMove for off-board moves

It used to return 0, which interfered with buiding a game list. This
broke reading of multi-game PGN files containing games in a variant with
a board size larger than that of the currenty active variant.

2010-04-06 15:05:10 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Alter XBoard key bindings to mimic WinBoard

A lot of new bindings were added, and four menuProcs had to be registered
to be able to add bindings to them. The use of the control key as
temporary take-back for the last move conflicted with the use of Ctrl
keystrokes, and this function was migrated to '.'. The iconify function
had no shortcut in WinBoard, but to get rid of letter bindings it was
migrated to '-'.

2010-04-05 20:45:45 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Update README file


2010-04-03 14:00:40 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix typos in html help file


2010-04-01 15:22:41 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix JAWS piece drop cursor, and streamline some sentences

The cursor square was reset to a1 after every use of the piece menu,
which was very inconvenient. Some of the spoken sentences have been
improved; the square is read before the piece now, when using the arrow
keys on the board.

2010-03-31 22:31:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow escape sequences in telluser(error) messages

The routine EscapeExpand was moved to backend.c, and applied to the
message received from the engine.

2010-03-31 21:29:39 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow lower-case promochar in moves of type h8=Q

Updated the parser rules. Other move formats already allowed this.

2010-03-31 21:36:14 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix Alt+M JAWS command in Two-Machines mode

The command refused to read the ast move because it contained thinking
output of the other engine. Let it pay attention to evenIfDuplicate.

2010-03-29 09:57:48 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix rep-draw recognition

The refactoring had broken the rep-draw recognition, by adding and extra
condition in a conditional with side effects. The testing of this extra
condition is now moved to after the side effect.

2010-03-28 12:32:07 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Allow any %ENVIRONMENTVAR% in WB settings file name rather than ~

Only a single variable at the beginning of the file name is recognized,
and the matching is not fool proof (it matches across backslashes).

2010-03-28 11:24:44 +0200 H.G. Muller <h.g.muller@hccnet.nl>:
Fix info lines being used as normal thinking output

The new standard of using thinking output with time = nodes = score = 0
as info messages for printing in the Engine-Output window was not
understood everywhere, and led to such info lines being used for
autoKibitzing and PGN annotation. The programStats are now only updated
from thinking output received from an engine when it is not an info line.

2010-03-27 11:54:41 -0700 Arun Persaud <arun@nubati.net>:
new developer release


2010-03-26 21:16:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress background observe for boards with own game number

This is really a work-around for an ICS bug. The Variant-ICS sent the
initial board of a game in a move list with relation = 0, which means
'observed'. So XBoard was thinking it was observing its own game, and
switched to dual board. It seems harmless to suppress such a switch for
all boards of your own game, however, which is now done.

2010-03-26 21:12:19 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix crash on switching to ICS xiangqi game

The oldBoard was a local variable, and only squares of the old board
were initialized. This led to a crash if the copied board was enlarged,
and then displayed. The variable is now declared static, so the
uninitialized squares contain harmless zeros.

2010-03-26 18:32:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let Chat Boxes pop up above console, rather than on top of it

Use EnsureOnScreen() to have them overlap if there was no room.

2010-03-26 18:26:04 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix disabling of Chat Box navigation buttons

The buttons for non-open boxes were enabed, rather than disabled.

2010-03-26 18:17:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Prevent <Esc> closing chat box

Let it in stead switch focus back to the console window.

2010-03-26 15:28:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let WinBoard recognize ~ in settings file name as HOMEPATH

Fetch the appropriate environment variable to build the mathname in
MySearchPath() whenever the file name starts with "~\".

2010-03-26 13:59:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change name of Global Settings menu item to Common Engine Settings

The old name confused ICS users, as this is an engine-only dialog.

2010-03-26 13:58:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update WinBoard RTF docs


2010-03-26 13:57:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update WinBoard html help


2010-03-24 18:00:08 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow adjustment of clocks in any mode with shift+click

In practice changing to edit-game mode during a game was very
cumbersome. In WinBoard shift+click is now offered as an alternative.
Make sure a right-click in the clock area is not also counted for other
purposes.

2010-03-24 17:21:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow loading of PGN variations in XBoard

Right-clicking variation comments in the comment-window was implemented
through a translation. The right button is now bound to routines that
set both the end and start of the selection, as setting a new start does
not seem to work if the previous select-start was not completed by a
select-end or extend-end. Finally the main handler uses the selection
cursors to know what was clicked.

2010-03-24 17:16:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Update XBoard docs

Added a descripton of the new ICS options (seek graph, back-ground
observe) and menus (Upload) to the texi file. Also added a description
of the variation (Annotate menu item and PGN variation comments) and PV
walking (clicking engine-output). Describe the -shuffleOpenings option.

2010-03-24 13:30:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Paint highlights on dual board (WB)

The highlight info is hidden in the partner board to pass it to the
front-end.

2010-03-24 13:14:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix handling username change during game

The title bar and gameInfo (going into the PGN) were not adapted when
the username was changed through the menu, so that the change became
only effective on the next game. Requires SetGameInfo to be called from
the front-end, and thus a prototype for it in backend.c.

2010-03-24 11:04:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix window-position upset on failing engine start in WinBoard

The main window was only positoned according to the settings-file data
after the engine was started up from InitBackend2(), so that if the
latter gave a fatal error, and Save Settings on Exit was on, a wrong
position for the main window would be saved. The call to InitBackend2()
is now moved until after setting the main-window position.

2010-03-23 23:22:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Display PV from Engine-Output window (XBoard)

Translations are added to bind button 3 to the PV walk for the memo
widgets, and the corresponding handlers are ported from wengineoutput.c.

2010-03-10 18:54:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Set keyboard focus at startup to board window

This makes XBoard sensitive to the keybindings also when the cursor is
outside the board window. This focus seems to persist indefinitely: each
time the board window gets selected, the key bindings become activem
wherever the mouse pointer is. Downside: the mouse pointer is no longer
an arrow outside the board window, but becomes a text-insert tool there.

2010-02-27 20:49:21 -0800 Arun Persaud <arun@nubati.net>:
added logo files for xboard

logos are installed in the hicolor theme [1] using $datadir as the basedir.
Added both png and svg logo.

[1] http://standards.freedesktop.org/icon-theme-spec/icon-theme-spec-latest.html

2010-02-27 17:36:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remake programVersion string after receiving engine features

The engine could have sent a more accurate version of its own name
than the one derived from the exe filename in a myname feature, and we
better use that in the programVersion string, which will be sent as
interface name to the ICS.

2010-02-25 19:22:00 -0800 Arun Persaud <arun@nubati.net>:
Revert "Repair settings-file name"

This reverts commit a02042ef83ce1f3632f0cf3e0a2a4ce9a3ac5d85.

2010-02-25 20:32:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add -autokibitz checkbox to UCI-options menu dialog


2010-02-25 20:29:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Also capture (numeric) whispers of players for -autoKibitz


2010-02-25 20:25:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add kibitzes and c-shouts Chat Box

A box dedicated to c-shouts will snatch any c-shout before it is
diverted to a normal shouts box. The kibitzes box can capture the
left-overs of -autoKibitz, if the latter is active.

2010-02-25 15:45:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Mark non-compliant lines of engine in debug file

The option -engineDebugOutput is extended to accept value 3 for printing
a cear indication of non-compliancy in the debug file.

2010-02-25 12:02:58 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Redraw second board on expose events

The -dualBoard option now does refresh the second board after another
window uncovers it. To acheive this, some data structures remembering
what is displayed had to be duplicated. (lastBoard and damage for XB,
lastReq, lastDrawn, lastReqValid and lastDrawnValid for WB.)
WinBoard now uses clipping also for second board. This required the
clips for the destination to be translated horizontally!

2010-02-25 15:13:00 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Print seconds with 2 digits in backgroundObserve status line


2010-02-24 17:01:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Do not recognize non-ICS variants from PGN event tag

These variants were introduced after supporting the variant tag, so if
the variant tag is missing, their recognition from the event tag will be
a false match. (Mainly to prevent events with 'super' in the name being
recognized as Superchess.)

2010-02-23 13:52:51 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix display of uninitialized boards in background observe

A variable partnerBoardValid is cleared on starting our own game, and
set when a board from the background game comes in during it. At the end
of our own game, a valid partner board now is put in the display.

2010-02-23 13:46:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add option Display Logo in WB general-options menu

Changing the option requires InitDrawingSizes to be called for
re-formatting the board window. Switching it off requires clearing of
the cps->programLogo fields to take effect immediately. Switching it on
only takes effect the next session, as we will need some refactoring to
redo the figuring out what logos to display.

2010-02-22 12:02:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Group Chat Boxes with console in stead of board window

They now open and close with the console, which seems more natural, and
prevents the console from covering them.

2010-02-22 11:50:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put new options in WB ICS-options dialog

The Seek-Graph, background-observe and Chat-Box options are added to the
ICS options dialog. They only control the appData settings, there are no
special actions yet on switching the settings.

2010-02-22 11:46:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Create space in WinBoard ICS-options dialog


2010-02-20 12:42:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use side-by-side boards to display background game

A game observed in the background (i.e. if -backgroundObserve true) will
be displayed right of the normal board in the same window if the new
(persistent) Boolean option -dualBoard is also set.
Very flakey hack, especially in XBoard, where clocks and messsage
field all get the wrong width (and resist adjustment in the strangest
ways). The clocks of the partner game are not yet displayed, and
disaster happens when the background and foreground games do not have
the same board format.

2010-02-23 14:57:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Repair background-observe patch

Apparently a commit was lost that I collapsed with 3018a6 while the
latter was already pushed to savannah. Here I recreated this commit from
a diff between the respective commits in the savannah & nubati gits.

2010-01-31 11:07:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Repair settings-file name

The default name is put back to /etc/xboard/xboard.conf, so that XBoard
can again find its settings file. "make install" will still install it
in the wrong place.

2010-02-21 18:43:59 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2010-02-21 19:45:58 -0800 Arun Persaud <arun@nubati.net>:
fixed compiler warning for file-browser code

missing "void"s in the function declaration and missing returns showed up when trying to build on the opensuse build server. fixed now.

2010-02-21 23:09:24 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Put newly opened Chat Box on top

Dialogs always pop up in front, so set the onTop variable that prevents
highighting the button to navigate to it from other Chat Boxes
to reflect that a newly opened Chat Box is in view.

2010-02-21 18:55:03 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix copying of kibitzed info in Engine-Output window

Make sure all lines end with "\r\n" to not lose line breaks on
copy-paste from the memo. (XBoard would strip those again.)

2010-02-21 18:25:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow walking a kibitzed PV

If no tabs are found in te 'thinking output' we assume it is a captured
kibitz message, and look for "PV=" to locate the start of a PV in it.
Also try to include any continuation lines below the selected line.

2010-02-21 17:45:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Insert autoKibitz continuation lines at end of line

In the engine-output window lines that start with the ICS continuation
sequence "\   " are inserted behind the line they belong to, in stead of
at the top. This required keeping thrack of the length of the currently
active line in OutputKibitz().

2010-02-20 15:39:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Don't disturb background observe when receiving new piece

When new holdings are sent when the background game is displayed, we now
ignore this, as presumably we are peeking at our partners game, and thus
should be well aware of what is captured there.

2010-02-19 21:52:06 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Newly lexed parser in XBoard directory


2010-02-19 11:18:21 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let yy_text determine progress of PV parsing

The parsed unit yy_text was not available after ParseOneMove(), because
the buffer switch in yylexstr() apparently destroys it. To solve that,
yylexstr() now is equiped with an extra buffer argument, where it copies
yy_text before the switch, so the caller, ParsePV(), can see what was
parsed in yy_textstr. This is used to update the PV pointer, but also to
save any parsed comments (when ParsePV is used for parsing a PGN variation).

2010-02-18 17:42:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Support playing through PGN variation comments

Right-clicking a variation line in the comment dialog will shelve the
current variation, and parse the comment to replace it. This uses
ParsePV() in an alternative way, for which the latter had to be
enhanced: it was made resistent to move numbers and comments inside
the PV. It now has an argument to indicate if such comments should be
stored with the moves. The Comment Popup is closed on revert, to
make sure no comments to moves that are destroyed, containing
variations on a non-valid line, can keep hanging around.

2010-02-18 16:05:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add Annotate item in Step menu

This does the same as Revert, except that it adds the destroyed
variation as comment to the original movem in PGN variation format.
RevertEvent now has an argument to indicate if it should add the
comment, or not. Comments in the abandoned variation are included in the
varriation command to the main line. (The exact layout of the variation
comment that results leaves still to be desired.)

2010-02-15 19:07:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add option -shuffleOpenings

This volatile option is added just to make the existing variable
available from the command line, not only from the menus.

2010-02-19 11:48:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let the sounds sound on receiving a message in a Chat Box

Use Colorize() to the applicable color to trigger the sound, and then
restore the original color as 'continuation', to do it silently.

2010-02-10 10:55:51 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow WB Chat Box to be dedicated to shouts and 'it'

By putting 'shouts' in the handle field, a chat window will capture all
shouts and c-shouts, and send messages typed into it as shouts.
The bracketing of the shouter name now indicates the type of shout.
The handle for WHISPER Chat Boxes has been changed to 'whispers', to
make it easier to pop them up by clicking the console.

2010-02-16 22:34:23 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add -chatBoxes option to open Chat Boxes at startup

This string option contains a semicolon-separated list of handles for
which Chat Boxes should be opened at startup. The value saved in the ini
file is the value that was read, not the actual chat boxes that were
open at the time of saving.

2010-02-16 19:44:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make Chat Windows pseudo-tabbed

By adding buttons in every Chat Box to navigate directly to every other
Chat Box, a stacked set of Chat Windows behaves like a single tabbed
window, but can still be unstacked. The buttons turn grey to warn that
new text appeared in hidden boxes (i.e. not the one last brought to top).

2010-02-19 21:46:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow arrow keys in WB Chat Box to access command history

The history is shared between al boxes and the ICS console.

2010-02-12 22:35:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make WB Chat Boxes wrap and handle URLs

Cloned the code for the console text field to hande URL. (Initialization
to recogize the link, and notifiction to open it when clicked.)
Removed the ES_AUTOHSCROLL style from the RichEdit in the resource.

2010-02-10 10:58:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix copying of WB Chat Window contents

All line breks were lost on copy-pasting the contents of a chat window.
Adding CR to each outputted line in the front-end (wchat.c) solves this.
(Tell messages sent to a handle (which are not echoed by the ICS, and
thus have to copied to the chat box directly) also need CR!)

2010-02-19 22:34:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add upload of game to ICS for examining

New item "Upload to Examin" in Action menu, calls UploadGameEvent().
Use SAN moves to upload game to ICS, rather than long algebraic
(The ICS did not understand long-algebraic promotion moves)
Use bsetup within examine to set position onFICS, and also variant.
Castling rights do not work yet for FRC. Totally different set of
commands are needed on FICS and ICC.
 FICS does not understand w23 or wild/23, but needs 'crazyhouse' in the
besetup command that specifies the variant. XBoard variant names are
used, except for fischerandom, which is 'fr'. Things like nocastle will
probably still not work.

2010-02-18 17:41:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Handle display of PV that starts with other move than played

Insert the retraction of the played move, without premove highlighting.

2010-02-16 19:36:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix smart capture

Disambiguate was changed to make sure that for ambiguous moves, a
capture would always prevail in the closure, rather than the last move
that happened to be generated. Before, double-clicking a piece would
sometimes plsy a non-capture.

2010-02-13 15:34:04 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix XB crash on giving keyboard focus to non-text widget

In the Engine-Settings dialog SetFocus() could be called for non-text
widgets, and this made XawTextSetInsertionPoint() croak. Setting the
insertion point to the end in SetFocus() was a bad ide anyway, as it
interfered with copying from the engine-output window, which would
uncontrollably scroll on getting focus. It is solved now by setting the
insertion point already on creation of the text widgets.

2010-02-19 22:32:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Seek-Graph bugfix: disappearing output in ICS console

Suppression of output to the cosole was handled fundamentally wrong: it
was not enough to set next_out to after the unit that should be
suppressed, as there can be a backlog in printing of previous units that
came in the same packet. So this has to be flushed first, or it will be
lost. -autoKibitz probably got away with that, because it comes in a
separate packet. But seek ads are often suffixed to other output, and
then that output disappeared! Now we flush everywhere before suppressing.
We now totally rely on the prompt to restart the printing, so that
acknowledgements following the echo of the sent message are also
suppressed. Also suppress LF before diverted chat messages.
  Also fixed is the 'mamer bug' in Chat Boxes, due to false parsing of
a "* (*): " pattern in tell messages, because of a missing continue.

2010-02-12 18:08:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Pop up ICS text menu with default item under mouse pointer

The menu popup is migrated to the down-click (was up-click), so the
up-click can select the item. Some trickery is needed to fool the menu
into thinking that the mouse moved, so that a moveless up-down click in
the ICS text field selects the default item (the upper-right one).
Also allow dummy item in ICS text menu: The command "none" in the ICS
text menu will now be treated as a grayed-out (disabled) entry, so it
can be defined in the position underthe mouse pointer to prevent the
up-click from doing anything, while keeping the menu open. Recommended
for use with an entry of spaces.

2010-02-10 14:42:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow ICS context menu to pop up a Chat Box on clicking handle

A command "chat" defined in the WinBoard icsMenu string will cause
ChatPopUp() to be called when it is clicked, with the clicked handle
(name) in the ChatPartner field, and focus on the input field.
ChatPopUp() had to get a parameter (the handle) to make this possible.
If that parameter is NULL (as when it is called from the Mode menu),
focus will still start on the (empty) ChatPartner field of the box.

2010-02-10 10:50:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix right-edge spillover of Seek-Graph dots in WinBoard

Rescale the X-axis to allow margin for dot size and color offset.

2010-01-30 11:05:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Interface XBoard to GhostView file-browser dialog

Note: The Ghostview dialog was using some deprecated variables for error
printing, and conditionally used getwd() on some systems that presumably
do not have getcwd(), but it did not assess the latter properly.

2010-02-09 14:38:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow recalling history in ICS input box with arrow keys

By adding translations for the Up and Down keys, and stealing some code
from winboard.c. Still needs some refactoring to move the duplicate code
to the back-end.

2010-02-09 14:34:33 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Start insertion point at end of text edits in XB dialogs

The function SetFocus now uses XawTextSetInsertionPoint to position the
end of the string it aready contains, rather than at the beginning.

2010-02-08 17:55:44 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Capture holdings of background observed game


2010-02-08 11:57:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Match handles with multiple titles for channel Chat Boxes

Only handles with at most one suffixed 'title', such as (U), (C), (IM)
or (TD), followed by the parenthesized channel number, were recognized,
so tells by people with more titles always went to the ICS console window.
Patterns are added to recognize handles with upto three such qualifiers.

2010-02-08 11:54:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Do not pop down Seek Graph on on-dot click

Leave the graph up, and let the incoming board of a started game cause
the pop-down. This in case the clicked ad is no longer vailable, or
manuay refused, and fails to start a game.

2010-02-07 21:26:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Observe a game in the background while playing

A new (persistent) option -backgroundObserve true|false is added. When
set, observed boards received while playing a game will not trigger a
game switch, but will be ignored except for storing in a dedicated board
buffer. Pressing the right mouse button will cause the board to be
displayed, until we release it. Time, strength and stm are always
displayed in the message window.

2010-02-07 16:43:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove race condition in clock switching

The move number is now incremented inside SwitchClock, when no timer
interrupt is scheduled, so the interrupt cannot occur at the wrong side
of the increment, and decrement the wrong clock.

2010-02-07 11:53:03 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let second click on piece make only capture, with -oneClickMove

Normally this would clear the highlighting of that piece.
Required new field in DisambiguateClosure to count nr of captures.

2010-02-07 11:18:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix stale first-click

When the opponent resigned after the user had cicked a from-square,
clicking the from-square for the first move in the next game would
produce an "illegal move" message, because it was considered a to-click!
We now set fromX and fromY to invalid in GameEnds().
Should we also reset them on mode changes?

2010-02-07 11:08:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add promotions and e.p. to oneClickMove

For e.p. the to-Square of the Pawn has to be clicked. Promotions are
always to Queen when you click the to-square, but use the promotion
pop-up when you click the from-square.

2010-02-07 10:38:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix error that compiler does not notice

Boolean GLT_GetFromList did not return a value. But no error on Ubuntu!

2010-02-06 18:55:38 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2010-02-06 18:30:42 -0800 Arun Persaud <arun@nubati.net>:
updated year in copyright info


2010-02-05 22:27:51 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
One-click moves

Playing on ICS or against engine, clicking a square from or to which
only a single move can be made causes the move to be done, when the new
option -oneClickMove is set to true.

2010-02-04 16:09:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use squares for computer seek ads

Shape indication passed in sign bit of color (char) variable.

2010-02-04 22:46:41 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use right mouse button to view seek ads

Right down-click does the same as left down-click, right up-click
simulates a left up-click off board (so it misses all dots).

Use right-click miss to refresh Seek Graph

The 'moving' parameter had to be made into an int for this, to indicate
right clicks with code 2. Right press now already pushes the clicked ad
to the back, so that the up-click will display an underlying one.

Bugfix pushing back seek ads on right-click

On a right button press the previous in stead of currently hit ad was
receiving the penalty.

Indicate seek-ad multiplicity

If more than one seek ad is inside the capture range of the mouse
pointer, an exclamation point is printed before the seek-ad text.

Some fixes to make seek-ad suppression work in WinBoard

In WinBoard the z-depth was immediately erased by redrawing the graph;
the clearing of zlist had to be moved from PlotSeekAd() to AddAd()
(where it really belongs). Also aging of z-depth is now suppressed on
mere pointer motion.

2010-02-04 22:45:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Dynamic Seek Graph

The new option -autoRefresh sets FICS and ICC to report removal of seek
ads, and then removes those from the Seek Graph. New seek ads are added
to the graph, as soon as the ICS reports them.

2010-02-04 22:42:15 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement SeekGraph in XBoard

For now only controlled by left mouse clicks on board. New options
-seekGraph true|false and -sg to switch this feature on.

Facilitate selection of coinciding seek ads

Seek-ads that are viewed but not answered get a distance penalty on the
up-click that makes their selection more difficult next time, so that
the ad they covered gets a (better) change. The penalty ages away in the
course of 5 clicks.

Slightly offset Seek-Graph dots of different color

Dots of different color are now displaced horizontally be 3 pixels, to
prevent them from completely covering each other. (Required the axis
labels to be moved a little too, to not be covered by the 1-min ads.)

Auto-show seek-ad texts in WinBoard

Hovering the mouse above a Seek-Graph dot will make the text belonging
to it appear in the message field without the need to press a button.
Required SeekGraphClick() to be called from the WB mouse event handler,
with an extra argument 'moving' to make the distinction with a real
click.

Show seek-ad text on mouse hovering (XBoard)

The Eventproc is also set to trigger on PointerMotion, and this event
then calls SeekGraphClick with motion=true to handle it.

Put poetic name of wilds in seek-ad text

Use XBoard variant names, except for 'loadable' and 'fischerandom'
(becomes 'setup' and 'chess960'), but leave number (to distinguish wilds
that transate to same XBoard variant).

2010-02-05 20:36:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix highlighting bug in XBoard

The from-square was drawn before the to-square was erased, which led to
a missing highlight line if they shared an edge or corner.

2010-02-05 15:49:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Shorten autoKibitz confirmation on FICS

Strip off the "players)", but leave the separatng space.

2010-02-05 14:39:55 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Repair damage to -autoKibitz done by FICS atomic zippy claim

The sending of -autoKibitz info was also moved back in that patch, but
unfortunately to after clearing of the programStats info. Now the
clearing has been moved also, to remain after it.

2010-02-04 23:33:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Send continuation lines to chat box they belong to

The variable savingComment is used as a kludge to remember where the
comment should go (i.e. which chatbox, or elsewhere), so that when a
continuation line is matched, chatPartner (which was reset at EOL) can
be restored to its original value. Also put space after handle of talker
in channel Chat Windows

2010-02-02 19:08:42 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix u64 format for cygwin

With a -mno-cygwin compile %llu and %lld are definitely not understood
by scanf and printf, although they are by the compiler. In stead, %I64u
seems to work. Put it in under control of a switch USE_I64, which is
defined only in the gcc makefile when MINGW is used.

2010-02-02 19:02:28 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Remove stray dot from WinBoard makefiles

There was a period suffixed to config.h in the wgamelist.o dependency.

2010-02-01 14:50:01 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in display of logos

The logo continued to be drawn after a boardSize change to a tinyLayout
size, although there was no space reserved for it. Fixed by explicitly
resetting logoHeight when no logo space is reserved in InitDrawingSizes().

2010-01-19 20:15:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Right-click refactoring: step III

Let WinBoard call RightClick in back-end, and delete the duplicate code
it had for this, after rescuing the front-end bits, and let the letter
act depending on the result returned by RightClick.

2010-01-19 19:07:15 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Right-click refactoring: step II

Migrate the Right-click routine to the back-end. Let it communicate back
square coordinates through pointer arguments, to accomodate their
different naming in XBoard and WinBoard. Template added in frontend.h.

2010-01-19 17:55:05 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Right-click refactoring, step I

Divorce front-end part from back-end part of PieceMenuPopup in XBoard
front-end, and forge the back-end part into a new routine RightClick.
The right up-click in XBoard, which called unLoadPV() directly, now
calls RightClick through PieceMenuPopUp().

2010-02-04 23:09:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Merge gamelistopt sources into gamelist source files

The files xgamelistopt.c and gamelistopt.c are merged with xgamelist.c
and gamelist.c, respectively. The WB front-end for the dialog already
resided in winboard.c, so there was little need to move it to wgameist.c
file. Makefiles adapted accordingly. Unsuitable key bindings were
removed. The low-level front-end prototypes are now defined in in
frontend.h.

2010-01-29 21:47:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Game-List options dialog for XBoard

A dialog similar to that of WinBoard was cloned from the game-list
window. The XBoard front-end is in a separate file xgamelistopt.c,
which in fact implements most of the low-level front-end as back-end.

2010-01-29 12:48:50 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Refactoring of game-list-options dialog

The back-end part is separated off, and moved to a file gamelistopt.c.
Front-end for now stays in winboard.c. No prototypes in frontend.h yet.

2010-01-26 19:28:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix of ancient WB bug: test integer option values for validity

Only a string of digits preceded by an optional sign is accepted now.
Before, any string was accepted, and leaving out a value could lead to
the next option being ignored (if it did not need a value) because it
was considered the value for the previous one!

2010-01-26 19:00:54 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in edit-position of holdings

The holdings were effectivelly taken one too large, so that a promoted
shogi Pawn moved to, or created in the holdings was not demoted to Pawn,
but put in the dark (which you could see by the holding count if you did
it twice). The overflow tests in these two cases now have been corrected.

2010-01-25 13:54:40 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Save fonts in XBoard settings file per boardSize

Each -boardSize now can have its own font specified in the settings file
(and thus by a command-line option, although it would in general not be
very useful to specify a font for a size other than the selected). E.g.
a prefix "size33:" to the font name will apply it only to -size 33.
An unspecified-size font option (not normally in the settings file) will
always prevail over a font option specific for the current size.
A font of some size must have been used or specified in order to be
saved.

2010-01-25 08:56:35 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix width of filter field in XBoard GameList

An empirical dependence of the width of this text edit on the square
size now makes for an acceptable layout at any board size.

2010-01-24 19:09:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use FICS atomic draw claim for sending move in zippy mode

For this the relaying of the move had to be moved until after the
adjudication, which again has to be done after MakeMove(), which is a
bit dubious, as MakeMove might take significant time when animating.

2010-01-24 18:51:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Send FICS atomic claim to ICS if move creates draw after offer

The FICS format "draw MOVE" is used to send the move to the ICS  when
the user enters a move that adjudicates as a claimable draw, and he
offered a draw before the move. For the benefit of ICS that do not
understand this format, the plain move is sent afterwards.

2010-01-24 18:16:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Also allow user to claim by offering draw before his move

Use the existing userOfferedDraw variable to test for such offers in
Adjudicate().

2010-01-24 17:29:42 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Also adjudicate after user move

Call Adjudicate() in FinishMove().

2010-01-24 15:56:56 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Refactoring of adjudication code

Put all the rule-based (as opposed to score-based) adjudications in a
separate routine, so they can also be called on user moves. This
requires sending the drawing move to the opponent engine to be made
conditional on existence of the latter. Execution of the code is no
longer dependent on the condition TwoMachinesPlay, but actual game
terminations are now all restricted by an alternative condition (no ICS
mode).

2010-01-24 11:46:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use -keepAlive option to determine connection health

When there has been no ICS response since the previous 'ping', assume we
are disconnected and do a fatal-error exit. Also auto-start the ping
process in InitBackend3().

2010-01-23 23:00:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Use arrow keys in XBoard GameList for entry selection

Add translations for arrows and home/end, to call LoadSelectedProc with
argument to indicate the step, and let the latter perform the action.

2010-01-23 22:24:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow <Enter> to apply filter in XB GameList filter edit

Apply a translation to intercept the <Enter> key. Set focus back to the
list display afterwards.

2010-01-23 21:44:36 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Accept <Enter> for changing chat partner

A kludge stolen from Alessandro's GameList filter allowed to let the
typing of <Enter> while updating the chat-partner field of the WinBoard
chat windows to act as pressing the Change button. Gives focus to the
input field of the window afterwards.

2010-01-23 21:42:38 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Move duplicat gamelist code to backend

The filtering routines are moved from xgamelist.c and wgamelist.c to
gamelist.c, and a prototype for them is placed in backend.h.

2010-01-23 19:29:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Port game-list filtering to XBoard

Added a text edit and apply button to the XBoard game-list dialog, and
only have it print those lines that match the filter. Translate index in
list to index of game in file when a game is selected, and index in file
to index in list when a line is highlighted. Duplicates some code
between xgamelist.c and wgamelist.c, which should be moved to back-end.

2010-01-21 19:24:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Convert to DOS line endings

For easier understanding of upcoming diffs of winboard.c

2010-01-21 14:32:46 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Refactoring of move-history code

The WinBoard code in whistory.c was split in a front-end part (remaining
in whistory.c) and a back-end part (now in history.c in the xboard
directory). This to allow easy porting to other platforms.

2010-01-20 12:48:30 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add fixed-time/move button in XBoard time-control dialog

Put the TC-type buttons in a radio-group, and highlight the selected mode.

2010-01-19 18:27:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug in XBoard PV display

The PV was unloaded on anything but a button release, in stead of the
other way around.

2010-01-23 11:04:11 -0800 Arun Persaud <arun@nubati.net>:
fixed hardcoded location of config file for xboard

the location should now follow sysconfdir during the configuration process.
Also added some more output to the configure script.

2010-01-18 12:18:32 -0800 Arun Persaud <arun@nubati.net>:
new developer release


2010-01-18 12:15:06 -0800 Arun Persaud <arun@nubati.net>:
fixed Makefile.am to handle config file correctly


2010-01-15 21:55:29 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change opening array -variant fairy

We now use the position of "Chess with Different Armies", FIDE army vs.
a fantasy army (inspired on the Color-bound Clobberers) as opening
position.

2010-01-13 19:08:45 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Add variant Makruk

Thai Chess, played by 2 million world-wide. Required pawn promotion to
happen in a zone, and the Alfil to move as Shogi Silver, a new opening
array, and unusual Pawn placement. Because of the latter, I consider it
a setup position, so a FEN will always be sent to the engine.

2010-01-17 14:17:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix parsing of O-O and O-O-O after FEN pasting in FRC

Because the initial rights were not set in the FEN reader, the
initial rights of the previous game remained in force, so that the
parser did not understand OO-castling (although it would allow KxR
castling).

2010-01-15 14:40:43 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix reading FEN castling rights for knightmate and twokings

Scanning the back-rank for a King did not work in these variants,
because either the Unicorn castles, or there might be two Kings.

2010-01-13 11:42:52 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix omission in castling refactoring for ICS received boards

A default of -1 was still used, in stead of NoRights, when no Rook was
found. In theory this could have had effect in a setup board 0 in FRC,
when there were no Rooks on the back rank.

2010-01-13 11:35:34 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix TwoKings ICS castling-rights bug

Scanning the rank (as is done because of FRC) assigned castling rights
to the rightmost King. Even scanning the opposite direction would not
work, as it is not always the eftmost King that can castle. So we now
explicitly test for a King on e1/e8 in TwoKings and assign it rights,
relying on the Rook rights received from the ICS to control castling.

2009-11-18 19:12:25 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix double start of zippy engine after switch to gothic

In ICS mode we now switch to the proper variant as soon as we receive
the generic game-start message, to prevent a mismatch when the first
board is received (which would trigger fetching of a move list).

2010-01-11 16:44:40 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Extensive bugfix of -autoKibitz

Suppression of printing of diverted kibitz messages failed when they
extended over more than one read. This could even lead to such
messages being erroneously saved as comments, which then lead to
crashes. The suppression mechanism now waits for a prompt, in stead of
the end of buffer. This required the printing of any leftover in the
buffer to be deferred until the next read completes it.
The number of people kibitzed to is now printed.

2010-01-11 16:30:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix piece-to-char table -variant fairy

The letters for Lance and Snake where swapped.

2010-01-09 11:54:20 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make WinBoard makefiles use parser.c in XBoard directory


2010-01-08 18:23:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Docs update for new features


2010-01-08 15:18:37 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix new args parsing of -lowTimeWarningColor

This did not occur in the XBoard color translation table yet.

2010-01-08 14:16:59 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow editing of holdings in EditPosition mode

Dragging pieces to and from the holdings now consistently keep track of
the home square of pieces and the piece counts, as does creation of
pieces in the holdings through the piece menu.

2010-01-08 13:59:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Indicate squares a lifted piece can legally move to

Under control of the new option -showTargetSquares when
-highlightDragging and -testLegality are on, the squares a piece can
move to are marked by fat dots in the highlightColor (non-captures) and
premoveHighlightColor (captures), as soon as you grab it for dragging.
In variants with mandatory capture, the capture target of other pieces
is marked with the highlightColor (as non-captures are then not allowed).

2010-01-08 12:35:10 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix bug for incommensurate time odds

After normalization (-timeOddsMode 1) the time odds factors can be
non-integer, and thus must be stored as float.

2010-01-08 11:41:26 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Display PV right-clicked from EngineOutput window

The clicked PV is selected and the memo gets focus, so that it is
highlighted. This selection is restored in the proper place after
insetrtion of a new line in the memo.

2010-01-08 10:19:32 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Display PV on right-clicking board


2010-01-08 09:21:04 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Bugfix legality null move in parsing with -testLegality off

The pointers were compared, in stead of the values.
Furthermore, instead of null moves, it rejected moves on the main diagonal when legality checking was off.

Also exclude moves with empty squares and enemy pieces.

2010-01-07 19:10:39 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Newly lexed winboard/parser.c


2010-01-07 19:05:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Harmonize declarations of XBoard and WinBoard

The engine-exit and settings patches make some stuff common to WinBoard
and XBoard, which needed to be harmonized, and is moved to frontend.h.

2010-01-07 13:07:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow Ctrl-C copying from EngineOutput window text to clipboard


2010-01-07 12:52:17 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Allow popup-less (fatal) exit of engine after tellusererror


2010-01-07 12:40:12 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Improve layout of Engine #N Settings dialog

An attempt is made to align the input fields of spins and text-edits

2010-01-07 00:31:11 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Let XBoard print version with argument --version or -v


2010-01-07 00:25:57 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix castling rule assignment in shuffle games

The conversion to in-board storage for rights copied directly to boards[0] in steadof
initialPosition, and was then overwritten when the latter was copied with uninitialized
rights to boards[0]. This affected FRC and CRC, where rights are non-standard.

2010-01-07 00:17:25 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Implement castling in -variant caparandom

CRC should be treated as FRC, but until now it never was. We now test for FRC_TYPE_CASTLING.

2010-01-07 00:09:18 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix default castling rights on reading incomplete FEN

This was overlooked in the conversion to the in-board storage of rights.

2010-01-07 00:03:09 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Fix NoncompliantFEN defaults.

This must be NULL to get compliant FENs, not "", which would suppress castling and e.p. fields.

2010-01-06 23:54:49 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Change format of -adapterCommand.

first or f at the start of an option name are now automatically changed into second or s,
rather than needing %% to be recognized. The values of -ec and -ed in the default
-adapterCommand are now quoted (now XBoard understands quoting in the engine command line).

2010-01-06 23:51:16 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Make WinBoard defaults for -fd and -sd equal to "." rather than empty strings.


2010-01-06 23:28:47 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Delete old indirection settings-file code


2010-01-06 21:45:14 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Correct XBoard default debug file name


2010-01-06 21:34:48 +0100 H.G. Muller <h.g.muller@hccnet.nl>:
Suppress saving font settings.

The fonts are size dependent, and might thus not be reusable in the next
session. For now we therefore suppress the saving of them in the
settings file, until we diversify the fonts per boardSize.

2009-12-12 23:38:20 -0800 Arun Persaud <arun@nubati.net>:
added missing sounds files to be able to compile on windows


2009-12-09 17:29:37 -0700 Eric Mullins <emwine@earthlink.net>:
Changes needed to compile master branch.


2009-12-06 12:11:46 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
implements the eval-graph window for XBoard


2009-12-06 11:58:34 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
improves the XBoard handling of the engine command line

it now understands limited forms of quoting, so engine binaries with spaces in their file name can be handled.

2009-12-06 11:56:40 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
A better and more flexible way of invoking Polyglot

rewrote uci.c. No more use of temporary files, all data passed through the engine command line. Adds a new command-line option -adapterCommand for this.

2009-12-06 11:34:50 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
remove trailing \r in xboard output

there is an annoying carriage return (displayed as ^M) at the end of the PV in the engine-output window, not
only with Fairy-Max, but also with UCI engine running under Polyglot. This patch replaces the trailing CR that Linux programs send after the PV line y a space.

2009-11-29 11:56:32 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
double buffer size to prevent overflow

This patch doubles the size of the ICS input buffer to 16KB, to prevent
the suspected overflow with -keepLineBreaksICS false when using
"inchannel 1" on FICS and over 500 people are tuned in.

2009-11-28 13:33:52 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix problem with empty string in -firstNeedsNoncompliantFEN

This fixes a bug in the use of the -firstNeedsNoncompliantFEN option with
an empty string as argument. (Which led to truncation of the FEN.)

2009-11-28 13:32:12 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
updates makefiles to include dependency on config.h

adds the dependency of wbres.o on config.c introduced by having the VersionInfo in the resource

2009-11-28 13:28:00 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
correctly apply some check boxes from the option menu

Usng the check-boxes in the Option->Adjudications menu to indicate the
engine reports absolute scores is now copied directly to the ChessProgramState,
from where it is used, in stead of only to appData. This makes the change take
effect immediately, in stead of after restarting.

2009-11-28 13:27:43 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
score sign in analysis mode

this does not alter any of the current behavior with compliant engines,
but does extend the correction for non-compliant score reporting under
control of the -first(second)ScoreIsAbs option to cases where the engine
is analyzing or playing on an ICS.

2009-11-24 21:09:30 -0800 Arun Persaud <arun@nubati.net>:
fix for bug #28077: xboard needs to link against x11

hopefully fixed automake to take care of this

2009-11-23 20:37:20 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
Fix castling rights when copying FEN to clipboard (again)

missed a spot last time

2009-11-23 20:22:58 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
restoring windows (EngineOutput and MoveHistory) on startup

restoring the open / closed status of the
auxiliary windows (EngineOutput and MoveHistory) on startup
in XBoard like they do in WinBoard, which makes sense now that
we aso remember their coordinates between sessions.

2009-11-23 20:21:14 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some outstanding pixmaps

fixed transparency issues

2009-11-23 20:17:25 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
use linux style options for config file and add a system config file for XBoard

This patch makes XBoard write the options to its conf file in
Linux style, "-option value" rather than Windows style "/option=value".

The WinBoard option parsing code has always understood both formats
(including any hybrids), but the format it preferred for writing might
look quite strange to Linux users. I also attached a file to be installed
as /etc/xboard/xboard.conf on "make install".

2009-11-23 19:58:55 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix window positioning

This patch adds stuff in the header files that allow the various front-end files
to share information on which windows exist, are up, and how they are positioned.
The EngineOutput, MoveHistory and GameList windows now all remember their
position and size, even when they are closed when XBoard exits.

2009-11-23 19:51:19 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
same argDescriptor parsing for Xboard and Winbaord

This patch makes XBoard and WinBoard use the same argDescriptor
list of options, and (largely) use the same code for parsing and saving them.
This is acheived by moving this code to a new file args.h, and #including this
in both winboard.c and xboard.c (so that tiny differences, e.g. in default
values in the table, are decided by the context). XBoard has new menu items
"Save Settings Now" and "Save Settings on Exit" in the "Option" menu.
XBoard uses /etc/xboard/xboard.conf as default settings file.
A new option, -saveSettingsFile, can specify where settings should be saved,
without parsing the file. (So that it also works if the file does not yet exist.)

2009-11-22 13:00:31 -0800 Arun Persaud <arun@nubati.net>:
new developer release

changed release name to <branch>-<date>

2009-11-22 12:34:13 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix the irritating wandering off of the MoveHistory window in XBoard on opening/closing.


2009-11-22 12:29:47 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
use xtell for talking to handles, but tell for talking into a channel.

by changing the chatboxes to use xtell in stead of tell, we broke
the possibility to use the chat-box for chatting into a channel (which is
apparently not possible with xtell).

2009-11-22 12:15:15 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix bug in bughouse drop menu

This patch fixes the bughouse drop menu, which was broken by the
new mouse driver, and could no longer drop white Pawns.

2009-11-18 19:29:57 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
2nd step for moving option parsing from winboard to the backend

This is the next step in option-setting refactoring: All options that are
defined in XBoard are now included in the WinBoard ArgDescriptor list.
The handling of sound option has been harmonized: the sound names
now all initially go to the appData array, (as in XB) in stead of directly to the
WB-specific variables, and LoadAllSounds now takes care of the copying.
A new routine ExportSounds copies them back before saving settings
(which, in XBoard, could be a no-op).

The definition of defaults for the XB-only options has been moved to common.h.

2009-11-18 19:24:35 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
1st step for moving option parsing from winboard to the backend

This is a preparatory step in moving option parsing of WinBoard to the back-end.
The table of command-line options now contains a fifth field, holding the compiled-in default.
This obviates most of the front-end routine InitAppData, which now is replaced by a table-driven
initialization routine SetDefaultsFromList(), which could be back-end.

2009-11-18 12:33:39 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
refactoring evalgraph code

This is the refactored EvalGraph code: the back-end part is separated off,
and put in a file evalgraph.c, which in the future can also be used with XBoard.
Only the WinBoard front-end code is left in the file wevalgraph.c. A new
header file defines the variables and routines they share.

2009-11-18 12:29:06 -0800 Arun Persaud <arun@nubati.net>:
clean-up

some file permissions where set up wrong
(e.g. execute permissions for text files)

2009-11-18 11:34:22 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
refactoring of engineoutput

This refactoring patch separates the back-end part out of
xengineoutput.c, and puts it in a separate file engineoutput.c.
A new header engineoutput.h included by both defines the routines
for cross calling. Similarly wengineo.c will be stripped from its
back-end code, (and renamed to wengineoutput.c), so WinBoard and
XBoard now both use engineoutput.c rather than maintaining duplicate
code in their front-end part.

I also let the back-end now call EngineOutputUpdate directly, rather then
through a relay in the front-end, by renaming it to SetProgramStats
(the former name of the relay in winboard.c / xboard.c).

Moved some templates of functions in engineoutput.c from winboard.h
to frontend.h

2009-11-14 22:13:10 -0800 Arun Persaud <arun@nubati.net>:
fixed build on openbsd

added missing header file

2009-11-14 22:06:58 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
improve thinking-output for mulit-variant

Improve multi-variant support by sorting the Thinking-Output lines of the most recent depth by score in the Engine-Output window.

2009-11-14 22:05:12 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix castling rights when copying FEN to clipboard

This patch forces leaving of Edit-Position mode before copying a FEN to the clipboard, to make sure castling rights are faked in a consistent way. Before you could get FENs that had castling rights for non-existent Rooks.

2009-11-14 22:03:47 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
This patch gives a better handling of comments in PGN files, and adds the variation as comment to the main line on using Revert in local mode.


2009-11-06 18:53:19 -0800 Arun Persaud <arun@nubati.net>:
fixed prototype for AppendComment


2009-11-06 09:06:44 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
cleaned up some debug messages and typos


2009-11-06 09:05:09 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
variation-support patch

It allows you to Revert to the main line (or previous variation) when
playing variations on an existing game in EditGame or Analyze mode.

2009-11-06 08:48:09 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
fix for new way of saving castling and e.p. information

I forgot to make some conversions to the new-style encoding of castling there
(using the enum constant NoRights instead of -1 to indicate
the absence of rights, which was the price of storing the
rights in the board, which is an unsigned enum type.)

I also was a bit worried about portability, because I casted the enum type ChessSquare
to (int) before comparing it with (possibly negative) constants EP_NONE etc.
Now on my system enum types are (unsigned int), and this works, but I could
imagine there are systems where this would be an unsigned char. (Not sure
if there are rules for this). So to be safe I cast ChessSquare to (signed char),
which should always work to make small negative ints assigned to it read
back as themselves.

2009-11-06 08:44:59 -0800 Arun Persaud <arun@nubati.net>:
removed files that should only be in the windboard directory


2009-11-05 19:32:35 -0800 Arun Persaud <arun@nubati.net>:
add Winboard source files into tar-ball

forgot to add them when rewriting the Makefile.am

2009-11-05 19:23:44 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
Integrate castling and e.p. rights into board array; bugfix for EditPosition

A large-scale operation that I have been postponing since the very first 4.4.0:
The castling and e.p. rights are now integrated into the board array, as
boards[moveNr][CASTLING][i] replacing castlingRights[moveNr][i] and
boards[moveNr][EP_STATUS] replacing epStatus[moveNr]
These quantities are now automatically copied with the position by CopyBoards
(allowing the removal of lots of dedicated copying code), and passed as
function arguments with the position (so that the moves.c functions like
TestLegality, MateTest, CoordsToAlgebraic, Disambiguate, GenLegal
no longer need explicit e.p. and castling parameters.

Also fixed a bug introduced by a recent previous fix: by adding fake castling
rights to a position set up through the EditPosition menu, I destroyed the
castling rights of a pasted FEN. Faking castling rights is now made conditional
in EditPositionDone(), depending on the caller. (I had not realized it was also
called after FEN pasting, to send the position to the engine.)

2009-11-05 19:03:17 -0800 Arun Persaud <arun@nubati.net>:
added missing library for build on OS X

Xmu seems to be missing

2009-11-04 22:57:30 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
Some code refactoring and cleanup; one small bug fix

Some code refactoring, mainly to bring definitions of routines and variables
shared between winboard.c and one of the auxiliary-windows files
whistory.c, wevalgraph.c, wgamelist.c, wengineo.c somewere in a header file
(winboard.h). Unfortunately this made winboard.h dependent on data types
defined in frontend.h, so that the #include order had to be changed in many
other .c files.

The operation revealed one potentially bad bug: engineOutputDialogUp was
written as int in engineo.c, but declared as char in winboard.c.

I also changed the storage mechanism of the the comment and tags window
positions to use WindowPlacement structs rather than simple variables,
so that in the future they can be docked, like the others.

I also removed some remnants of the Analysis window.

The wgamelist.h and wedittags.h header files contained only 3 lines, and
I absorbed them in winboard.h, rather than creating other such nearly empty
headers engineo.h, whistory.h and wevalgraph.h. This affects the make files.

2009-11-03 18:26:06 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
let the clocks run in -searchTime mode


2009-11-02 17:41:12 -0800 H.G. Muller <h.g.muller@hccnet.nl>:
add fixed time per move to the WinBoard time-control menu dialog


2009-10-31 10:42:50 -0700 Arun Persaud <arun@nubati.net>:
updated version number to unstable


2009-10-31 10:25:37 -0700 Arun Persaud <arun@nubati.net>:
release of version 4.4.1


2009-10-30 19:59:23 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
cleaned up ChangeLog and NEWS

2009-10-30 20:02:40 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
use xtell instead of tell in wchat

2009-10-28 20:35:06 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
prevent buffer overflow

This is a buffer-size adjustments to prevent the JAWS version from
crashing when it has to read out loud very long comments.

2009-10-28 02:17:16 -0700 Tim Mann <tim@tim-mann.org>:
Further copy/paste fixes

We needed to implement the XA_TARGETS target in order for more
sophisticated apps to really believe we put anything on the clipboard
they can use.

2009-10-27 23:57:25 -0700 Tim Mann <tim@tim-mann.org>:
Make copy/paste position and game use clipboard, bug #27810

Copy actually sets both the clipboard and the selection for
convenience and compatibility with the old way of doing things.
Paste pastes from the clipboard by default, but the new -pasteSelection
option lets you get back the old behavior of pasting from the
selection.

2009-10-27 15:44:28 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
switch focus to the board after loading a game

2009-10-27 15:32:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27826: fixed autoDisplayComment

apparently the -autoDisplayComment option was not working,
not even in WinBoard. This patch should fix it,both for WB and XB.
(Unfortunately xboard.c and winboard.c were using a different name
for the same front-end variable I needed, so I had to change one of them.)

2009-10-27 12:24:56 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27826: ported two options to xboard

also updated the documentation

2009-10-27 12:22:36 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed jaws version

turns out the new mouse handler broke the JAWS patch, as I discarded
the function IsPromotion. I adapted it to call HasPromotionChoice instead.
Also fixed two arnings by removing a no-longer needed debug print.

2009-10-27 12:03:02 -0700 Arun Persaud <arun@nubati.net>:
reformated html to be correctly validated

2009-10-27 10:33:42 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
quick fix for "White Mates" in parser.l

2009-10-27 10:32:24 -0700 Arun Persaud <arun@nubati.net>:
fixed a regression

2009-10-26 20:45:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changed stderr to debug output, since stderr is closed in winboard

2009-10-26 20:42:24 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removing empty lines from ICS play

this patch causes removal of spurious prompts during ICS play
also if the prompt is preceeded by a number of empty lines
(as the board for the opponent move is on FICS).

2009-10-26 20:40:00 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
another bug in VariantSwitch: an unitialized board was printed.

Must have been there a long time, but this time it crashed WinBoard.

2009-10-26 20:38:37 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
more work on variant switch

the previous solution to the cosmetic problem of displaying a wrong shuffle
in an ICS game that was observed from the very start unfortunately turned
out to cause a real error in diplaying a stored game through the smoves
command, for variants not using the FIDE setup as standard.

This patch displays the position from before setting up the start position
of the new variant, but does setup boards[0] to the initial position of that
variant. (If this is a wrong shuffle, it is thus ot displayed, and a new board
will immediately be sent from the ICS to correct the shuffle.)

2009-10-26 20:34:04 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
force full redraw in winboard

Full redraw is now always forced when highlightMovesWithArrow is on,
rather than only when highlight info is available. (As in drop moves the
latter is invalid, but we must still erase the arrow from the previous move.)

2009-10-26 20:25:55 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27790 and #277772. Suppressing the display of a wrong shuffle
when observing shuffle games from the first move (#27790 bis),
and the sounding of the FICS bell on crazyhouse captures (#27772 bis).

2009-10-26 20:22:13 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed bug related to unsigned char in convert.c

I also fixed the unsigned-char bug in the convert.c for bitmaps that caused the
129x129 XBoard bitmaps to be defective, and a bug that required fixup with sed
afterwards (so I could use it to create a new m33s.bm)

2009-10-25 23:37:48 -0700 Arun Persaud <arun@nubati.net>:
unguarded debug printf. added the appropiate if statement

2009-10-25 23:31:13 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for two compiler warnings

2009-10-25 23:29:43 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27799: fix for nested-nested-nested variations

2009-10-25 23:21:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
The book-probe code forgot to close the book file after opening it.

fixed by adding an fclose at two points.

2009-10-25 23:18:18 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removed unused v54?.bm bitmaps from resource file

it seems the v54?.bmp bitmaps were actually included in the WinBoard build
(in the resource file), although they were never actually used. So I have
removed their inclusion in the resource file now.

2009-10-25 23:05:30 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
replaced defective bitmaps with copies from 4.2.7

2009-10-25 23:02:08 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removed bitmaps files that are not needed any more

2009-10-25 22:58:34 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some bitmaps

2009-10-24 09:41:39 -0700 Tim Mann <tim@tim-mann.org>:
Drop an obsolete script that was only used to update my personal web site

2009-10-24 01:23:29 -0700 Tim Mann <tim@tim-mann.org>:
Silence warnings when compiling 64-bit xboard

Some harmless warnings were caused by 64-bit mode having 32-bit
int but 64-bit long and pointer.  Add casts (etc.) to silence them.
This might require adding a definition of intptr_t (a signed int
type that is the same width as a pointer) on old systems that don't
have it.

2009-10-24 00:56:37 -0700 Tim Mann <tim@tim-mann.org>:
Fix up man page some more

Sigh, the project history was still partly in reverse chronological
order and partly in forward order.  Swapped the order of some
sentences to help straighten it out.  I don't really care about this,
so other project members should feel free to do what they like here,
but the messed-up order was bugging me.

2009-10-24 00:46:20 -0700 Tim Mann <tim@tim-mann.org>:
Fix some issues in the XBoard man page

Correct places where the XBoard man page was calling XBoard
"WinBoard".  Change references to "WinBoard engines" and "WinBoard
protocol" to "XBoard/WinBoard ...".  Update bug reporting guidelines.
Reorganize project history to something more like chronological order
-- it had gotten pretty randomly ordered.

2009-10-22 21:45:32 -0700 Arun Persaud <arun@nubati.net>:
new pre-release version; updated version numbers

2009-10-22 21:33:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
This patch adds <Enter> to the characters that cause an automatic
switch to the ICS console when typed to the board window.

2009-10-22 21:31:16 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix to the minor graphics issue contained some typos,
as was remarked in the bugs reports

2009-10-22 21:30:08 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
improved mouse handler

The improved mouse handler still needed an extra call to DrawPosition to
work in XBoard.

2009-10-22 21:28:38 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
NPS plays and pondering

Clock updating did not work correctly in node-based time controls when the
engine was pondering. (It was not really meant for use with pondering. Oh well...)
This patch checks if the engine reporting the node count is indeed thinking
(as opposed to pondering).

2009-10-22 21:25:36 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
holdings update and regression fix

The holdings-update patch was not yet satisfactory, because FICS seems to send
holdings both before and after the board! And those received before did overwrite
the holdings received after the previous board. I know tried to fix that in a kludgey
way, by hiding a flag in the board that tells if the holdings have already been written
by the ICS or not, and ignore new holdings when they are. (Except in bughouse,
where holdings updates cannot be tied to a particular board and multiple updates
between boards are normal. (I hope?).)

I also undid a regression in my previous fix for the minor graphics problem,
and solved it in a slightly different way to prevent flicker.

2009-10-22 21:23:39 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
improved mouse handler

I improved the mouse handler in a way which will preclude disappearence of pieces
on off-board or ambiguous (in-between squares) drag & drop moves. (As was reported
in the "premove bug?" thread. Also the command-line premove problem reported there
is now fixed, by removing the prefixing.

2009-10-22 21:18:05 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #8847: moving backward while examining on FICS not reported to engine

I moved Daniel's code that backs up the engine when a bord with a
lower number is received to a place where it is always done in zippy mode,
rather than only when the engine is analyzing.

Apart from taking back moves, there was also the case where the
user moves forward by more than one move (usually immediately to
end-of-game). In this case a new movelist is fetched from the ICS
to recover the moves that were skipped. But this assumes that the
engine is at the start of the game and feeds all these moves to the
engine. So the engine had to be reset in this case to stay in sync.

2009-10-22 21:16:56 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
better init for random number generator

2009-10-21 23:01:09 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27772: holdings not updated

holdings lines from the ICS nor update the holdings
of boards[forwardMostMove] in stead of boards[currentMove].

2009-10-21 21:32:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
allowe parsing / disambiguation of SAN moves like Xe4 in certain situations

This patch allows parsing / disambiguation of SAN moves like Xe4, if there
is only one wild-card piece X on the board. Moves with wild-card pieces
are now considered illegal if they leave the King in check by a piece of
known gait.

2009-10-20 19:09:46 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed bug when switching to variantsuper

2009-10-20 19:06:43 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27715: 2 (minor) graphic issues

I forced a total redraw when Reset is called from the ICS code in case a
new game is encountered, in the hope it will make the reported
(irreproducible) problem go away. As game switches are not frequent, I
guess there is hardly any downside to this.

2009-10-20 18:57:17 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27667: PV line missing in analysis window, part 3

"3. Wish for Engine state string (right to the icon):
Can you add the actual search depth in analyzing mode? A change like "

I also added the requested display of depth of the analysis move in the
EngineOutput window. I guess a similar change could be made to wengineo.c
(as this is in the code they share in common), but no one ever requested
that in the 5 years since Alessandro wrote it. So for now I leave it alone.

2009-10-20 18:52:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27760: debug printf in backend.c and additional check for variant

2009-10-19 23:17:46 -0700 Arun Persaud <arun@nubati.net>:
fix for bug #10990: cmail does not seem to support .cmailgames or .cmailaliases

this is correct, deleted the text out of the documentation that claims we support it

2009-10-19 18:40:40 -0700 Arun Persaud <arun@nubati.net>:
new alpha version; first one with new naming scheme

2009-10-19 18:07:21 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
smarter analysis of the boards that XBoard receives from an ICS

I added smarter analysis of the boards that XBoard receves from an ICS,
based on board size and piece types in the position, to recognize cases
where the board does not match the current variant, and switch to an
appropriate variant.

2009-10-19 18:04:08 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27667: window should be reference to toplevel

The remaining objections of #27667 should be fixed by bringing the
EngineOutput window under control of the TOPLEVEL compile-time switch.

2009-10-19 18:02:42 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
partly fix for bug #27715: scaling of menu bar

the menu bar to the left edge of the window.

2009-10-19 17:59:43 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed bug reported in WB forum: second game of a match would
not start when using the GUI book

2009-10-19 17:57:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27751: negative holding counts displayed

I put code in the back-end to prevent holdings counts from
becoming negative when a drop move is made from empty holdings.
(This can happen when re-loading ICS bughouse games,
as the smoves command fails to fill the holdings.)

2009-10-18 20:54:53 -0600 Eric Mullins <emwine@earthlink.net>:
Updated compiling instructions.

2009-10-18 11:32:55 -0600 Eric Mullins <emwine@earthlink.net>:
Changes to allow fonts with any charset (such as terminal)

Affects winboard only.

2009-10-16 23:02:41 -0600 Eric Mullins <emwine@earthlink.net>:
Moved SIGWINCH signal so it can be used...

I goofed putting this in StartChildProcess() originally.

2009-10-16 22:54:12 -0600 Eric Mullins <emwine@earthlink.net>:
Added internal wrapping ability.

New options:
  -wrapContinuationSequence "foo"  (default: "\\   "
  -useInternalWrap (Winboard default: false, XBoard default: true)

Note: -keepLineBreaksICS if set, prevents wrapping, usurping the
   useInternalWrap setting.  The idea is if you want to keep ICS line
   breaks, then you don't want internal wrapping.  Because of this,
   the new default for keepLineBreaksICS is now false for XBoard.

2009-10-16 19:14:34 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed segfaul in convert.c used to convert pixmaps

2009-10-15 19:46:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
new mousehandler to correct for premove and promotion popup

this is the new mouse handler for XBoard, which should fully implement
premove, including promotion popup, and yet suppress the promotion popup
on illegal moves that are not premoves. It is almost completely moved to
the back-end now, so that WinBoard will be able to use it as well. I just
must hook it up to winboard.c, in particular harmonize the call-backs of
the mouse driver into the front-end for grabbing and releasing pieces for
dragging, to make sure they have the same names and arguments.

2009-10-15 19:32:55 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated black fairy pieces

here is a set of black fairy pieces with opaque white details,
so they have the same style as the orthodox XBoard pieces.

2009-10-15 16:54:51 -0600 Eric Mullins <emwine@earthlink.net>:
Adjustment to joining to work around server not always including space.

This patch implements commit 98aa02bda540f17f1f50be00e494efafe439b004
into the updated joining routine.  This issue seems not to be server
variance, but instead the server electing to omit the space between
words when it occurs at exactly your width setting (-1 actually).

This patch makes the joiner add back the space just like the referenced
commit.  Note: this is just a workaround to a server issue-- the joiner
actually joins correctly before this patch.

2009-10-15 07:18:42 -0600 Eric Mullins <emwine@earthlink.net>:
Fixed joiner detection, allowing it to work with timeseal

When timeseal's buffer fills in the middle of the continuation
sequence, detection fails, and the lines aren't joined.

As a result of this fix, measures intended to bypass joining are
no longer needed, so I removed them.  These utilize server vars
when available to prevent splitting.

2009-10-14 14:42:37 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed engingeoutput routine

removed outdated code regarding analysis window

2009-10-14 14:39:06 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
moved bitmap to correct location

was misplaced in a previous commit

2009-10-14 14:26:09 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed wrong number of arguments for EngineOutputPopUp

2009-10-13 21:00:27 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
new bitmap converter (including fill option) and new pixmaps

2009-10-13 20:52:40 -0700 Arun Persaud <arun@nubati.net>:
forgot to add these two lines to the last commit

2009-10-13 20:51:17 -0700 Arun Persaud <arun@nubati.net>:
removed AnalysisPopUp. Use EngineOutputPopUp instead

this was already in Winboard, copied it to xboard and removed unused code.

2009-10-13 20:32:32 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Proper board and holdings size when switching to variants
gothic, capablanca, great and super within an ICS game.

2009-10-13 20:25:13 -0700 Arun Persaud <arun@nubati.net>:
cleaned up an old #ifdef in zippy

2009-10-12 19:25:17 -0600 Eric Mullins <emwine@earthlink.net>:
neglected this for the auto-width updating in xboard

2009-10-12 19:19:59 -0600 Eric Mullins <emwine@earthlink.net>:
Added server width adjustment based on client width changes

2009-10-12 19:14:53 -0600 Eric Mullins <emwine@earthlink.net>:
silence some compiler warnings

2009-10-11 18:39:24 -0600 Eric Mullins <emwine@earthlink.net>:
Maintainence to support all compilers.

2009-10-11 17:07:27 -0600 Eric Mullins <emwine@earthlink.net>:
Adjusted alternative joining method to obey keepLineBreaksICS

2009-10-11 14:48:55 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27668: e.p. field still not passed to engine

PositionToFEN now takes the e.p. rights from epStatus[moveNr],
rather than calculating it on the spot from moveList[moveNr-1]
(which failed on the first move).

2009-10-11 14:46:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27666: naming of variants

Variant names "misc/xxx" are recognized as "normal", rather than "xxx"
to not get confused by the board "misc shogi" run by FICS.

2009-10-11 10:14:09 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changed enable menus

Put the "Open Chat Window", "Machine Both", and "Engine #N Settings" menu items
in the appropriate enable lists for graying them out wen not applicable.

2009-10-11 10:13:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Added a command-line option -keepLineBreaksICS true/false to control line joining.

2009-10-10 19:30:23 -0600 Eric Mullins <emwine@earthlink.net>:
Added code to prevent unnecessary width updates.

2009-10-10 18:34:37 -0600 Eric Mullins <emwine@earthlink.net>:
Turned off wrap when possible on ICS servers.

Turning off line wrap prevents splitting lines up using the
continuation sequence "\\   ".  This is desirable when using
timeseal because timeseal's buffer is sometimes too small,
causing it to break lines itself.  These lines can't be joined.

2009-10-10 16:30:56 -0600 Eric Mullins <emwine@earthlink.net>:
vsnprintf() must be _vsnprintf() for MSVC

2009-10-10 16:16:45 -0600 Eric Mullins <emwine@earthlink.net>:
added code to handle initial width update

2009-10-10 14:21:12 -0600 Eric Mullins <emwine@earthlink.net>:
Added width updates to ICS client on font and window size changes

What still needs to be done is placing an update call after login
to initialize with the correct width.  I didn't see where to put
that.

2009-10-10 14:19:30 -0600 Eric Mullins <emwine@earthlink.net>:
added ics_printf() and ics_update_width() and utility functions

2009-10-10 11:15:50 -0600 Eric Mullins <emwine@earthlink.net>:
Cleaned up ConsoleWndProc  (not complete, see below)

Using static variables this way is not appropriate.  I only addressed
hInput and hText in this commit though.  But imagine the WndProc being
used by multiple windows instead of just one, and you can see why
using static variables in this way is wrong.

2009-10-10 11:12:10 -0600 Eric Mullins <emwine@earthlink.net>:
Restructured URL code so it fits better with how winboard is set up.

2009-10-10 08:57:39 -0700 Arun Persaud <arun@nubati.net>:
cleanup: removed "#if 1" statements

2009-10-10 08:55:21 -0700 Arun Persaud <arun@nubati.net>:
cleanup: removed "#if 0" from source

a bit of cleanup of the source code

2009-10-10 08:34:10 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix joining of lines split by ICS

This patch fixes the joining of lines that were split by an ICS, so that adding
a space at the break point is done only when there was not a space already.
(Some ICS leave a space at the end of the broken line, others do not.)
An extra space would interefere with board12 in Gothic Chess, which is so
long that the ICS breaks it, and the WB parser could not handle a double
space within the board.

2009-10-10 08:27:55 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for bug #27642: Clock jumps strangely in engine mode

This moves SwitchClocks() back to after incrementing forwardMostMove,
so that it knows again who has the move (which was broken by the "bare" patch),
and will take the appropriate tick length.

2009-10-10 08:26:13 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removed test for premove

this was added while looking for the premove bug, but is not needed

2009-10-10 02:03:45 -0600 Eric Mullins <emwine@earthlink.net>:
added URL detection and provided hotlinks in the ICS client

2009-10-10 02:00:52 -0600 Eric Mullins <emwine@earthlink.net>:
reverted winboard.c beofre URL commit to correct whitespace conversion

2009-10-09 02:14:22 -0600 Eric Mullins <emwine@earthlink.net>:
Added URL detection into the console text window for ICS.

2009-10-08 23:51:06 -0700 Arun Persaud <arun@nubati.net>:
added some comments and formated code

2009-10-08 23:46:52 -0700 Chris Rorvick <>:
fix printing out help message (list of command line options) (tiny change)

The postfix increment always resulted in an attempt to print out an
option on the right side regardless of one actually existing. Use
prefix increment to prevent a crash when printing an odd number of
options.

2009-10-09 00:04:51 -0600 Eric Mullins <emwine@earthlink.net>:
Updated navigation accelerators, fixing ICS problems.

Recent changes to the navigation accelerators were in the wrong
accelerator table.  Since the goal was to correct non-JAWS versions
back to 4.2.7 behavior, I updated it to how 4.2.7 did it, but still
retained the #ifdef JAWS conditional compilation.

On an ICS, the navigation keys took control away from the ics
client to navigate the game.  The update requires the ALT key to
be pressed, but it works identical to 4.2.7, not causing an
unexpected focus back to the board window when you're just editing
text.

2009-10-08 20:33:39 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed premove recapture problem;promotion popup appearing on
obviously illegal moves; promotions in Superchess and Great Shatranj

1) the premove recapture problem
2) the promotion popup appearing on obviously illegal moves (the 1. e2a8
problem)
3) promotions in Superchess and Great Shatranj, where the piece can now be
selected from the holdings

2009-10-08 20:28:50 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added forceIllegalMove to xboard

2009-10-05 21:01:32 -0700 Arun Persaud <arun@nubati.net>:
bugfix: segfault when invalid option argument was given (bug #27427)

when given a wrong argument to an option (e.g. -tc 0) xboard aborts
before setting up the window, but tried to write a message to the
messageWidget which doesn't exist at that point.

2009-10-05 20:05:00 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
small improvement for JAWS version

This is a patch to make JAWS read out any comments when /autoDiplaycomment=true.
As focus does not stay on the Comment window, the comment was not spoken otherwise.

2009-10-05 20:02:50 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated to winboard internationalization scripts

Also a slight improvement of the internationalization scripting,
to prevent it from crashing on messages containing a slash.

2009-10-05 20:01:53 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
new forceIllegalMoves option

The -forceIllegalMoves option uses setboard or edit to force a position
when an engine refuses the move leading to it by an "Illegal Move" message.
Especially for engines using the edit command this was a bit tricky,
because of the a2a3 kludge to avoid using the white and black commands.

2009-10-05 01:01:54 -0600 Eric Mullins <emwine@earthlink.net>:
removed _winmajor if not defined so that VC 2008 can compile the project

The oldDialog variable should just be set to 0 in all cases now, and
as such, legacy code supporting the old dialog ought to be removed.
The test for _winmajor is against < 4, which is always false at present,
causing oldDialog to be 0 in every conceviable circumstance.

2009-10-04 09:58:29 -0700 Arun Persaud <arun@nubati.net>:
getting ready for 4.4.1 release

2009-10-02 20:47:01 -0600 Eric Mullins <emwine@earthlink.net>:
Simplified future version changes.

Added a numeric version to config.h that is now used in winboard.rc
instead of being hard-coded there.  Just be sure to preserve the
proper format (4 comma-separated 16 bit integers) or else it won't
compile.

2009-10-02 16:56:01 -0700 Arun Persaud <arun@nubati.net>:
updated version number to 4.4.1.pre

should have done this straight after the last release, but forgot...

2009-10-02 16:48:03 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
worked on premove bug

I made an attempt to make premove unsensitive to a race condition,
just in case the premove problem was caused by that (which seems unlikely,
but in any case  I added some debug printout to test this).

2009-10-02 16:41:12 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed loading of saved games via command line

the variables forwardMostMove and backwardMostMove where set to zero
at the wrong place.

2009-10-02 16:39:20 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
small fixes for the JAWS version

* I moved saying 'check' by the JAWS version to where castling also benefits from it.
* I made sure the check symbols are also recognized on promotion moves
* In the non-JAWS version, define the plain arrows as shortcut keys for the button bar

2009-10-01 16:50:28 -0600 Eric Mullins <emwine@earthlink.net>:
Fixed bug dereferencing garbage, causing crash.

Commit fa8be4a3fc5d81e9ec1f6c218fcf55c95d34fd10 included code to free the
resultDetails of the gameInfo structure.  That exact code exists a few lines
above where it was added.  None of these free() calls finish by setting the
member to NULL afterword, therefore repeated attempts to test/free() the
members result in an attempt to free() memory winboard no longer owns, and
an eventual crash.

link to problematic commit: http://git.savannah.gnu.org/cgit/xboard.git/commit/?id=fa8be4a3fc5d81e9ec1f6c218fcf55c95d34fd10

2009-10-01 16:49:57 -0600 Eric Mullins <emwine@earthlink.net>:
Added wchat.c to the project files we maintain.

2009-10-01 15:52:50 -0600 Eric Mullins <emwine@earthlink.net>:
Previous fix for VC++/strcasecmp() was wrong-- use StrCaseCmp().

2009-10-01 14:49:58 -0600 Eric Mullins <emwine@earthlink.net>:
Add resource ID for new Mute menu item.

I know this was probably done by HG, and simply left out of
his commit.  Anyway, the project can be built now after this change.

2009-10-01 14:49:09 -0600 Eric Mullins <emwine@earthlink.net>:
Use of strcasecmp() broke Visual C++.

2009-09-30 20:47:00 -0700 Arun Persaud <arun@nubati.net>:
wrong default value for engineDebugOutput

the new default is now 1

2009-09-29 22:55:41 -0700 Arun Persaud <arun@nubati.net>:
updated cmail.in to adapt the CVS->git change

don't reference $Revision:$ anymore.
Instead use reference xboard-version via autoconf.

2009-09-29 22:04:25 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
bugfix for protocol extensions: egtbpath -> egtpath

A new and very bad bug was discovered in the implementation of
the protocol extensions: XBoard sends a command "egtbpath" to the
engine in stead of "egtpath" from the protocol specs.
After discussion on WB forum it was decided that egtpath was better
than the egtbpath I originally had proposed, and I changed it accordingly,
but I had not realized that this string occurred TWICE in backend.c,
depending on if matched the -defaultPathEGTB of -egtFormats option.
I only changed the first occurence.

2009-09-27 12:27:44 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for edit-position "moves" being sent by XBoard to the engine

2009-09-27 12:25:25 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Engine did not start playing when out of GUI book on second move with white

2009-09-27 12:24:30 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Opening Engine #1 Settings crashed XBoard when there were no
text-edit options in the dialog (to which to set keyboard focus)


2009-09-27 12:18:35 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added a "Mute All Sounds" item in the WinBoard Options menu, on Eric's request

2009-09-27 12:15:20 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Updated the RTF docs for the chat windows, engine-settings dialog,
/keepAlive option and new game-list tag

2009-09-27 12:14:25 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Made the beep sounds for JAWS board navigation configurable through
command-line options

2009-09-27 12:11:49 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Prepared a system to internationalize the WinBoard menus

2009-09-27 12:10:38 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added the result comment to the game-list tags when the game list is
exported to the clipboard

2009-09-27 12:05:32 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
rewrote wevalgraph for better frontend/backend separation

I have finished re-writing the eval-graph code to have some
front-end / backe-end separation, something I had already started on my
holiday in Norway (when I had no internet :-)  ).
The new code now appears to work exactly like the old code,
and I guess it could be ported to gtk comparatively easily.

2009-09-27 12:00:51 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for keepalive and chat window

I made a fix to the keepAlive option so it does not send the date command
to the ICS after every move. This required changing ScheduleDelayedEvent()
so that it does not execute the event if a new identical one gets scheduled.
I also added the option to XBoard. Affects xboard.c (DOS!) and winboard.c

(This also cures the regression of the winboard.c copyright patch)

I extended the chatbox patch to also listen to channel tells, and divert
them to a chatbox for that channel number. Affects
backend.c and wchat.c

That should make those patches fully operational. No docs for either of them
yet, though.

2009-09-27 10:36:23 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed parse bug for pgn files

fixed the existing bug that the time-control tag was displayed as "?"
in the game list; turns out it was never parsed on reading PGN files

2009-09-27 10:35:58 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
allow the result comment as a display item in the game list

2009-09-27 10:35:13 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed the HAVE_LIBXPM-dependent compile errors

2009-09-27 10:24:47 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added a chat window to keep track of multiple conversations

The chat-window patch affects:
winboard.c, backend.c, winboard.rc, resource.h, backend.h, and adds
the file winboard/wchat.c, which also affects makefile.gcc and makefile.ms.

In addition I added a new option -keepAlive, which affects
common.h (in addition to winboard.c and backend.c).

As I had to modify backend.h, I also defined the -reset option type there,
which we are going to add later. This required some changes
to suppress warnings in wsettings.c.

2009-09-27 10:22:16 -0700 Arun Persaud <arun@nubati.net>:
more files for git to ignore

most of these are generated by make distcheck

2009-09-08 09:33:53 -0700 Arun Persaud <arun@nubati.net>:
another bug fix found by Stanislav Brabec

returned -1  in some case although the variable was a char...
changed to signed char

2009-09-20 23:13:13 -0600 Eric Mullins <emwine@earthlink.net>:
Swapped 'tell' and 'message' parsing order for colorization.
Sometimes messages are relayed as tells and should be colorized as tells.

2009-09-08 09:10:34 -0700 Arun Persaud <arun@nubati.net>:
added some more files to be distributed via make dist

as suggested by Stanislav Brabec

2009-09-08 09:01:07 -0700 Arun Persaud <arun@nubati.net>:
fixed some implicit declarations reported by Stanislav Brabec

2009-09-07 22:04:39 -0700 Arun Persaud <arun@nubati.net>:
fixed a few more small bugs reported by Stanislav Brabec

- A function uses a 'return;' statement, but has actually a value to
return, like an integer ('return 42;') or similar: xboard voidreturn
xengineoutput.c:766, 782

- Program returns random data in a function at xengineoutput.c:602

- With a new toolchain, AM_LDFLAGS cannot contain libraries. Linker
ignores them. Fix is attached.

- ToDo: Convenient name in most projects is TODO (autotools package it
automatically).

2009-09-06 19:11:22 -0700 Arun Persaud <arun@nubati.net>:
reverted .texi file and fixed Makefile.am

the problem was actually not in the texi-file, but the Makefile.am.
Reverted changes in the .texi and fixed it (hopefully) correctly now.

2009-09-06 18:23:01 -0700 Arun Persaud <arun@nubati.net>:
get "make distcheck" to work

needed to add all *.h files to Makefile.am and also the bitmaps that
are needed and some other files. Also had modified copyright.texi.

2009-09-05 09:54:37 -0700 Arun Persaud <arun@nubati.net>:
changed to version 4.4.0

2009-09-05 09:44:21 -0700 Arun Persaud <arun@nubati.net>:
updated AUTHORS, README and ChangeLog files for release

2009-09-05 08:52:09 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some typos

2009-09-04 22:39:45 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
set castling rights after setting up a position

I was going through old WB forum posts, and I encountered a
bug report for a bug that I never fixed: The castling rights should
be properly set (actually: cleared) after setting up a position
in Edit Position mode (as opposed to pasting a FEN).

2009-09-03 23:11:18 -0700 Arun Persaud <arun@nubati.net>:
removed install files from master

they now live in their own branch

2009-09-03 22:30:18 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated polyglot protocol

I added a new option type "-reset" to the protocol for the new option feature.
4.4.0 does not implement it yet, but Michel wants it for future Polyglots,
and I think it is best to update the protocol in one big swoop.
So I want to already include it in the specs now. (engine-intf.html)
I made xboard's response to an unknown option type compliant
with the new protocol specs.

2009-09-03 22:28:50 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some typos

2009-09-03 20:47:13 -0600 Eric Mullins <emwine@earthlink.net>:
Updated project files for DevCpp and Visual Studio to add wsettings.c

2009-09-03 20:46:33 -0600 Eric Mullins <emwine@earthlink.net>:
Added newline at end of file to silence warning.

2009-08-31 20:29:49 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
workaround for error message for missing pieces used in variants
and initstring bugfix: error messages showed for non-existing pieces
showed up for old user supplied pixmaps.
Loading a pixmap of the king for the missing pieces now.

Another bad bug surfaced: the -initString argument does not work in any
XBoard version! (Including 4.2.7b) The escape sequences for linefeed in
the string are not understood: -initString "new\nrandom\n" actually sends
the \ and n to the engine (which then does not recognize the line as a
valid command)!

So I also added a patch to expand escape sequences in the InitString and
ComputerString command-line options.

2009-08-31 20:27:24 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated installe script

I re-organized the doc files in the install, so they now all go in the
WinBoard\doc folder (and none in the root). I so included the COPYING
and COPYRIGHT files there. This required some updates of the links in
some html files, and of the menu link to README.html in the install script.
I also fixed an error with the current directory
in the menu short-cuts of some engines (which started in the fonts folder,
and could not find the opening book there...).

2009-08-31 20:25:17 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated documentation

2009-08-31 20:20:55 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated installer script

2009-08-31 19:51:48 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
new help files for windows

2009-08-25 20:41:29 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated installer

2009-08-25 20:36:53 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
undid some previous changes

some files got mixed up

2009-08-25 20:32:22 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed small bug in wsetting

2009-08-25 20:29:06 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
trigger a focus switch to ICS input field when typing

old behavior was that "." or "," triggered this,
now every printable character  except 1-9 will trigger the focus switch

2009-08-25 20:26:20 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
bug in backend.c when receiving lines from ICS

A space was appended to every character received from an ICS
in stead of just at line breaks.

2009-08-24 23:47:48 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed warning messages from compiler

2009-08-23 14:24:38 -0700 Arun Persaud <arun@nubati.net>:
fixed build on OS X

this seems to fix it. Bug reported by Louis Zulli who also did the testing.

2009-08-23 11:54:28 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
OK, this is the beefed up version of the Polyglot info-string kludge,
for WB and XB.

2009-08-23 10:22:48 -0700 Arun Persaud <arun@nubati.net>:
added missing X_LIBS references to Makefile.am

2009-08-22 23:33:44 -0700 Arun Persaud <arun@nubati.net>:
made the install script and executable

2009-08-22 23:19:07 -0700 Arun Persaud <arun@nubati.net>:
changed beta1 to beta2

2009-08-22 23:14:11 -0700 Arun Persaud <arun@nubati.net>:
fixed enable zippy in configure script and added some checks for OS X

make tried to compile zippy even when --disable-zippy was given.
Also fixed a bug in xboard.c where #ifdef instead of #if was used
to test for ZIPPY (it's either 0 or 1, so we need #if). Also added
some special checks for OS X, not sure if these will do it, but it's a start;)

2009-08-22 19:09:54 -0700 Arun Persaud <arun@nubati.net>:
added configure summary to configure output, also cleaned up configure.ac a bit

used AS_HELP_STRING where possible

2009-08-22 18:10:57 -0700 Arun Persaud <arun@nubati.net>:
added check for malloc.h

this should fix a build error on OS X

2009-08-22 17:47:44 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
A small cosmetic change in the size of buttons
inside a groupbox of the Engine-Setup dialog.

2009-08-22 17:32:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
make xboard usable with UCI engines

I made a small patch in xoptions.c (where the corresponding Engine Settings
dialog was for XBoard), to make it at least usable for UCI engines: I now
divide the options over upto 4 columns, if there are too many to fit into
a single column. This seems to work. Still looks very ugly, but it is
functional.

2009-08-22 17:30:05 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix premove for winboard

This might fix the illusive premove problem. In 4.2.7 the code was not properly
indented, and this led to an unbalanced braces error that I then fixed the
wrong way. Click-click premoves did only work after clicking the toSquare twice.
It might be that they actually did work after clicking it once,
but that the highlights were not displayed (although set)
for lack of a display refresh.

2009-08-22 17:28:11 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed bug for double saved games

This patch should solve the problem with doubly saved games when XBoard is
closed. I calculate a cecksum of each saved game now (including move comments),
and suppress saving if the checksum is not changed.

2009-08-22 17:25:58 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed xengineoutput.c, to keep the duplicated code identical to that of wengineo.c.

2009-08-22 17:24:08 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated xboard.texi: added warning that pixmaps are not build for all variants

2009-08-22 17:19:11 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added a dialog for engine-specific option settings

2009-08-22 17:09:58 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated some documentation

2009-08-22 17:07:10 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed several bugs in the backend and added some more polyglot support

* I added recognition for the new UCI3 option types that are recognized in the WB
option features, to make sure this version is compatible with future Polyglots.
Also fixed a bug that failed to strip an asterisk prefix from the first
combo-box item.

* I fixed the ICS-time-in-PGN bug.

* I fixed a bug which caused a space to be missing when long lines broken up by
an ICS were joined.

2009-08-22 17:02:58 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
better polyglot support for engine ouput

I fixed the algorithm for clearing the Engine Output window to work better with
the latest Polyglot, whight outputs UCI "info strings" amongst the thinking
output.

2009-08-22 16:23:32 -0600 Eric Mullins <emwine@earthlink.net>:
Beginnings of installer for 4.4.0.  HGM asked me to forward the nsi file,
but it seemed best to just add the installer tree to git even though
it's not finished.  You must install NSIS then FontName-0.7.exe
(included in installer folder) then run build.bat in the same directory.

2009-08-05 22:18:29 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
patch backend.c to make the -noGUI option also work in ICS mode.

2009-08-01 13:09:49 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
temporary fix for pre-select

As a temporary kludge I replaced looking into the holdings for the piece type
by figuring out which piece would belong on the clicked holdings square.
This is a non-trivial process, as it depends on which pieces participate
in a certain variant.

2009-07-30 00:19:37 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changed click-click moves

I got complaints about the way XBoard 4.4.0 handles click-click moves,
in particular changing the selected piece after selecting King
(for which I suppressed interference with FRC castling in a rather brutal way).
People tell me it is very annoying that clicks sometimes don't work to select a piece.
WinBoard uses refined logic in the back-end to handle this, but the XBoard
front-end is not interfaced with that yet.
(This would require a major rewrite of the mouse handler.)
This temporary patch suppresses this behavior in all variants that do not support
Fischer castling, and even there only exhibit it for Rook-after-King selection
(which will be interpreted as an attempt to enter a castling move as K x own R).

2009-07-26 08:43:35 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
option -adjudicateDrawMoves is not included in the XBoard list.

added it to the option list

2009-07-21 20:23:23 -0700 Arun Persaud <arun@nubati.net>:
converted files from dos to unix format

run dos2unix over a bunch of files

2009-07-16 07:43:38 -0600 Eric Mullins <emwine@earthlink.net>:
Stripped out unused VersionInfo

2009-07-15 23:16:19 -0700 Arun Persaud <arun@nubati.net>:
changed version to 4.4.0.beta1

2009-07-15 23:12:37 -0700 Arun Persaud <arun@nubati.net>:
updated INSTALL file to add ./autogen.sh

2009-07-15 22:44:05 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
higher number of engine options possible now

I upped the number of options per engine from
50 to 100, and the average number of characters per option from 10 to 20.

2009-07-15 12:30:37 -0600 H.G. Muller <h.g.muller@hccnet.nl>:
Fix of bad bug

2009-07-14 23:41:36 -0600 Eric Mullins <emwine@earthlink.net>:
Added version information to resources.

2009-07-14 23:40:50 -0600 Eric Mullins <emwine@earthlink.net>:
Added Jaws targets to IDE projects.

2009-07-14 23:39:12 -0600 Eric Mullins <emwine@earthlink.net>:
Final makefile adjustments and compiling instructions.

2009-07-13 22:35:17 -0600 Eric Mullins <emwine@earthlink.net>:
Cleaned up garbage left behind from my makefile update.

2009-07-13 22:26:56 -0600 Eric Mullins <emwine@earthlink.net>:
Updated cmdline makefiles to be able to produce JAWS binaries.

This breaks support for MSVC 4.x.  It may still be possible to
use that compiler if you obtain the latest SDK from Microsoft.
MSVC 6.0 still works, but I had to change the target windows
version to 0x500 which causes warnings about building beta
applications.  This is all due to the use of MENUBARINFO data
type in the jaws binary.  You can reduce the WINVER to 0x0400
safely if you are not building a JAWS binary, and MSVC 4.x
will work fine.

2009-07-13 22:26:10 -0600 Eric Mullins <emwine@earthlink.net>:
Removed dependency on jfwapi.h

Allows anyone to compile a jaws compatible binary.

2009-07-13 22:23:31 -0600 Eric Mullins <emwine@earthlink.net>:
Fixed duplicate resource in winboard.rc

PLEASE remember to pull before commiting.  This is the 2nd
time I've fixed this.  It's a waste of time to keep fixing
the same problems.

2009-07-13 19:36:58 -0700 Arun Persaud <arun@nubati.net>:
resolved conflict between Xt and Xaw libraries

seems like we don't need to link against Xt.

2009-07-13 19:33:57 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
help-menu was not un-grayed in the JAWS version, when it played with engines

2009-07-13 19:29:53 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
integrated jaws into winboard

I integrated the JAWS patch now into WinBoard in such a way that the
JAWS and standard version can use the same resource file. This new
winboard.c contains the improved dialog layot of the JAWS version,
but none of the menus and JAWS-specific acclerator keys. The latter
are now generated at run time by code in jaw.s. As a result jaws.h
could be cancelled, as there the JAWS-specific defines are no
longer needed outside jaws.c (now the .rc does not use them), and
is incorporated in it.

2009-07-12 15:37:26 -0700 Arun Persaud <arun@nubati.net>:
fixed problem in autoconf using Xaw3d

rewrote the section for Xaw3d in the autoconf file

2009-07-12 15:29:28 -0600 Eric Mullins <emwine@earthlink.net>:
Added Jaws support to GCC makefile

2009-07-12 15:28:20 -0600 Eric Mullins <emwine@earthlink.net>:
added help support: MSVC IDE and DevCpp IDE project files

2009-07-12 15:26:49 -0600 Eric Mullins <emwine@earthlink.net>:
Removed obsolete makefiles and support files.

2009-07-12 12:33:26 -0700 Arun Persaud <arun@nubati.net>:
updated AUTHORS with the help of git. use

git log --pretty=oneline --name-only --author=AUTHORNAME v4.2.7..HEAD  |sort |uniq

a bit of hand editing and a quick emacs macro later and you have a nice
comma seperated list of all files changes by one author between two commits.

2009-07-12 12:31:47 -0700 Arun Persaud <arun@nubati.net>:
updated Changelog using git log --no-merges --pretty="* %ai: %s%n %b" HEAD v4.2.7

2009-07-12 11:34:28 -0700 Arun Persaud <arun@nubati.net>:
cleaned up some more copyright notices

2009-07-12 11:22:30 -0700 Arun Persaud <arun@nubati.net>:
updated copyright to reflect A. Scotte as copyright holder

need to mention him, since the paperwork won't be finished before the next release

2009-07-12 10:56:29 -0700 Arun Persaud <arun@nubati.net>:
updated patchlevel to "k"

2009-07-12 10:53:50 -0700 Arun Persaud <arun@nubati.net>:
fixed autoconf problem with VERSION/PATCHLEVEL variables

xboard used it's own version of PRODUCT, VERSION and PATCHLEVEL variables.
Switched to PACKAGE_STRING provided by autoconf

2009-07-12 10:29:46 -0700 Arun Persaud <arun@nubati.net>:
cleaned up old CVS left overs

removed $Id tags from all files

2009-07-12 10:10:17 -0700 Arun Persaud <arun@nubati.net>:
converted xhistory via dos2unix

2009-07-12 10:09:24 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed crash in history window

someone discovered that opening the move-history window in XBoard leads to
an immediate crash. Turns out that renaming the menu item broke it! (The
name of the item was apprently used elsewhere in the code to access it,
for putting a check mark there.)

2009-07-12 10:04:30 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fix for Animation of castling moves in Chess960

Animation of castling moves in Chess960 turned out to sometimes make the
king disappear from the display. For the time being I patched this in
xboard.c to suppress animation of FRC castling moves altogether. As FRC
castlings internally are represented as KxR, the to-square does not make
sense anyway, which made the animation look very weird even when it led
not to a king disappearance act. And the Rook move of a castling is never
animated.

2009-07-11 22:44:53 -0600 Eric Mullins <eric@hiarcs.(none)>:
Update GCC makefile to remove .obj targets.

Dunno how they got in there, but they should be .o

2009-07-11 22:42:41 -0600 Eric Mullins <eric@hiarcs.(none)>:
Update makefile dependencies on help.c and help.h.

2009-07-11 22:36:59 -0600 Eric Mullins <eric@hiarcs.(none)>:
Allow compiling with MSVC6.0 and 4.1

Move prototypes into help.h, after making sure that DWORD_PTR is
defined.  Include help.h from winboard.c and help.c so both files
benefit from the definition.

2009-07-11 18:26:16 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
 lists these accelerator keys in the menus for JAWS

2009-07-11 18:24:19 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added shortcuts

This patch allows the use of Ctrl+C and Ctrl+V for Copy Game
and Paste even in I C S mode when the board has focus.

2009-07-11 18:22:17 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
better handling of pasting a game without PGN tags

patch in wclipbrd.h to make it smarter to decide between pasting
a game or a position so it can handle games without PGN tags.
If it doesn't parse as a FEN it is assumed to be a game.

2009-07-11 18:20:56 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed parser error for knight move

The parser had a strange quirk: it recognized bd2 as a valid Knight move
(Nb1-d2) while this SAN format should be reserved for Pawn moves only.

2009-07-11 18:19:30 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
 fixed a few warnings in connection with the help patch (now warning free)

2009-07-11 18:13:50 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
some major re-assignment of accelerator keys in the JAWS

2009-07-11 16:54:53 -0600 Eric Mullins <eric@hiarcs.(none)>:
several small fixes

uptracked winboard.ini

* Cleanup: moved "Some definitions required..." from winboard.c to config.h,
and combined some definitions from borland w/ MS.

* Changed internal HtmlHelp return type and 4th argument to facilitate various
compilers.  These changes, while not strictly adhering to HtmlHelp() conventions,
won't impact anything since the function modified is internal only.

* Modified HtmlHelp return values to integer to silence warnings.
* Added help.c to the project in makefile.gcc & makefile.ms.
* Fixed duplicate resource in winboard.rc.

2009-07-09 22:08:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added JAWS support; help files for Vista; bugfixes for winboard.c

* JAWS support
* help files should now work under Vista (the user has to have either
  a program to view old windows help files or to view html-files installed)
* I fixed the tabbing between all windows that were added according to Tim's sugestions.
* I added typing in of a move number in the move type-in dialog as a shortcut
  to going to that position by use of the < and > buttons. Mainly intended to
  ease life for the blind, but I think it can be generally useful.
  (Although the move-history dialog provides that functionality too,
  this is quicker if you don't happen to have it open.)
* I added typing of a FEN in the move type-in dialog in Edit Position mode.
  (Which could not be used without mouse at all, and is defective
  in crazyhouse even with mouse, as there was no way to populate holdings.)

2009-07-09 22:03:00 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
some bugfixes: ICS error handling

* play a different sound for takebacks in ICS mode
* pop up error messages for illegal moves for typed-in moves

2009-07-09 21:50:41 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removed no longer needed debug message

2009-07-09 21:48:23 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed compile error from a previous change

2009-07-09 21:44:54 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
user selectable font in game list

This makes the game list use the same (user selectable) font
as the the move-history window.

2009-06-30 21:27:34 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed typos in xboard.texi documentation.

2009-06-30 21:16:59 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated the FAQ

2009-06-27 17:06:26 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changed font in engine output window

The engine-output window now uses the same font as the move-history window
(which was selectable in the "Options  -> Fonts..." menu, while the other
wasn't).

2009-06-27 17:03:19 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some characters in xboard.texi

It seems that copying manual sections from the RTF to th texi file did
somehow mess up the double-quote characters, and changed them into some
strange (unicode?) symbols.

2009-06-27 16:56:36 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
two shogi related bugfixes

I discovered a bug in the move generator for the Shogi Dragon King. I
guess it went unnoticed so far because this is a promoted version of the
Rook, which hardly occurs in games. (moves.c)

There was also a problem with the piecesfix I sent you before; Shogi
chosen as initial variant did use wrong piece symbols. (I had tested this
on gothic, but there it happened to work for a different reason, unique to
gothic.) This affects xboard.c.

2009-06-27 16:54:04 -0700 Arun Persaud <arun@nubati.net>:
small cleanup

2009-06-27 16:51:02 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
adds bitmaps for shogi promotions, and selects the bitmaps or
pixmaps for the more rarely used piece types on a per-variant basis.

2009-06-27 16:44:36 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
adds new piece types in the promotion dialog and edit-position piece menu

2009-06-27 16:13:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated bitmaps files: files for fairy pieces where missing,
others had names that didn't work with autoloading.

2009-06-27 16:06:35 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed a bug concerning bitmaps

2009-06-27 15:53:45 -0700 Arun Persaud <arun@nubati.net>:
give a default directory for bitmaps files (tiny change)

this is also one of the debian patches, should be rewritten to use
the correct install directory. No Author was given.

2009-06-27 15:47:52 -0700 Brian May <>:
verbose_error_message_about_recognized_options (tiny change from Debian patches)

2009-06-27 15:45:14 -0700 Matt Zimmerman <>:
add a visual low time warning (tiny change from Debian patches)

2009-06-24 23:31:52 -0700 Arun Persaud <arun@nubati.net>:
dos 2 unix conversion of backend.c

2009-06-24 23:30:07 -0700 Arun Persaud <arun@nubati.net>:
exchanged some sprintf with snprintf found in a patch for the debian system,
extended it a bit to other sprintf's original patch included only 11 lines
by Florian Ernst <florian@debian.org>

2009-06-24 23:07:23 -0700 Mark Ioli <chessknight>:
enabled a patch for default settings in winboard

2009-06-24 22:53:11 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated copyright notice


2009-06-24 22:52:20 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
patches a bug in chosing the initial board size on a virgin startup
I introduced recently

2009-06-24 22:49:33 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
I put in testing for the winning condition in 3checks

on a check it just goes through the entire game to subject
every position on a check test, to see if there were two more.

2009-06-24 22:47:01 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated copyright notice in docs

2009-06-24 22:41:40 -0700 Florian Ernst <florian@debian.org>:
added small patch from debian (tiny change)

according to the debian patch tracker, this patch is by
Florian Ernst <florian@debian.org>.
It fixes whitespace issues in filename called from cmail.

2009-06-24 22:33:13 -0700 Arun Persaud <arun@nubati.net>:
converted dos2unix format for xboard.texi

2009-06-24 22:31:57 -0700 Arun Persaud <arun@nubati.net>:
deleted two more files that don't need to be in git

these files can be generated by autogen.sh

2009-06-21 12:10:31 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
major overhaul of the -stickyWindows feature

I did a major overhaul of the -stickyWindows feature.
The game-list and ICS-interaction windows are now also sticky.
I also added a form of stickiness when the main window is resized;
edges of auxiliary windows sticking to the right or bottom side of
the main window stay attached when the window resizes
(due to nr of board squares or their size). The way the window
coordinates are saved in the .ini file is now relative to the
main window, and some dummy options are added to be able to
recognize right- and bottom-edge sticking, and reconstruct that
when WB starts up with another board size. Also added are
volatile options to ensure there will be space for auxiliary windows
above and left of the main window.

2009-06-21 12:07:01 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed long-algebraic form of drops

The WB parser turned out not to understand the long-algebraic form
of drops send by an ICS. (like B/@@-e4), so even with
legality testing off I now use the SAN move for drops.

2009-06-18 18:35:31 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Refined stalemate adjudication in Suicide, some cleanup

Refined stalemate adjudication in Suicide, which seems to be not always won
for the stalemated side, but for the side with the smallest number of pieces.
Cleaned up the adjudication code in the process. (backend.c moves.c, moves.h)
Also includes a tiny change in the -autoKibitz format, as requested on
Talkchess.

2009-06-18 18:32:57 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Enhancement of the way -autoLogo decides which logos to display

2009-06-16 00:06:59 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
bugfix and enhancement in autoKibitz mode

changed the format of the autoKibitz: score/depth in stead of depth/score,
as in PGN. I also supress the ICS time for the move now in the PGN
if extended info is available. When enhancing the functionality of
the autoKibitz command (using the opponent engine kibitz for the saved PGN)
I discovered that the xengineoutput.c in our tree was obsolete,
and contained a routine of which the arguments were no longer compatble
with the call from backend.c, and caused segfaulting. I copied in
the  corresponding routine in wengineo.c, which was compatible. That the
compiler did not flag this is a sign of badly organized code, I suppose...

The enhancement itself affected backend.c.

2009-06-16 00:04:13 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
modified clock layout

I altered the display of the clocks in the presence of engine logos; I used to
stack them, but some inquiry on Talkchess sowed that people disliked the
stacking. So now I display them next to each other again, but as 2-line-high
fields to make room for te logos.

2009-06-15 23:59:32 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
new zippy option zippyShortGame

On request of Mike Adams I added a new zippy option, -zippyShortGame,
to make life more difficult for abusers of abort and disconnect for cheating.

2009-06-15 23:56:40 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed some bugs in the animation of atomic captures

2009-06-13 15:27:26 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
some small bugfixes

I had overlooked one place from which the FEN writer
(of whicf I changed the argument types), which made WB crash
if you copied a FEN (or PGN that cotained FEN) to the clipboard.
I must have overlooked a warning during compile, or some depedency
is not correct in the makefile. Anyway, wclipboard.c had to be changed.
I also moved adjudication of some losing conditions to before tetsing
for stalemate, (e.g. in atomic, if your king get destroyd you lose,
even if you have no moves after that because it was your only piece.).
this affects backend.c.
I had used the same bits in the rule-modifier flags for indicating
mandatory capture as was already used for indicating FRC-style castling.
This led to frequent illegal move calls in FRC... (moves.h)

2009-06-13 10:45:17 -0700 Arun Persaud <arun@nubati.net>:
cleaned up HTML in FAQ.html -- still need to work on content

2009-06-13 09:36:26 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added option for work-around for some FRC engines in regards to FRCFENs

It suddenly occurred to me that I had promised on CCC to include an option
to provide a work-around for the problem that some FRC engines do not
understand FRC FENs (and thus do not play at all under WinBoard,
as FRC always has to begin with sending the initial position).
So I added the options -firstNeedsNoncompliantFEN, -secondNeedsNoncompliantFEN.
This affects winboard.c and xboard.c, (for defining the option),
common.h, backend.h, backend.c, (for implementing it),
xboard.texi and winboard.rtf (decribing it).
This option provides users with a means to always force the FEN castling field
to KQkq (but can be used for many other work-arounds as well).

2009-06-13 09:30:31 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed bug with random calls

There also seemed to be a bug with the shuffling of opening positions;
I had changed the declaration of the position number from
long long int to u64 to comply with MSVC, but this suppressed shuffling
completely. I now changed it to int. I recently noted a problem with true
randomizing anyway: this was based on srand(time()), but time() apparently
did not change fast enough, so that starting several games in rapid succession
(because the book line contained a 3-fold repetition) produced identical games.
So I now seed the random once and for all during startup, based on the msec of
the time mark, and removed the other calls to srand().

2009-06-13 09:26:14 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changed name for fairymax program in xboard.h

2009-06-13 09:25:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
removed my name from copyright message in help->about menu

2009-06-13 09:22:02 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed -stickyWindows option

I figured out why -stickyWindows was not working in XP and Vista
(while it always worked under Win2K), and I think I found a fix for
it that works under all Windows versions. (I tried XP and Win2K.)

2009-06-13 09:20:38 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Updated docs for Engine-Settings menu

2009-06-13 09:19:05 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Awareness of winning conditions for atomic and giveaway variants; two bugfixes

fixed bug in claim verification
Bugfix on initial position of Great Shatranj

2009-06-13 09:16:47 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Legality testing (mandatory capture) in giveaway variants

2009-06-13 09:16:17 -0700 Arun Persaud <arun@nubati.net>:
don't ignore winboard/parser.c

2009-06-13 09:12:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Added new variant Twilight Chess

2009-06-13 09:08:57 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
some renaming and restructuring of WB menu items, to conform more to XBoard

2009-06-13 09:07:07 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Fixed bug in atomic patch that interfered with non-atomic variants

2009-06-10 21:46:11 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed different use of engine option compared to Polyglot

it turns out the new Polyglot uses a sightly different version
of the GUI->engine option command than the one I proposed
(and implemented in XBoard; Michel sneaked in an '=' sign
between the NAME and VALUE of the option, to allow for
more unambiguous parsing. I guess in principle this is a good idea,
so I adapted XBoard to Polyglot rather than the other way around.
The result is that there are canges in xboard.c, and the documentation.
I noticed that I unjustly had internationalized the option strings
to be send to the engine in xoptions.c; this was of course nonsense,
as this was WB protocol. So I undid that too.

2009-06-10 21:37:47 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
add the already supported variants 3check and great (=Great Shatranj)
to the New Variant... menu.

2009-06-10 21:32:22 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
animate explosions in variant atomic (if animate moves is on).

2009-06-10 21:30:19 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed castling bug in variant twokings.

2009-06-10 21:22:36 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed forteitary wins for special game variations

feature that corrects forfeitary wins (e.g. on time)
of a bare King to draws of course breaks proper operation
in losers, suicide and giveaway

2009-06-09 21:02:51 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
automatically test ini file extension for files from commandline option @filename

The winboard.c is a patch that automatically tries indirection files on the
command line (@filename type arguments) also with an extension .ini if the name itself
did not match any existing file and contained no period. This saves the user typing the
.ini all the time (which I started to find pretty annoying while working on the installer
package).

2009-06-08 15:23:58 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added gamelisttag option to xboard

also updated documentation.

2009-06-08 15:20:00 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated RTF file for winboard

2009-06-06 09:12:48 -0700 Arun Persaud <arun@nubati.net>:
fixed syntax error in texi file

2009-06-06 08:57:52 -0700 Arun Persaud <arun@nubati.net>:
updated to patchlevel "j"

2009-06-06 09:00:25 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
fixed adjudicating probelm in Shantranj

Refrain from adjudicating a draw based on insufficient mating material
(except bare King vs bare King) in Shatranj (where in this case you can
still win by baring the opponent's King).

2009-06-06 08:55:17 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated documentation and FAQ

2009-06-04 22:52:31 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
source clean up. Fix compiler warning, removed unused variables, etc.

2009-06-04 20:43:29 -0700 Eric Mullins <emwine at earthlink.net>:
adding support for different windows compiler

Eric kindly provided us with some makefiles for different windows
compiler and also fixed some issues that came up while using those compilers.

2009-06-04 18:27:26 -0700 Arun Persaud <arun@nubati.net>:
cleanup: got rid of a lot of files that are not needed for a new release

lots of documentation was available in several places,
old unused source files and not used graphics file were floating around
in the tree. This should clean up most of it. No need to keep these files
around, especially since we are using version control.

2009-05-29 18:56:06 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Added the Action-menu items that allow the user to adjudicate
ongoing games in Two-Machines mode. This was an already existing
backend function from Winboard_x; I only had to create a menu item for it
to be called. Due to an oversight I had forgotten to do that so far.
(Logically, I should have done it in the 4.3.5 release,
where I updated the XBoard menus to conform to the WinBoard menus.)

I tested them, and they seem to work. (As expected.)

2009-05-28 22:23:00 -0700 Arun Persaud <arun@nubati.net>:
updated patchlevel to "i"

2009-05-28 22:19:08 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
small change to mousewheel support; two changes in window behaviour

* Visible effects during resizing suppressed, bug in chosing new size fixed.
* No longer reserves left and top margins next to main window on first popup.
* built in some hysteresis into mousewheel support, ignorng the first event in any new
direction to suppress effects from accidential mouse movement.

2009-05-28 22:11:11 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
corrected 'animate dragging'

I finally figured out how the 'animate dragging' works in XBoard,
so that I could add code to do the unstacking of multiple pieces
in the holdings, rather than always leaving an empty square while
you drag them. (And then suddenly re-growing the remaining pieces
as you make the drop.)  It does not look as fancy as in WinBoard
yet, because the counts still only decrease when you release the
piece, rather than when you lift it. But this is not nearly as
disturbing as leaving empty holdings (if only temporarily) when
you still have pieces there.

2009-05-28 22:06:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
Added comand-line options -debugFile (as synonym for -nameOfDebugFile,
as WinBoard also has these synonyms), and -engineDebugOutput
(wich already existed in the backend).

2009-05-28 21:57:53 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated documentation for new release

2009-05-28 21:55:51 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added Xiangqi perpetual-chase detection

2009-05-28 00:06:53 -0700 Arun Persaud <arun@nubati.net>:
Updated all files to GPL version 3.

2009-05-28 00:03:32 -0700 Arun Persaud <arun@nubati.net>:
converted two files from dos to unix format

2009-05-27 23:12:24 -0700 Arun Persaud <arun@nubati.net>:
updated INSTALL, NEWS and other files for new release

cleaned up a bit and updated some information in the text files.

2009-05-07 21:48:23 -0700 Arun Persaud <arun@nubati.net>:
winboard/config.h shouldn't be in .gitignore, only ./config.h

2009-05-07 21:47:37 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
bumped patchlevel to 0g

2009-05-07 21:46:02 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
corrected path in makefile

2009-05-07 21:45:48 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
updated rtf

2009-05-07 21:45:25 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
added firstOptions, secondOptions, noGUI, firstXBook, secondXBook

2009-05-07 21:44:03 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
handle promotion case for Shogi

2009-05-07 21:43:34 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
add note about RESULT command for GUI programmers

2009-05-07 21:42:37 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
small changes to book.c

 added code for different board sizes
 added some debuginfo
 handle promotion of pieces

2009-05-05 23:07:18 -0700 Arun Persaud <arun@nubati.net>:
added a .gitignore file

2009-05-03 12:41:06 -0700 Arun Persaud <arun@nubati.net>:
wrong line ending for Unix... ran dos2unix on both files

2009-05-02 13:51:50 -0700 Arun Persaud <arun@nubati.net>:
fixed texinfo files, added windows help file, removed config.h from git

texinfo.in is not needed anymore, since it only provided a
version string, but this can be created automatically using autotools

deleted config.h from version control, since it is automatically created.
added winboard.hlp file (not sure if needed)

2009-04-26 23:34:34 -0700 Arun Persaud <arun@nubati.net>:
updated autoconf init file

* renamed autoconf init file from configure.in to configure.ac
* added bug-report email address to ac_init
* replaced ac_output(...) with ac_config_files, ac_config_commands and ac_output

2009-04-26 14:49:03 -0700 Arun Persaud <arun@nubati.net>:
parser.c is generated by lex, so it shouldn't be tracked
and also parcer.c shouldn't be in Makefile.am

2009-04-26 14:44:51 -0700 Arun Persaud <arun@nubati.net>:
added book.c to Makefile.am

2009-04-26 13:49:15 -0700 Arun Persaud <arun@nubati.net>:
use autoheader to create config.h.in

no need to track this in git anymore

2009-04-26 11:13:26 -0700 Arun Persaud <arun@nubati.net>:
fixed autoheader warings, remove depreciated acconfig.h

2009-04-26 10:30:23 -0700 Arun Persaud <arun@nubati.net>:
added a autogen.sh

2009-05-02 10:55:39 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.16

2009-05-02 10:50:10 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.15

2009-05-02 10:38:39 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.14

2009-05-02 10:13:41 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
HGM fixed cygwin compile for winboard

2009-04-24 16:11:57 -0700 Arun Persaud <arun@nubati.net>:
cross compilier working

2009-04-19 10:00:52 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.13

2009-04-19 09:52:47 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.12

2009-04-19 09:48:59 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.8

2009-04-19 09:44:15 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.7

2009-04-19 09:39:19 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes by H.G. Muller; version 4.3.4

2009-04-19 09:34:31 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller; version 4.3.2

2009-04-19 10:26:24 -0700 H.G. Muller <h.g.muller@hccnet.nl>:
changes from H.G. Muller

2009-04-16 23:06:13 -0700 Arun Persaud <arun@nubati.net>:
cleaned up the directory a bit. Removed winboard-dm-beta,
merged the two Changelogs together

2009-04-16 14:12:48 -0700 A. Scotti <dev@ascotti.org>:
changes from Alessandro Scotti from 20060129

2009-04-16 14:09:33 -0700 A. Scotti <dev@ascotti.org>:
changes from Alessandro Scotti from 20060112

2009-04-16 14:04:02 -0700 A. Scotti <dev@ascotti.org>:
changes from Alessandro Scotti from 20051231

2009-04-16 13:59:12 -0700 A. Scotti <dev@ascotti.org>:
changes from Alessandro Scotti from 20051129

2009-04-16 13:53:41 -0700 A. Scotti <dev@ascotti.org>:
changes from Alessandro Scotti from 20050322

2009-04-10 04:18:59 +0000 Arun Persaud <arun@nubati.net>:
translated a handfull of strings and set the codeset to UTF-8
for the translations.

2009-03-18 03:20:50 +0000 Arun Persaud <arun@nubati.net>:
Translation: added German po file (roughly 50% translated)

2009-03-01 04:23:54 +0000 Arun Persaud <arun@nubati.net>:
fixed bug #22853: changed all .Xdefaults to .Xresources in xboard.texi

2009-03-01 02:43:43 +0000 Arun Persaud <arun@nubati.net>:
fixed bug #25672, patch #6182 by adding DESTDIR support to Makefile.in

2009-03-01 02:33:26 +0000 Arun Persaud <arun@nubati.net>:
fixed a warning message in the configure script

2009-02-28 22:58:57 +0000 Arun Persaud <arun@nubati.net>:
fixed parser.l. Should fix bug #22812

2009-02-28 22:58:14 +0000 Arun Persaud <arun@nubati.net>:
fixed parser.l. Should fix bug #22812

2009-02-28 22:55:30 +0000 Arun Persaud <arun@nubati.net>:
added myself to the AUTHOR file

2007-06-15 04:26:57 +0000 Mark Loli <chessknight>:
Initial check-in of NSIS Winboard installer files.

* 06/12/2005: bugfix some more possible buffer overflows.

* 06/27/2004: added simple icsEngineAnalyze for xboard

* 06/26/2004: added icsEngineAnalyze for winboard: Analyze observe games
with a chessprogram on a Internet Chess Server (ICS)

* 02/12/2004: Bugfix ICS interaction console crashed while chess
engine starting and user type in some stuff. We wait now to finish
the engine boot.

* 02/11/2004: Winboard: Added color lines for the ics interaction
console if zippy used

* 02/09/2004: Added mousewheel support for winboard. Play moves
backward and forward with the mousewheel.

xboard/WinBoard 4.2.7 -- Fri Nov 28 13:36:00 PST 2003 -- Tim Mann

* 11/26/2003: In WinBoard, setting the -debug flag now logs ICS output
to WinBoard.debug too.  (This isn't needed in xboard because ICS
output already goes to stdout, so it's easy to capture along with the
debug output on stderr.)  This was issue #280 in the ToDo file.

* 11/23/2003: Cleaned up some minor problems in cygwin.mak.  Thanks to
Hans Werner Strube for the problem report.

* 11/23/2003: Updated the default list of chess servers in
winboard/defaults.h.  Deleted two that appear to be dead and added a
new one that is active.

* 11/19/2003: Swapped icon_white.bm and icon_black.bm in XBoard.
Hopefully this will get them the right way around by default on more X
window managers.  I wish I understood this better.

* 11/18/2003: Implemented a simple 32-bit random number generator for
WinBoard, replacing the Windows rand(), which ranges only up to
0x7fff.  Formerly on Windows, only zippy.lines sayings that started in
the first 32767 bytes of the file could ever be used.  This was issue
#505 from the ToDo file.

* 11/16/2003: The xboard man page and info files are now built from a
common set of texinfo source files, and the xboard man page now covers
cmail as well.  Formerly, ever since the texinfo file was first
contributed to the project, it was separate from the man page and the
two files had to be updated in parallel, making for a maintenance
nightmare.  To make combining the files possible, I took the Perl
script "texi2man" from the GNU Units project and added support for a
larger subset of the texinfo markup language.  I then carefully
compared the old man page and old texinfo file to make sure the latest
and clearest words survived into the new combined texinfo file.  It
would be great to merge in WinBoard's help file too, but that's a
larger project.  It would have to be heavily conditionalized to
deal with differences in features between XBoard and WinBoard.

* 11/15/2003: Cleaned up and applied a small patch from Daniel
Mehrmann, to stop overly long PVs in thinking output from causing a
buffer overflow crash in backend.c.

* 11/5/2003: When a chess engine sends a "telluser" command (including
the cases where "tellall" or "tellopponent" acts like telluser), the
information now goes into a nonmodel popup that is automatically
dismissed when the user clicks anywhere on the board.  This fix is
more significant on WinBoard, where formerly you got a fully modal
dialog that had to be dismissed by clicking on OK before anything else
could happen.  The bug was issue #406 in the ToDo file.

* 11/1/2003: Removed email addresses from this file to reduce spam
load, as it gets linked to from the Web.

* 11/1/2003: Updated READ_ME and winboard/READ_ME.txt.

* Modified xboard and winboard makefiles to be able to build the
project in the new combined directory structure.

* Applied a small security fix to pxboard, from Martin Maeok.

* Fixed a bug in the game list dialog.  The change in 4.2.6 to opening
games in text mode (meant to avoid getting extra \r's into comments)
caused a new bug in determining seek offsets when parsing a game file
to form the game list.  Also, the change was incomplete; on some code
paths games were still being opened in binary mode.  Thanks to Lenik
Terenin for reporting the offset bug.  I've now gone back to always
using binary mode when reading game files, and I've fixed the comment
bug by adding code to remove \r's from parsed comments explicitly.  I
still use text mode for writing game files so that games written by
WinBoard will have Windows-style line endings.

* Fix for minor bug in WinBoard installer.  If you chose a non-default
destination directory, the default directory was still used for a
couple of unimportant things, namely setting the App Paths registry
keys (unused by WinBoard) and trying to copy the existing WinBoard.ini
file to WinBoard.old.  I inherited this bug from the InstallShield 5
sample template.  Thanks to "l.d." for noticing the incorrect keys.

* Patch from Chris Priest: when two engines are being run through rsh,
avoid reusing the same stderr port for both.  I'm not sure why this
should be needed, but it's harmless, at least.

* Bugfix: The kludge to deal with old engines that give an error
message because they don't know the "st" command was too sloppy; it
could hit on an "st" substring anywhere in an error message.  GNU
Chess 4 is the only engine I know of where the kludge was needed, so I
changed the kludge to match a longer, more GNU-specific string.

* Changed the WinBoard self-extracting installer to choose a unique
temporary subdirectory name within the Windows temp directory instead
of always putting wb-setup directly in temp.  Besides being better
practice, this avoids the need to deltree wb-setup first, which
occasionally alarms someone who thinks that deltree is only used by
trojans to delete all your files.  (Yes, I'm serious.)

* Fixed a bug where FICS-style "wild/0" strings were not parsed as the
proper wild type.  The "/" was not being skipped.

* Fixed a WinBoard bug where temporary files created by game
copy/paste were being created in the root directory of the current
drive instead of the TMP directory and were not always deleted on exit.

* Fixed a small bug in winboard.c's ErrorDialog() function.  Thanks to
"Ron" (no last name given).  The bug might have caused a problem when
pressing OK or Cancel in an error dialog when more than one error
dialog was being displayed, but I'm not really sure.

* Removed a hack that worked around a bug in very old versions of
Crafty, where it would sometimes reply "illegal move" to a "."
command.  The hack kept us from recognizing real illegal move messages
in analyze mode from engines that don't respond to the "." command.
Thanks to Fabien Letouzey for the report.

* Fixed a bug in the xboard version of GetDelayedEvent.  It would
return the most recently scheduled event even if it had already fired.
This caused at least one visible error: in -ics -xreuse mode, starting
the engine again and seeing another "feature done=1" would re-run the
initialization code in InitBackEnd3, including the code that opens the
connection to ICS.  The WinBoard version didn't have this bug.  Thanks
to Bob Hyatt for the bug report.

* The promotion popup for ICC wild 26 (giveaway) now includes King.
Thanks to Fredrik Josefsson for the bug report.

* The first game in a file (or being pasted from the clipboard) can
now start with a bare move -- no PGN tags, no move number "1", etc.
Suggested by Shane Harrelson.  One could imagine taking this farther
and accepting something like "e4 e5 1/2-1/2 d4 d5" as two games, but
I haven't done that.

* Bug fix: xboard didn't really accept a paste of multiple games,
contrary to what I wrote when adding the feature to WinBoard in
4.2.4.  Now it works in both.

* Fixed generic start/end of game messages to work on chess.net, where
they put ratings in parens after the player names.

* Updated config.sub and config.guess to newer versions from
automake-1.4p5-2.  This makes configure work with MacOS X + X11.

* Bugfix: when examining a game fragment on FICS where black plays
first, don't show two "(0:00.000)" times on the initial "none" move.

* If TestLegality is on and one of the engines makes an illegal move
in TwoMachines mode, it forfeits immediately.  Formerly the game would
get stuck at that point and the engine that made the illegal move
would eventually lose on time.

xboard/WinBoard 4.2.6 -- Fri Feb  1 22:26:31 PST 2002
Tim Mann

Another small bugfix release.

* Put in a small change from Alexander Mai to allow xboard to build in
an OS/2 EMX environment.

* Fix WinBoard-only bug where editing a PGN file with comments would
insert more \r characters before the \n after every Load/Save cycle.
For some unknown reason we were reading the files in "rb" mode but
writing them in "a" mode, so we kept the \r characters on reading and
added an extra one on writing.  Fix: change the "rb" to "r".  Thanks
to Joel (last name not given) for the bug report.

* Put the arguments to rsh/remsh in the right order for better
portability.  Thanks to Michael Kalisz.

* FreezeUI is now implemented in WinBoard; it was previously only
implemented in xboard.  This function prevents the user from entering
moves or other commands while we are waiting for an engine to
initialize itself.  Implementing it fixes a bug where the user could
start a game (etc.) during feature negotiation.  One of the symptoms
of this bug was that we could send "new" one or move moves *after* the
first game started!

* Fixed some handle leaks (WinBoard only), including a nasty one that
leaked one handle per command sent to ICS.  Thanks to several folks
who helped characterize the bug and tried to look for leaks.

* We now install and look for the info file in ${prefix}/share/info
instead of ${prefix}/info.  The latter is still the default in
autoconf, but the former is currently used in Red Hat Linux and
probably elsewhere.

xboard/WinBoard 4.2.5 -- Sat Dec 15 11:42:51 PST 2001
Tim Mann

* Changed the bundled GNU Chess 5.02 in the WinBoard package to
include a much smaller book and to use much less hash table space by
default (8 MB transposition table, 0.5 MB pawn evaluation table).  The
large book included with 4.2.4 made the WinBoard download too big for
some people, and the default hash tables were larger than the
available physical memory on some people's computers. I built the
small book by running Crafty's "small.zip" book line collection
through a Perl script that makes it look enough like real PGN games
that the GNU Chess book builder will accept it.  The script and some
minor patches to GNU Chess 5 are available in the WinBoard source
distribution and at http://www.tim-mann.org/gnuchess.html.

* Fixed a bug in the code that deals with engines that complain that
"time" and "otim" are illegal moves.  This was a new bug in 4.2.4.

* Revamped the implementation of ToStart in analysis mode.  Formerly
there was some ill-conceived code that would try to get back to the
start of the game by doing a "new" command (and all the followup
commands that requires) while remaining in analysis mode.  This is
problematic for engine authors to support, though it works with
Crafty.  This code was trying to solve the problem of ToStart being
slow because the engine would try to start an analysis after every
"undo" command all the way back to the start.  But ToEnd already had a
much better solution to this problem, and now ToStart does the same
thing: we exit from analysis mode and enter force mode instead,
make/unmake moves to get to the end/start of the game, and then
reenter analysis mode.

* Formerly, Zippy could try to start playing a game before the engine
was initialized; that is, during the initial timeout for protover 1
engines, or before "feature done=1" for protover 2 engines.  We now
wait until the engine is initialized before connecting to ICS, which
fixes this in the common case.  If you turn off engine reuse for
multiple games (that is, if you give the -xreuse option), there could
still be problems; see item 503 in the ToDo file.  Thanks to Dieter
Buerssner for the bug report.

* Bugfix: All WinBoard versions since the merge with WinBoard Plus
(but not xboard) have had a bug in changing the PeriodicUpdates,
PonderNextMove, and ShowThinking options from the menu.  The bug
mostly just caused changing these options during a game to not take
effect until after the next reset.  For TwoMachines games, though,
changing PonderNextMove just before the game would take effect
immediately for the second engine but not until the next game for the
first engine.  Thanks to Koundinya Veluri for the bug report.

* Bugfix: In 4.2.4, we sometimes got confused when trying to leave and
reenter analyze mode.  One symptom was that Analyze File did not work.
Thanks to Igor Syry for the bug report.

xboard/WinBoard 4.2.4 -- Sun Dec  9 14:56:30 PST 2001
Tim Mann

* WinBoard now includes GNU Chess 5.02 in place of GNU Chess 5.00.

* WinBoard's PasteGameFromClipboard will now handle a paste with
multiple games in it, popping up the game list dialog.  xboard
already did this.  Suggested by Robert Gerstman.

* We now use the "clearboard" command on ICC where appropriate.

* Bugfix: don't generate a bogus "variant normal" command to an engine
for the loadable ICC wild types that we internally flag as
VariantLoadable.  Also clarified the message that Zippy sends when
declining such wild games -- it can't deal with the possibility of
loading an arbitrary position into the game.  Thanks to Dieter
Buerssner for reporting the problem.  It would be nice to be able to
actually play these wild types some day; presumably there would have
to be an option to either send "loadgame" with a specified position,
or to deal with an opponent sending it.

* If we get a holdings message from ICS when we thought we were
playing normal chess, we now try asking for a move list so that we can
find out from the header what's really happening.  Formerly we guessed
bughouse in this case.  Response to a comment from Gian-Carlo
Pascutto.

* Fixed two longstanding bugs in the clock code.  These affected only
play between a user and a local engine, or between two local engines,
not ICS play.  (1) The last fractional second used by a player before
moving and virtually pushing his clock was being charged to his
opponent instead of to him.  (2) The time and otim commands were being
sent to an engine before the (buggy) fractional second update was
done.  The second bug was pretty harmless in itself, but the first one
was serious.  Many thanks to Peter Rosendahl for carefully diagnosing
and reporting these bugs!

* Changed WinBoard timestamp key.  Nothing is changed other than the
key and a recompilation.  ICC may phase out the old key soon; if they
do, you'll need to use the timestamp.exe from WinBoard 4.2.4 or later
to connect to chessclub.com.

* Fixed an xboard-only bug where most dialogs would not take keyboard
input unless the mouse was actually over the dialog, even if the
dialog window had focus.  Thanks to Jason Varsoke for the bug report.

* Bugfix; Remember to send time and otim commands to engine before
sending playother.  Thanks to Bob Hyatt for the bug report.  Also
fixed a bug where time and otim were sometimes sent even with feature
time=0.

* Added small patches from Wilkin Ng that are meant to fix a crash in
CopyGameToClipboard and a "can't unlock clipboard memory" error in
PasteTextFromClipboard, under Windows 2000.

* Changed cygwin.mak to not use -mno-cygwin.  In other words, it now
uses cygwin1.dll instead of the mingw libraries.  This works around
bugs in fileno() and stat() that I encountered in mingw.  (fileno
seems to always return 0.  stat fails because the library routine uses
a different definition of struct stat than the header files provide.)
Thanks to Robert Gerstman for reporting the symptoms these bugs caused
when WinBoard was compiled with Cygwin.

* Added -showButtonBar option.  This lets you delete the << < P > >>
buttons and thus widen the message widget a bit.

* Added code to address a very obscure bug.  If an engine dies and
needs to be restarted while in one of the analyze modes, it was not
getting put back into analyze mode.  This bug should not really ever
have gotten tickled unless reuse was turned off and the engine sends
game end commands (such as 1-0) when a game ends by rule while in
analyze mode.  The next version of the protocol spec will say that
engines should not do that, but version 2 and earlier didn't address
the issue.

* We now use the FICS "iset ms 1" feature to get times in ms instead
of seconds.  Thanks to DAV for email telling me about this feature.

* Changed clock display to show tenths of seconds for 9.9 seconds and
less, instead of 0.9 seconds and less as before.

* It has been discovered that Zippy can play simuls on ICC (but not on
FICS).  If you arrange for Zippy to send the ICC command "simulize" in
the -zippyGameStart string, it will accept additional games while
playing.  Zippy will use the same engine for every game, so whenever
it switches opponents, the engine's state will be reset with the "new"
command.  This will of course weaken its play, so don't enable simuls
if you want your engine to have the highest possible rating.  Zippy
was never designed to work with simuls; it just works by accident, and
it hasn't been tested much.  So please report any bugs you notice, but
don't expect them to be fixed rapidly.  Thanks to Paul McGuire for
noticing that this works.

* Bugfix: Suppress the direct command to engine popup if there is no
engine.  In WinBoard this case used to cause a crash.  Thanks to
"Dargon" for the bug report.

* Bugfix: formerly we did part of the engine initialization for the
very first game too soon, before feature negotiation.  One result of
this is that engines would never get the "ics" command for the first
game.

* Lengthened timeout to detect protocol version 1 chess engines to 10
seconds.  This should reduce problems with protocol version 2 engines
that are slow to initialize missing the timeout and not getting a
chance to send their feature commands before the first game starts.

* Klaus Friedel says that adding a short sleep to WinBoard after
starting a new chess engine solves a problem that occurs under Windows
2000, in which engines sometimes don't see the initial command(s) from
WinBoard and hang.  I don't understand how that can happen, but the
sleep is harmless, so I've put it in.  Others have also reported what
may be the same problem, so hopefully this will fix it for them too.

* Bugfix: editing the Result field in EditTags will no longer cause a
later crash.  Thanks to DAV for a clear bug report that let me
reproduce the problem.

* ICC wild 28 is now recognized as shatranj, but it is not supported.
You might be able to play it by turning off Test Legality.

* Formerly we would always turn off "feature time" if the engine
printed an error message with the string "time" or "otim" in it; now
we do that only if the message comes before the engine makes its first
move.  This change is useful because some engines spew a lot of bogus
error messages about commands they don't fully parse, so something
like "result 0-1 {White lost on time}" could generate such a message.
Engines shouldn't do that, but if they do, mysteriously turning off
"feature time" is not a good way to react.

* Fixed an infrequently occurring Zippy bug: formerly, resuming from
adjournment by position (that is, with GetMoveList turned off) or
starting/resuming a wild game (nonstandard starting position) would
try to set up the position without putting the engine into force mode
first.  That was probably tolerated by most engines, but if the
position was black-to-play and the engine hadn't set feature
setboard=1, then the fake "a2a3" move (which we use as a kludge to get
black to be on move before sending the edit command) would appear to
be a real move, and the engine might reply to it!  This bug could also
be seen when trying to use Zippy to play a simul -- something that
Zippy was never designed to support, but which seems to mostly work
anyway.  Thanks to Paul McGuire for sending a WinBoard.debug file that
showed the bug occurring.  Some other cases of resuming adjournments
or starting games from nonstandard positions may have been broken too;
I think I've straightened out the problems.

* Agreeing to a draw in the human vs. local engine case formerly did
not work if the human offered first; now it does.  A human's
unsolicited offer is considered valid until he makes another move.
Thanks to Bruce Moreland for the bug report.

* Bugfix: We used to look for just "fr" in Event tags or strings from
ICSes to recognize Fischer Random games.  This caused a lot of false
matches.  Now we look for "wild/fr" instead, which is what FICS uses.

* Bugfix: Clicking on a move in the MoveList window only updated the
displayed position; if a chess engine was active, its state was not
updated.  Thanks to Alejandro Dubrovsky for the bug report.

* Bugfix: The "resign" command from engine to xboard formerly did not
work in ICS (Zippy) mode.

* Bugfix: Formerly we would register a garbage premove if the user
clicked on a piece, then clicked on an edge or outside the board.  Now
such an errant click is ignored.

* Bugfix: GameEnds would send "exit" to an engine in analyze mode even
if we did not actually want to leave analyze mode.

* Bugfix: "feature pause" was being rejected.  We don't currently use
it, but that is no reason to reject it.  Thanks to Gian-Carlo Pascutto
for the bug report.

* Bugfix: when "partner" needed to be sent both to ICS and the engine,
Zippy was erroneously sending the ICS prefix character to the engine
too.  Thanks to Gian-Carlo Pascutto for the bug report.

* Zippy now declines challenges when the engine is not yet ready to
play again, instead of ignoring them.  This is needed so that the
server will let the opponent repeat the challenge.  It might be better
to remember such challenges and accept them when the engine is ready,
but that would be a bit more complicated to implement.

* Bugfix: Zippy's emotes didn't work on FICS because there, "i" is a
built-in alias for "it", not a real command.  So sending "$i foo" gave
an error message instead of doing "it foo".  We now leave out the
alias-suppressing prefix for emotes.

xboard/WinBoard 4.2.3 -- Mon Feb 19 19:55:05 PST 2001
Tim Mann

* Bugfix: The error message "Variant X not supported by gnuchessx"
formerly could pop up even in -ncp mode.

* Fixed an xboard bug in premove highlighting.  If you had
HighlightLastMove turned on, premoves got highlighted in
highlightSquareColor (yellow) instead of premoveHighlightColor (red).

* Modified premove again.  Now we are back to displaying the move
locally immediately after sending it to the server, as in versions
prior to 4.2.1.  This is good because it lets you register your next
premove sooner.  As a better fix to the problem that the change in
4.2.1 had been trying to address, we now suppress animating the
opponent's move if you have a premove reply pending.  However, it's
probably still a good idea for you to turn off AnimateMoves entirely
if you are trying to play extremely fast games.

* Removed an erroneous patch that left zombie chess engines around
when both sigterm and reuse were turned off.  (Bug was in xboard only,
not winboard.)

* Bugfix: loading a game with autostepping did not work for games with
PGN result "*" (unfinished).  This bug was introduced in 4.1.0, caused
by some outdated code that was supposed to leave you in EditGame mode
after loading an unfinished game.  I fixed this, and also changed it
to leave you in EditGame mode after loading *any* game, but without
changing the tags to say it's an edited game.  It's not really clear
whether that is the best thing is to do here -- ideally, perhaps, the
tags should change to say "edited game" if you actually make any
changes, but that is harder to make work.

xboard/WinBoard 4.2.2 -- Tue Feb  6 20:00:00 PST 2001
Tim Mann

* Fixed a problem introduced in 4.2.1.  In -zippyPlay mode, 4.2.1
started sending the initString immediately after the old game ended,
but then when the next game started, it would still send "force" and
another initString.  Another problem was that the first initString put
the engine out of sync with the displayed board position, though that
might not usually have been noticeable.  This is now changed to do a
full Reset at the end of the previous game, and avoid doing a Reset at
the start of a new game if we are still in BeginningOfGame mode.

* Fixed some limitations in -zippyPlay mode.  The engine was not being
fed the moves or history of games that were displayed but not being
played, so it would get confused if you tried to do something like
examine a game, then enter EditGame mode from somewhere in the middle
of the game.

* Made a small change so that cygwin can compile xboard for Windows
(an X server is required to run it).  Thanks to Volker Zell.  Most
people would probably prefer to run WinBoard on Windows, however; note
that cygwin could already compile WinBoard.

* Added some missing documentation to engine-intf.html: It is okay to
send "feature done=0" even before you receive the xboard and protover
commands, if this is needed to give your engine enough time to
initialize.  See engine-intf.html for more discussion.

* Bugfix: "feature done=0" did not work for the second engine; now it does.

xboard/WinBoard 4.2.1 -- Sat Feb  3 19:52:26 PST 2001
Tim Mann

* Bugfix: in Zippy mode with feature san=1, the elapsed time was being
sent to the engine after the SAN move; for example, "e4 (0:01)" was
sent instead of just "e4".

* It seems that scroll wheel mice with incompletely installed software
(under Windows 95, at least) can send repeated middle button up events
when the wheel is turned.  Moved QuickPaste from middle button up to
middle button down to avoid problems with this.

* A premove is now sent *before* the opponent's move that it replies
to is animated.  The premove itself is no longer displayed (or
animated) when sent; instead, it is displayed when the chess server
echoes it back as a board update.

* Bug fix: in -xreuse mode, xboard was only sending command line
arguments to the engine the first time it was started.  (WinBoard
didn't have this bug.)

* In -zippyPlay mode, we now initialize the chess engine for a new
game immediately after the old game ends.  (In -xreuse mode, this
means starting a new engine process; in the default -reuse mode, it
just means sending "new".)  If the engine supports ping, we don't
accept challenges until the "new" has finished.  This should help
avoid losing time (re)initializing the engine after the game starts.

* We now handle the new FICS field in style 12 that says whether the
clocks are ticking.

* whiteFlag and blackFlag are now reset whenever an ICS board image
arrives, giving autoflag a fresh chance to work.

* Suppressed "geometry error" debug messages unless -debug flag is given.

* Bugfix: avoid core dump on Solaris with -debug flag, caused by
passing NULL to a %s format in GameEnds.

* Added -firstProtocolVersion and -secondProtocolVersion.  This will
allow use of extremely broken engines that hang or die when given the
"protover 2" command.  It should be rarely if ever needed.

* Zippy now strips highlights from player names in the Creating
message; previously the ratings would not be extracted from this
message properly if you had set the highlight variable.

* Bug fix: Zippy with -zp but not -zt used to be fooled by false
partner tells inside channel tells; e.g.:
Garf(24): Garf (your partner) tells you: sit

* Bug fix: when an engine reported its name with the new "feature
myname=" command, we had been putting just that name into the window
title even when in TwoMachines mode.

* By default, WinBoard no longer uses the new feature introduced in
4.2.0beta of keeping the ICS menu, ICS server list, and lists of chess
engine command lines in separate files; instead, the lists are back in
the winboard.ini file.  This gets rid of some problems where the
separate files could not be opened because the working directory was
not set to WinBoard's installation directory.

* WinBoard command lines and ini files now have another optional
syntax for quoting an option value.  All characters within { } curly
braces are interpreted literally except for '}' itself.  SaveSettings
now uses this syntax for string values that contain a backslash or
newline and do not contain a '}'.  This should address the problem
that the separate .ini files had been meant to fix; engine command
line lists can now be written without \-escapes.

* Fixed three bugs in relaying moves between engines in TwoMachines
mode: an engine would be sent SAN if the *other* engine had set
feature san=1, a relayed SAN move did not end with a newline, and
feature usermove was not implemented for relayed moves.

* Fixed several bugs in exiting: File/Exit would sometimes hang;
timestamp/timeseal would not get killed off; an engine crash would
cause error messages to be printed recursively until stack overflow.

* Fixed a bug in the code to detect which ICS is in use and adapt to
it; the chess.net case was broken.

* Removed the leading alias-suppression character when sending a move
to ICS, because it seemed to break accuclock on chess.net.

* Fixed a bug where a FICS prompt like "10:01_fics%" would be matched
as finger note number 10, causing a problem detecting when the user is
logged in.

* Added tellicsnoalias command to protocol.

* Changed st command in protocol back to old behavior.

* Added done=0 feature to protocol, to lengthen initial timeout.

* Added missing -colorSeek command line option to xboard.  (Was
present in WinBoard.)

* Bug fix: setting feature reuse=0 was not working.

xboard/WinBoard 4.2.0beta -- Sat Dec 16 16:34:56 PST 2000
Tim Mann

* Setting -searchTime no longer turns off -clockMode.  Note that when
-searchTime is set, some engines may search for the lesser of
searchTime and the amount of time their normal clock management would
dictate, while others will disable their normal clock management and
always search for exactly searchTime.

* Fixed WinBoard bug where on Windows 2000 (and maybe Windows 98) the
ICS Interaction window would scroll back to the top whenever it filled
to capacity and WinBoard trimmed some text off the top.

* Changed xboard dragging so that the center of the dragged piece is
forced to be over the mouse cursor.  (WinBoard dragging already worked
that way.)  This should avoid confusing cases when you start a drag
with the mouse near the edge of a square -- formerly most or all of
the piece could be over one square but the mouse cursor over another.
Suggested by DAV.

* Added move list window for xboard.  Code contributed by Manuel
Hoelss and re-hacked a bit by me.  Performance of this window is poor,
because the implementation regenerates the entire window contents
whenever anything changes.  It's hard to avoid this when using the
Athena List widget, though we could be a little smarter and notice
when the current move number has changed but the move list has not.
There are also several drawing problems caused by bugs in the Athena
Form and List widgets.  The window should not really allow a
horizontal scroll bar, but the bugs are much worse if I turn it off.
In both Xaw and Xaw3d, the List widget tries to resize itself when
XawListChange is called, even if you tell it not to; and what's worse,
if the widget cannot resize itself to be large enough to avoid
clipping any of the list item, it does not change the list!  Arrgh.
On top of that, the Xaw Form widget is very buggy in XFree86 4.0.1
(X11R6.4.3).

* The OK button in the WinBoard startup dialog is now simply disabled
if none of the radio buttons is selected, instead of bringing up an
error dialog.  Suggested by Ted Milbaugh.

* Used ping to address the worst of the race conditions in the
protocol.  Now if an engine supports ping, we ping it after sending
the "new" command and after trying to place it in force mode at the
end of a game.  When a ping has been sent and the corresponding pong
has not yet come back, we (1) ignore or undo any moves the engine
sends, (2) ignore game end messages (such as "offer draw", etc.) from
the engine, (3) ignore thinking output from the engine, (4) delay
starting the next game if in -matchGames mode, (5) in -zippyPlay mode,
respond to challenges with a polite message to try again soon instead
of accepting them.  There are a few more things that should be done
(and item 5 might not be quite what we want), but it's hard to fit
them all into the existing code.

* Patched the version of GNU Chess 5.00 included with WinBoard to
support protover, feature, setboard, and ping, and to fix some minor
bugs.  See gnu500+.patch.

* Changed the GNU Chess 4 kludges for missing "st" and "sd" commands
to be invoked only if the engine gives an error message for "st" or
"sd", and to always use protocol commands instead of engine
command-line options.  See "Idioms" in engine-intf.html.

* Added new protocol command "protover 2" to tell the engine what
version of the protocol is in use.  Version 2 is still compatible with
old engines; see engine-intf.html.

* Add new protocol command "feature ..."  The engine can send this in
response to the protover command command, to say what extended
protocol features it would like to enable, etc.  xboard responds
"accepted F" or "rejected F" for each feature F that is set.  See
engine-intf.html.

* Added new protocol command "setboard <fen>".  This is an alternative
to "edit", used only if the engine says "feature setboard=1".

* Added new protocol command "ping <msg>".  The engine is supposed to
respond "pong <msg>".  This gives us a tool to fix some race
conditions in the protocol, but it is not used to the fullest yet.

* Added new protocol command "tellopponent".  This will do a "say" if
you're on a chess server in Zippy mode, or pop up an information
dialog otherwise.

* Added new protocol command "tellall".  This will do a "kibitz" if
you're on a chess server in Zippy mode, or pop up an information
dialog otherwise.

* Added new protocol command "tellothers".  This will do a "whisper" if
you're on a chess server in Zippy mode, or do nothing otherwise.

* Changed the WinBoard /icsNames, /icsMenu, /firstChessProgramNames,
and /secondChessProgramNames options to accept a filename preceded by
"@", meaning to find the value in the file.  Changed the defaults to
use this feature, with filenames icsnames.ini, icsmenu.ini, fcp.ini,
and scp.ini.  This should make it easier for users to edit the values,
since one less level of quoting is needed, and each value is in its
own file, not mixed into winboard.ini.  Those who upgrade from an
older winboard version and already have a winboard.ini file will not
automatically have these values moved to a file; that has to be done
by hand if desired.

* We now strip .exe from engine names for "name" command, tags, etc.

* Allowed WinBoard input widget to hold more than one line.  You can get
a newline into the widget with copy/paste or with Ctrl+Enter.

* Fixed an xboard bug where the [P] button would appear in the
opposite highlight state from what it should be after being pressed.

* We now use the "/" or "$" alias suppression feature on the chess
servers, to avoid problems if the user inadvertently aliases a
needed command to something else.

* Changed the method used to deiconize xboard in AutoRaise and cmail.
This may fix bugs under some window managers where after
deiconization, the board window was mapped but nothing was drawn
inside.

* Preliminary, partial support for playing several chess variants
against a local engine or editing variant games.  The -variant option
must be given on the command line or WinBoard startup dialog; there is
no menu.  The current variant is not displayed (except in the
Tags/EditTags window).  Many variants will not work quite right even
if the engine supports them; see item 326 in the ToDo file for
details.

* Added a workaround to detect the variant type when examining a
scratch wild game on an ICS.

* Fixed two cases where "variant" command should be sent to the engine
when necessary but was not: loading a game from a file and restarting
a dead engine.  Thanks to Gian-Carlo Pascutto.

* Added missing support for FICS games that start from a bsetup position
with Black moving first.

* Fixed a bug in loading a file from the game list window while in
Analysis or AnalyzeFile mode.  This now leaves us in AnalyzeFile
mode, analyzing the new file.

* Fixed a bug in loading games with a comment before the first move.

* Fixed a bug in handling LoadGame (or -lgf) with -td 0.

* Added a command line option to select an initial minor mode from the
Mode menu.  This should satisfy requests from a couple of users with
special applications.

* Fixed a problem where some things in WinBoard's General Options
dialog box were grayed out at the wrong time.

* We look for a few messages from the chess engine pipe that are
intended to catch problems starting an engine via rsh, such as "No
such file".  Moved code so that these strings won't match until other
protocol messages have been looked for, and documented the messages in
engine-intf.html.

* Fixed the WinBoard bug that sometimes made the console input box
white-on-white even when not in password-entry mode.

* Small changes to WinBoard to be compilable with the latest Cygwin
net release (as of 10-16-2000).  Thanks to Mark Schoenberg.

* Recompiled GNU Chess 5.0 for WinBoard with the latest Cygwin net
release (as of 10-16-2000).  Also rebuilt the book just to be sure,
since I had one bug report about it.  It came out identical and seems
to work fine.

* Added messages for some common InstallShield errors instead of just
printing InstallShield's stupid error code numbers.

* Added -firstComputerString and -secondComputerString, allowing you
to suppress or change the command that is sent to a chess engine when
its opponent is another computer.

* Added "configure --with-Xaw3d" to allow use of Xaw3d widgets instead
of Xaw widgets in xboard.  Thanks to Johnny C. Lam of the NetBSD
project.  I've left Xaw as the default because Xaw3d is too ugly.

* The version of the Xaw Form widget released in XFree86 4.0.1
(X11R6.4.3) has a bug that causes xboard to display the button bar
on top of the message widget.  I've reported the bug and have
installed a kludge workaround into xboard.

xboard/WinBoard 4.1.0 -- Sun Sep 17 17:30:14 PDT 2000
Tim Mann

* Merged Winboard Plus 4.0.8 from Mark Williams into xboard
  source pool.  Status of Winboard Plus features in xboard:

  - White pieces now have borders, but the implementation is
    completely different from WinBoard's; see below.

  - Options menu not changed, probably won't be.

  - Copy&paste support working, using Mark's changes to backend.c, Ben
    Nye's changes to xboard.c for FEN positions, and some code of my
    own in xboard.c for PGN games.

  - Premove hooked up and working.  No pre-first-move, though.

  - ICS Alarm hooked up and working.

  - Auto-flip working.

  - PGN Training mode hooked up and working.

  - Improved menu item enable/disable working.

  - Improved >> button working.

  - Auto activate board working.  I changed this to be optional; you
    might not always want it, especially in Zippy mode.

  - Blindfold working.

  - Documentation updated.

* Fixed more colorization bugs.  Commands like "message foo tells you:
xxx" and "tell 33 tells you: xxx" will no longer generate bogus
colorization.

* Added low-tech sound support to xboard, by invoking an external
program on a filename for each sound to be played.

* ICC wild 27 is now recognized as VariantAtomic, and it sets the
"ignore check" flag, but is not otherwise supported.

* Converted the piece bitmaps from .bm to .xpm for use with xboard's
xpm support.  (An .xim version was not created.)  Wrote a shell script
using ImageMagick to do the conversion and to bucket fill from
coordinate 0,0 with the background color.  Used xpaint by hand to
clean up a few pieces where background color "leaked" into the inside
or didn't flow all the way around the outside, then a sed script to
fix up color names and bitmap names in the xpaint output.  If any more
sizes are added later, they should be straightforward to convert with
reference to the existing scripts.  With this conversion, not only do
the white pieces now have dark borders, but (unlike with WinBoard) the
light details on the black pieces are opaque.

* If the XPM library is found when building xboard, the new xpm pieces
are compiled in as the default.  External bitmap (or xpm) pieces can
still be used by giving the -bitmapDirectory (or -xpmDirectory)
option.  If the XPM library is not found, the old bitmap pieces are
the default.  In this case external bitmap (or xim) pieces can be used
by giving the -bitmapDirectory (or -xpmDirectory) option.  There is no
way to compile in xim pieces.

Winboard Plus 4.0.8 -- Sat Aug 5 15:51 PDT 2000
Mark Williams

* Bugfix release.

* Main menu now visible in Win NT.  Thanks to Microsoft for creating a
compiler which auto-mutilates the WinBoard.rc file so that the menu is
displayed under Win 98 but not Win NT.  I fixed the problem by hand editing the
.rc file.  Sigh.

* "Reset game" now works properly when invoked from Analysis mode when two
engines are present. Correction of bug introduced in Winboard Plus. Thanks to
Mogens Larsen for reporting the bug.

* Pasting a FEN position with Black to move now works in all modes.
Thanks to Mogens Larsen for reporting the bug.

* Added gnuchess.dat to the distribution and a couple of text files that were
missing in 4.0.7.

*** Merged in the following changes from Tim Mann:

* Bugfix: Highlights would sometimes not be taken down, at least in
xboard.  The problem is that SetHighlight works in chess coordinates,
not view coordinates, so if flipView has been toggled since the
highlight was put up, it gets taken down from the wrong square.  Fixed
by being careful to call ClearHighlights before toggling flipView, not
after.  Ugh.

* Bugfix: HighlightLastMove would sometimes highlight square a1 after
a FICS "tomove black" command.

* Bugfix: a move list with initial position that has black to play was
not being handled correctly.

* Removed "decline abort" and "decline adjourn" commands from Zippy.
The syntax is changing on FICS, and Zippy really doesn't have to
explicitly decline the requests anyway; it's sufficient to not accept
them.

* ICC wild 26 is now recognized as VariantSuicide (the FICS name; ICC
calls it "giveaway").

* Bugfix: PGN games with black to move in the initial position weren't
being legality checked correctly.  I think this was introduced in
4.0.6 when I fixed a different PGN bug.  Thanks to Mark Williams for
spotting the bug and suggesting a fix.

* Bugfix: the initial "name(" of a kibitz wasn't being colorized.

Winboard Plus 4.0.7 -- Thu May 12 17:57 PDT 2000
Mark Williams

* New white pieces with black borders.

* Major overhaul to Options menu. New dialogs for setting General Options,
  Board Options, ICS Options, Sounds, Fonts, Colors.

* Clipboard support for PGN game scores and FEN positions.

* Optional ICS Premove with user-specified first moves for White and Black.

* New sound events: ICS Win, ICS Loss, ICS Draw, ICS Unfinished, ICS Alarm.

* New auto-flip option when playing against a chess program.

* Added PGN Training mode.

* Certain menu options now disabled while program is thinking.

* ">>" button now always goes to the end of the game.

* In ICS mode, the board is automatically activated at the start of a
new game.

4.0.7 -- Sun Mar  5 17:17:49 PST 2000  Tim Mann

* Fixed a nasty bug in parsing ICS game histories that was introduced
in 4.0.6.

4.0.6 -- Fri Mar  3 16:20:11 PST 2000  Tim Mann

* Fixed bugs in Zippy's code for responding to messages sent with the
ICS "message" command.

* Fixed bugs where xboard could still create dialogs partially off the
top of the screen.  Fixed unwanted interactions between initial sizes
and positions of various unrelated xboard dialogs.  Deleted
borderXoffset and borderYoffset resources.

* Fixed restoring the xterm name on exit to work in more cases.

* Small fix to the WinBoard self-extracting installer: when it starts
up, it now always deletes any old wb-setup directory left over from a
previous installation.  Formerly this worked only on Windows 95/98, so
on NT the self-extractor would sometimes stop and ask the user whether
it was OK to overwrite the old wb-setup files.

* Modified WinBoard to be compilable with the free Cygwin tools
available from http://sourceware.cygnus.com/cygwin/.  Based on work by
Mark Schoenberg.  (His mods were enough to get WinBoard through the
compiler, but a few things were broken along the way, so I reworked them.)

* Merged changes from Don Fong to make WinBoard compilable with
Borland C++ 4.5.  I do not have Borland C++ and am unable to test with
it, but I did make sure the changes don't stop it working with MSVC++
5.0 and Cygwin.

* Forbade entering TwoMachines mode from MachineWhite or MachineBlack
mode when machine is on move.  This used to confuse the engine and
cause problems, because when we try to get the engine to stop, it
might make a move first, and it might not do that immediately.

* Variant classification now deals with new ICC wild 25, classifying
it as "3check".  Also, we are now conservative about new wild numbers
we don't know about, classifying them as "unknown" instead of
"normal".

* Replaced bad GNU Chess 5.00 book in WinBoard distribution with a
correct one.  1.e4 now no longer takes GNU Chess 5.00 out of book!
Thanks to Pete Galati.

* Made move parser accept and ignore nonstandard ep suffix on PGN moves,
e.g., "exf6ep" or "exf6e.p."

* Fixed bugs in parsing PGN files starting with no move number, or
with a move number other than "1." (including "1...").  Thanks to
Michael Soulier and Stefan Zipproth for example PGN files
demonstrating the bugs.

* Changed InitComboStringsFromString to not modify the input string;
this caused an exception when WinBoard was compiled with MSVC++ 6.
Thanks to Bert Tuyt for the report.

* In WinBoard, dragging a piece off the edge of the board without
releasing the mouse button no longer instantly aborts the move.  You
still must release the mouse button inside a square to complete a
move, but you can now drag off the edge and come back inside.

* WinBoard bugfix: If you went into EditGame or EditPosition mode
while observing or playing an ICS game, and a new move came in
(snapping you back to ICSClient mode) while you were dragging a piece
around, the drag state would not be reset, causing the piece you were
dragging to remain on the board wherever you dropped it.  Thanks to
David Brinegar for the bug report.

* WinBoard bugfix: If you moved or resized the board while your
opponent was moving, and you had AnimateMoving on, his move would not
be displayed until after your next move.  Thanks to DAV for reporting
the bug repeatedly until I finally understood it.

* Added a Zippy "farewell" feature; see zippy.README.

* Fixed a bug (xboard only) in processing -zippyReplayTimeout on the
command line.  Thanks to Steve Beer for the report and patch.

* Send "computer" command to both sides in TwoMachines matches.

* Fixed a Y2K bug in Evan's cmail code!  Thanks to Brian Mays for the
report and patch.

* Bugfix: Initialize variant field of GameInfo struct in gameinfo.c.
This could cause crashes in LoadGame.  Thanks to Andrzej Nagorko.

* Fixed several pattern matching problems: Finger notes and formula
vars no longer get replied to by zippyTalk or colorized.  Channel
tells by players with many titles are now colorized fully, and
zippyTalk handles channel tells by such players correctly.  The shout
"--> foo(99): bar" no longer gets colorized as a channel tell.  Code
is cleaned up a bit, and autocomment capture now uses the same
criteria as colorization.

* xboard fix: Enter key now closes error popups as in WinBoard.
Especially nice for the "Exiting: Connection closed by ICS" popup.

4.0.5 -- Tue Dec  7 10:30:40 PST 1999  Tim Mann

* Added missing documentation of SIGTERM usage into engine-intf.html.

* Bugfix: New -zippyReplayTimeout option was misspelled in WinBoard as
-zippyReplyTimeout.  Thanks to Francesco Di Tolla.

* xboard -ics now restores the xterm's original title upon exit, at
least if $WINDOWID is set.

* Bugfix: -matchGames mode wasn't terminating properly.  Final score
popup would come up twice and engines would not be killed off.  Thanks
to Frank Quisinsky for the bug report.  Bug was introduced in 4.0.4.

* Bugfix: "tell 50 foo shouts: bar" no longer gets colored as a shout;
similarly for "...s-shouts:" and "...c-shouts:".  Thanks to David Lee
for the bug report.

4.0.4 -- Fri Dec  3 17:51:27 PST 1999  Tim Mann

* Bug fix: formerly if you invoked SaveGame from EditPosition mode
with black to play, the position was not saved properly.  As a quick
fix, SaveGame now takes you out of EditPosition mode before saving.

* Changed -matchGames to keep track of the score (won-lost-drawn) and
display it in the banner.  The final score is displayed in a modal
popup before the program exits.

* Changed "Connection closed by ICS" to display in a model popup
before the program exits.

* Added -popupExitMessage option, default on.  Setting this to false
suppresses the modal popups that you sometimes get just before
xboard/winboard exits -- both the two new ones listed above and the
existing Fatal Error popup.  This is useful when running Zippy
unattended from a shell script (or .bat file) that loops and starts a
new copy after a time delay when there is an error.

* In xboard, added missing support for WM_DELETE_WINDOW to all
windows.  This makes xboard a better citizen, and is much needed with
the newer X window managers that put an [X] button on every window and
bind it to "kill application" if the applicationd does not support
"delete window".  We can't allow xboard to be thoughtlessly killed,
since that leaves the chess engine running in the background.

* We now avoid positioning tops of xboard dialog boxes offscreen.

* zippy.lines can now use the caret ('^') character as an inter-saying
separator. You no longer need to dig up a text editor that can put NUL
('\000') characters in text files.

* Bugfix: In traditional chess clock mode, White now gets time added
to its clock as soon as it makes time control.  Previously both White
and Black got their time added only when Black made time control,
which would cause some engines to make their 41st move as White too
quickly, thinking they were low on time.

* The zippyAcceptOnly feature no longer sends a decline command or
a tell.  Thus you can use it to put Zippy into a manual accept mode.

* Bugfix: "tell 50 foo tells you: bar" no longer gets colored as a
personal tell; similarly for "...whispers:" and "...kibitzes:".

* WinBoard no longer blanks the message line when you start a new
move, unless there was an error message there from the previous move.

* WinBoard now never puts the white piece drop menu on the middle
mouse button.  Both colors are always on the right button.  Windows
users often don't think to look for a middle button menu, or don't
really have a working middle button despite what Windows says.

* Guest login handles on ICC are now parsed again; an ICC wording
change had broken this feature.

* Autodetect when the engine does not support the "draw" command and
don't relay the command to it in that case.  Needed because sending an
unsupported command to GNU Chess makes it move immediately, so people
could make Zippy move without thinking by continually offering a draw.
Thanks to Frank Walker for the problem report.

* Small changes based on code from Robert Jurjevic: The WinBoard
analysis window can be minimized (though not to the taskbar).  The
WinBoard ICS Interaction window will autoscroll if you drag the mouse
above or below the window while selecting, and password entry mode
leaves the entry line as the background color instead of using 75%
gray.  Seeks are now colorized with a new color of their own.

* Added -zippyMaxGames feature.

* -zippyNoplayCrafty command line option was missing in xboard; fixed.
Thanks to John Perry.

* Fixed bug in detecting when Zippy loses his bughouse partner.
Thanks to Ben Dean-Kawamura.

* allobs fix in 4.0.3 didn't work; corrected it.

* WinBoard will now update the board immediately if a move is made
while the window is being moved or resized.

4.0.3 -- Sun Aug 15 18:44:39 PDT 1999  Tim Mann

* Bugfix: moved winboard wizard functions that send a command directly
to the chess engine from Ctrl+Alt+1 and Ctrl+Alt+2 to Alt+1 and Alt+2.
Ctrl+Alt is equivalent to the European AltGr key, so the old assignments
conflicted with typing an @-sign on some keyboards.

* Bugfix: prevent "If this message stays up, your chess program does
not support analysis" from appearing if AnalysisMode is selected when
already in Analysis or AnalyzeFile mode.  Also, deleting analysis window
in WinBoard now switches you to EditGame mode, to avoid the anomaly of
being in an analysis mode with no analysis window present.

* Change all Zippy environment variables to work as command line
options.  For now they still work as environment variables too, but
the environment variables are deprecated.

* Use unsigned long to hold node counts from engines.

* Print error instead of crashing on attempts to use xpm or xim pieces
in monochrome mode.  Thanks to Jim Torrance for the bug report.

* Tightened pattern recognition for ICS messages sent to Zippy; should
no longer match ICC allobs output.  Fixed recognition of when Zippy is
sent a message; small change to FICS output had broken it.

* Zippy now exits if the engine dies unexpectedly.

* Added Zippy "spoofedby" feature; see zippy.README.

* Narrowed the margins on some older WinBoard dialogs to make their
style uniform with the newer ones.

* Bugfix: Changing Ponder Next Move from the Options menu did not take
effect until the next game.  This bug was in WinBoard only.  Thanks to
Stefan Zipproth for the bug report.

* Got rid of "Internal error: bad move type" message when the engine
makes a move that we can parse but think is illegal.  Now the move is
just passed on (which also may be the wrong thing to do).

4.0.2 -- Thu Feb 25 19:55:32 PST 1999  Tim Mann

* Added one more built-in sound choice to WinBoard: move.wav from Pete
Galati.

* Added new larger piece sizes: big, huge, giant, colossal, titanic.

* Modified the xboard font searcher to be able to use scalable fonts.
The new -fontSizeTolerance flag controls how closely a nonscalable
font must match to be used in preference to a scalable font.

* Zippy environment variables ZIPPYABORT and ZIPPYADJOURN now control
whether Zippy will accept abort and adjourn requests.

* We now determine the variant type being played on ICS, send it as a
command "variant VARTYPE" to the chess engine (if in Zippy mode), and
put it in the PGN tags.  See engine-intf.txt for variant names.  See
ZIPPYVARIANTS in zippy.README to control what variants Zippy will
accept.  Note that this now applies to bughouse, too.

* Zippy now won't do -zippyTalk in a channel unless his handle is
mentioned there.

* Zippy now ignores bughouse holdings if not actually playing, instead
of stupidly trying to abort the game.  Let me know if other strange
things happen when Zippy is observing a game.

* Set ICS Interaction title bar to "user@server".  User name is
determined by parsing message during the login sequence.  Zippy now
uses this method to get its name too, so ZIPPYNAME is eliminated.
Problem: with xboard, the title bar gets set to "xterm" upon exit,
since we didn't know what it was to start with.

* Fixed xboard-only bug in -colorChannel1 command line option.  Thanks
to Fredrik Sandstrom for the bug report and fix.

* Check for overflow of MAX_MOVES.  Still not sure this is checked for
everywhere it needs to be.

* Added .epd to suffixes recognized by WinBoard as position files.
This is a bit of a kludge, as the .fen reading code was not written
with .epd files in mind, but reading them with it is said to work.

* Added ZIPPYGAMESTART feature, suggested by Jason Hoblit.  See
zippy.README.

* Restored the feature of soaking up the moves from a user-typed "moves",
"oldmoves", or "smoves" ICS command when xboard/WinBoard is idle, but
changed it so that the move list is also echoed to the screen.  Some folks
still liked the old feature since it is faster than examine mode, and
printing the moves to the screen should eliminate the confusion it caused
for other people.

* Bugfix: in WinBoard, starting a click-click move and then clicking on
a black line would cause the source square to be forgotten without taking
the highlight down.  Now the errant click is ignored.

* Corrected shortcut key labels for LoadNext/PrevPosition in WinBoard's
File menu.  Thanks to Andreas Stabel for the bug report.

* Bugfix: if you had a completely full ICS context menu in WinBoard
(90 items), the last one would do nothing if selected.

* The "computer" engine command added in 4.0.1 was not working; I had
left out part of the code patch.  Oops.

4.0.1 -- Fri Feb 12 21:24:15 PST 1999  Tim Mann

This is a minor bugfix release.  The first item listed below is the
only interesting new feature.

* You can now type in moves from the keyboard in WinBoard.  Either
select TypeInMove from Step menu, or (if you are not in ICS mode),
just start typing.  In ICS mode you can type moves into the ICS
interaction window anyway, so I've retained the feature that typing
switches you there.  Not implemented in xboard.

* Removed the "noise 1000" command that used to be sent to the chess
engine when entering analysis modes.

* Deleted the feature where we soak up the output of a user-typed ICS
"moves" or "oldmoves" command.  This ancient feature is not really
useful anymore, now that "examine" exists, and it caused a lot of
complaints.

* Increased maximum size of ICS text menu to 90 entries and added
overflow checking.

* The command sent to ICS by Zippy at the end of each game can now be
customized with the ZIPPYGAMEEND environment variable.

* We treat xboard.info as a pseudo-source since most people don't have
the tools to rebuild it.  But "make install" erroneously had a
dependency on it, even though "make all" did not.  Fixed.

* Miscellaneous minor updates and clarifications to engine-intf.txt.
In particular, documented the st and sd commands (support for command
line options -searchTime and -searchDepth), warts and all.

* Added a small code patch from Bob Hyatt to detect when Zippy's ICS
opponent is a computer and send the command "computer" to the engine.
Added this command to engine-intf.txt.  Thanks, Bob.

* Bugfix: configure was looking for usleep(), but config.h.in didn't
have an entry for it, so HAVE_USLEEP was never defined.  Also, in the
non-HAVE_USLEEP case, there was a possible race condition between the
signal handler and the pause() call.  Thanks to Ben Dean-Kawamura for
the bug reports.

* Bugfix: a "1..." preceding Black's first move (usually present if
there is a comment on White's first move) would cause the parser
to think a new game started there and report "End of game" on the
current game.  Thanks to Dell Garner for the bug report.

* Changed the abbreviation for -searchDepth from -sd to -depth to fix
a clash with -secondDirectory.

* Changed -searchDepth to be orthogonal to the various timing options.
Previously it would search for an unlimited time to the given depth;
now the engine is allowed to choose its search time in the normal way,
but is told to cut off the search early if it reaches the given depth.

* Bugfix: SaveSettings in WinBoard was saving both the long form
option highlightSquareColor and its abbreviation (hsc).

* Fixed a redisplay bug in DisplayBothClocks that could cause White's
clock to be highlighted in EditPosition mode when Black's should have been.

* Fixed Zippy's feature of passing on draw offers from the ICS opponent.
The colorization code was eating the offer before Zippy saw it, so I disabled
colorization of offers while in -zp or -zt mode.  (Other types of
colorization are already disabled in Zippy mode for similar reasons.)

* Added some more commands to the default ICS context menu in WinBoard,
and put "(name)" on the ones that insert a playername (or game number).

* Added missing documentation to WinBoard help file: PonderNextMove, the
-ponder/-xponder argument, and the up/down arrow history feature in the
ICS Interaction window.

* Fixed	ZIPPYNOPLAYCRAFTY feature to fire only if the opponent is Crafty,
not if some other Crafty is observing the game and kibitzes.

* Fixed bugs in generating "partner" commands when Zippy is playing
bughouse.

4.0.0 -- Sat Jun 20 16:59:47 PDT 1998  Tim Mann

* Fixed WinBoard resizing so that the edges you do not drag remain in
place, even when the final size is different from what you dragged to.
(This doesn't work on NT 3.51 or earlier, if anyone cares.)

* Fixed problems with resizing WinBoard on Windows NT: you no longer get
whitespace around the board, a clipped board, or a lot of flashing during
the drag.

* Added customization for highlight-square color.

* Bugfix: backend.c wrote to stderr in a few obscure places, which doesn't
work in WinBoard.

* Added Index Number field back to LoadGame/LoadPosition dialog boxes in
WinBoard.  This required some extra code to work with both the
Explorer-style dialog boxes and the old-style NT 3.51 dialog boxes.  Ugh.

* WinBoard startup dialog now understands -zp mode.  The first chess
engine selector is enabled and the value is used.

* Bugfix: ResetGame would send "exit" to engine twice if it was in an
analysis mode.

* Bugfix: The response "Illegal move: bk" to the "bk" command, indicating
that it is not implemented, would confuse xboard.

* Bugfix: Ignore empty hints ("Hint:\n") instead of printing a message
saying that some bogus string (often "Hint:") is illegal.

* Bugfix: LoadNextGame/LoadPreviousGame/ReloadSameGame were broken.

3.6.12 -- Sat Jun 13 14:57:10 PDT 1998  Tim Mann

Beta test release of xboard and WinBoard.

* Spruced up xboard man page a bit.

* Added Highlight Last Move to xboard too.

* The revamped xboard mouse click code had several more bugs than the
previous version, so I revamped it again.  All fixed now, I hope.

* xboard bugfix: crash in CreatePieceMenu.

* Oops.  winboard-3_6_11beta.exe installed 3.6.10beta, not the new version.

3.6.11 -- Fri Jun 12 20:00:48 PDT 1998  Tim Mann

Beta test release of xboard and WinBoard.

* Major reorganization to engine-intf.txt.  Some new features added,
many existing features clarified and hints for engine programmers added.
Support for new features added to program.

* Changed defaults for -scp (etc.) back to being independent of -fcp, as
in 3.6.2. That is, the default is no longer to copy the value from -fcp if
-scp is not specified.  This will sometimes make command lines longer but
will remove some confusing situations.

* Split -reuseChessPrograms into two options: -reuseFirst and
-reuseSecond.  Fixed obscure bugs when reuse is off.

* Detect ICC and change some command usage slightly there: only ICC has
set-quietly; only FICS has iset and bsetup clear.  With this feature, we
can now safely use bsetup clear when appropriate instead of deleting each
piece one by one.

* Added indent to lines that are wrapped by WinBoard ICS Interaction
window.  This seems to tickle a Microsoft bug in the RichEdit control:
occasionally the start of the next line after the wrapped line is indented
too.  I think the wrapped indent feature is useful enough that it's worth
having in spite of the bug.

* WinBoard bugfix: bounding box for the board was computed incorrectly by
mouse code.  It would think you moved off the bottom of the board before
you really did, so it was hard to drag pieces along the bottom rank on
smaller board sizes.

* Fixed obscure parser.l bug: ambiguity between capture using : instead of
x and email header line.  Also removed or simplified a lot of complex
patterns for English (as opposed to PGN) end-of-game indications while I
was in there.

* Added PonderNextMove option.

* xboard EditPosition piece menus now let you set the side to play by
selecting the "White" or "Black" label at the top of the menu, like
WinBoard.  (Both xboard and WinBoard still let you set the side to play by
clicking on the clock.)

* Merged documentation of Crafty and GNU Chess thinking output in
engine-intf.txt.  Corrected code in backend.c to match documentation; it
used to require the PV to start in column 27 (!).

* Fixed bug that caused crashes in "-reuseChessProgram false" mode.

* Draw by agreement in Two Machines mode now works as it is supposed to.
Other minor bugs in handling game end messages from machines are also
fixed, and engine-intf.txt is revised in this area.

* Revamped xboard code for handling mouse clicks on the board.  In
particular, it had a bug if a click-click promotion move was made.

* Fixed and reinstated optimization for << in analysis modes: send
initString and re-send the board if needed.  Sending repeated undos
is bad because Crafty prints some analysis after every one.

* Don't go into a spin loop while pausing between xboard animation frames.
This caused problems, especially when compiling with -O2 on HP-UX.

* WinBoard Options/Colors/RevertToDefaults now also turns off Monochrome
if it was on, and similarly for Options/ICSInteractionColors/RevertToDefaults.
This seemed to confuse people before.

* Bugfix: ICS Interaction context menu items with neither of the two
optional flags set did not work.

* Bugfix: PGN move numbers are optional, but we were insisting on "1"
right after the tags.

* Bugfix: only the first game of an -mg match was loading -lpf or -lgf.

* Other minor fixes and code cleanup.

3.6.10 -- Mon Jun  1 01:32:31 PDT 1998  Tim Mann

* Added ZIPPYNOPLAYCRAFTY feature; see zippy.README.

* Added timestamps for chess engine interaction to -debug output.

* Now allow 10 seconds (was 5) between games in match mode for engines to
respond to "force" command that ended previous game.

* When a game is picked from the game list and the names of White and
Black are known, display them in the window banner instead of the filename
and game number.

* Changed default for -scp and -sd to be the values of -fcp and -fd.

* Added boxes for both engines to WinBoard startup dialog.  Changed to
dropdown boxes whose content can be set from winboard.ini, similar to
the box for ICS name.

* Accept "offer draw" (or "*offer*draw*") from engine to offer a draw.

* Accept "move mmmm" from engine as well as silly "1. ... mmmm" syntax.

* Added support for bughouse engines (Zippy mode only).

* Move bombproofing for engines sending illegal or out of turn moves.

* Always send "xboard\n" to engine as first command.  Eliminates need
to run crafty as "crafty xboard".

* Rewrote xboard code for input from engines to fix longstanding bugs.
Previously an engine that sent one line in two separate writes with
some time lapse in between (or perhaps that sent several lines in one
write) could make xboard hang.  WinBoard did not have this bug.

* Fixed minor bugs in dealing with illegal moves.

* Added "iset startpos 1" for FICS.

* Removed special support to put "GNU Chess" or "Crafty" in the window
banner instead of the engine's base filename.  This gives a more level
playing field for other engines.  Also fixed bugs in the code that finds the
engine's base filename.

* Bugfix: Abort or Resign at the very start of a game in chess engine mode
would fail to send "force" to the engine.

* Fixed some minor bugs in new "result" messages, and changed format to
include a trailing PGN comment giving the reason the game ended.

* Changed syntax of /font options in WinBoard; old syntax was assuming
that a font name can't contain a digit, which is wrong.  Old font names in
WinBoard.ini files are still accepted.

* Serious further work on getting WinBoard to read/write files in the
"right" directories and documenting exactly what it does.

* Added LoadPreviousPosition, LoadNextPosition, ReloadSamePosition.

* Misc. tiny fixes and cleanup.

3.6.9 -- Sun May 24 20:53:08 PDT 1998  Tim Mann

xboard and WinBoard beta release.

* Tightened up illegal move handling.  Illegal or meaningless moves from a
file or chess engine should no longer get translated into a1a1 and blindly
applied.  Explicit moves to the same square (like a1a1) no longer make the
piece on that square capture itself and vanish.

* Added AlwaysOnTop feature to winboard.

* Fixed bug in winboard "@" command line indirection operator.

* Removed buggy "optimization" code for ToStart in analysis modes.

* Fixed typo bug in zippy.c that would often cause winboard to crash
right after starting a game in -zp mode.

3.6.8 -- Sat May 23 22:23:19 PDT 1998  Tim Mann

xboard and WinBoard beta release.

* Added -firstDirectory and -secondDirectory so that chess engines can
be started in a different directory from xboard/WinBoard itself.

* Added -matchGames to allow more than one game in -matchMode.  The games
are played with colors alternating between the two chess engines.  Had to
add a time delay at the end of each game to catch up with game ending
messages from both chess engines -- yuck.

* Changed TwoMachines mode to have firstChessProgram play White by
default.  Added -firstPlaysBlack to restore old behavior.

* Major rework of code in backend.c for dealing with first and second
chess engines.  Generalized the code and created a struct type with one
instance for each engine.  Several small bugs fixed along the way.

* Fixed bugs in Abort in local chess engine mode.

* Tightened pattern matching to recognize moves from machine.  Should cure
bogus "Illegal move" errors while Crafty is pondering with Show Thinking
on, among other things.

* WinBoard keeps focus in board window after popping up a comment due to
Forward/Backward/ToStart/ToEnd commands.

* Finally got rid of warnings on compiling moves.c under Windows.

* Fixed so WinBoard will compile on machines where WM_MOUSELEAVE is not
defined.

* Removed various bits of unused code.

* Parse (and ignore) NAGs in PGN files.

* Updated engine-intf.txt.

* Send "result R" to the chess program at the end of each game, where
R is the PGN result 1-0, 0-1, 1/2-1/2, or *.

* Bugfix: suppress animation when loading a game with timeDelay=0.

* Bug fix: pondering output from Crafty that contained "..." could be
mistaken for a move, causing bogus error messages and general chaos.

* xboard "make clean" bug fix: moved things created by configure to be
removed only by "make distclean".

* Fixed a remaining case where move was being animated before being
relayed to opponent.

* Backend was reversing time/otim commands to the chess program (new bug),
and was often not sending them on the first move of a game or the first
move after a mode change (old bug).  Fixing the latter required a kludge
to work with both GNU Chess and Crafty, because Crafty swaps white and
black clock times when it swaps sides, while GNU Chess does not.  The
kludge is that we always make sure the chess engine thinks its opponent is
on move before we set the clock.  This will sometimes result in sequences
like "white\ntime xxx\notim yyy\nblack\ngo", or the same with white and
black interchanged.

* Removed last trace of old -whiteString and -blackString arguments.

* Fixed so that you can type "bd" into the Direct Command dialog when
debugging gnuchess, without having xboard parse the clock display
(starting with "White") as "White wins" and end the game.

* Changed moves.c to make a distinction between IllegalMove (where we
could tell what move was intended, but it violates the chess rules) and
MeaninglessMove (where we could not tell).  This is a step towards getting
rid of cases where we translate meaningless moves into "a1a1", but some
work is probably needed to track them all down.

* Fixed bug in WinBoard monoMode dragging.

* Changed WinBoard to new style file dialogs.  In the process, disabled
the feature that let you enter the index number of a game or position within
the file in the dialog.  This is no loss in LoadGame, as you can pick your
game from the game list dialog that follows, but it does remove some
functionality from LoadPosition.

3.6.7 -- Mon May 18 21:25:00 PDT 1998  Tim Mann

xboard and WinBoard beta test release.  I've been unable to reproduce some
reported drawing bugs, so they may still not be fixed.

* Changed PopUpErrors option to PopupMoveErrors, which is more useful, and
changed default to off.  Errors other than move errors should always be in
popups; they are often too big for the message area and too important to
put where they can be easily missed.  But it seems good to get rid of the
popups for move errors by default.

* xboard analysis window no longer forces itself to top whenever there is
new output.  Also, now uses built-in Xaw word wrapping instead of trying
to do its own; works better.

* Bugfix: Reset did not take Crafty out of analyze mode.

* A chess engine no longer has to claim to be Crafty to be able to use
AnalysisMode and AnalyzeFile; it just has to implement the analyze
command as Crafty does.  Put in heuristics to generate more informative
error messages if the engine does not support analyze, and checked that
they work at least with GNU Chess.

* Added click-click moving, HighlightLastMove, and HighlightDragging to
WinBoard.  The highlight features are unlikely to go into xboard unless
the xboard drawing code is cleaned up to do *all* drawing on the board
from DrawPosition, as WinBoard does.  This is low priority for me.

* Eliminated bogus "Error gathering move list: no header" popup.  You
could get this by observing two fast games at once without turning off
GetMoveList.

* Disable WinBoard Sounds menu entirely in -ncp mode, since not even
MoveSound is used in that mode.

* WinBoard bugfix: Several problems were caused if the user changed
WinBoard's current directory in a Load, Save, or Browse dialog.  In
particular, WinBoard.ini would get saved in the wrong directory, and
sound .wav file names would not get saved with a full pathname.  I think
all such problems are now fixed.

* WinBoard bugfix: iconizing the board after an aborted mouse resize would
(partially) resize it to Tiny.

* WinBoard bugfix: board was not being drawn in color on 256-color
displays.  This bug was introduced in 3.6.6.

3.6.6 -- Tue May 12 17:43:43 PDT 1998  Tim Mann

xboard and WinBoard beta release.  Note: not all reported bugs are fixed.

* Move animation in WinBoard, programmed by Henrik Gram.  Great stuff!

* Animate backward moves too.

* xboard bugfix: -font (and friends) can now specify a font alias (such
as "fixed"), not just a full X Consortium name pattern.  Previously this
would give a resource conversion error message.

* Some coding style cleanup in xboard.c.

* Earlier error check for moving wrong color piece in EditGame mode.

* Completed fix to pattern matching; see 3.6.5.

* Fixed some software rot bugs in Zippy.

* Split AnimateDragging as separate option from AnimateMoves.

* Added FlashMoves to options menu and -flash/-xflash to command line
options (xboard only).

* Some preliminary work on visible bughouse holding support.  Most of the
code is not present in this release because I have not gotten it working
properly yet; my first approach went down a blind alley and I had to
remove most of the partially working code in preparation for a rewrite.

3.6.5 -- Fri May  8 14:22:09 PDT 1998  Tim Mann

Not generally released.

* Pack bughouse holdings display in banner more tightly when board is one
of the smaller sizes (when smallLayout or tinyLayout is true, that is).
An interim measure, but should help.

* Completed fix to make move list parsing recognize the end condition and
final comment.

* Fixed pattern matching for chatter (tells, etc.) to be more reliable.
This should reduce the incidence of colors starting in the wrong place and
of incorrectly matching things that look like other patterns inside
chatter, such as "shout <12>".  (These errors were already rare.)

* WinBoard now lets you customize the list of ICS's in the startup dialog.
For now, at least, requires editing WinBoard.ini with a text editor.

* Bug fix: WinBoard window sizing and position setting save/restore did
not work right when the taskbar was at the top (or left side) of the
screen and not in autohide mode.

* Merged xboard click/click mode and drag mode, and deleted
ClickClickMoving option on menu.  Now if you click on a piece, it
highlights and a further click on another square will move it.  (A second
click on the same square takes down the highlight.)  Or if you press down
on a piece and start to drag, you can drag it to a new square.

* When making click/click style moves, if your second click is on a piece
of the same color, instead of saying "Illegal move", we now cancel the first
starting square, replace it with the second, and wait for another click to
finish the move.

* Separate -secondInitString.  Default: same as -initString.  Suggested by
Remi Coulom.

* Patch from Frank McIngvale to make animation work with XIMs.  Yay!

* Changed move animation to happen after move is passed on to ICS or the
chess engine, where applicable.  Fixed problems with updating moveList
that this uncovered.

* Changed game list to show PGN result token for each game.

* The usual minor bug fixes.

3.6.4 -- Thu Apr 30 23:14:43 PDT 1998  Tim Mann

xboard and WinBoard beta test release.

* xboard documentation updated, both man page and info file.  An attempt
to generate both from the same source with LinuxDocSGML was abandoned, at
least for now.  WinBoard doc updated too.

* Merged updates to animation code from Hugh.  Fixed a couple of remaining
bugs, mostly to do with handling Pause mode correctly.

* Added SaveSettingsOnExit to WinBoard.

* WinBoard now saves the last screen position of the Comment, Edit Tags,
Game List, and Analysis windows (in addition to the board and ICS
Interaction windows) in WinBoard.ini.

* WinBoard now provides a way to customize the right-button context menu
in the output area of the ICS Interaction window.  For now, requires
editing WinBoard.ini with a text editor.

* Various minor fixes to ICS message recognition, most affecting only Zippy.

* Colorize the notification when someone sends you a message while you are
logged in, not the output of the "messages" command.

* Fixed colorization to turn off at the right place more reliably.

* Added a new color and WinBoard sound for "requests": abort, adjourn,
draw, pause, and takeback.  The same color and sound are used for all of
these.

* Added GUI to change sounds in WinBoard.

* Suppressed WinBoard error popup when a sound can't be played.  They were
popping up when two separate WinBoards tried to play a sound at the same
time (such as during a bughouse match).

* Fixed WinBoard crash when a sound file didn't exist.

* WinBoard ports of timestamp and timeseal now produce decent error
messages if they fail to connect, and WinBoard captures the messages and
puts them into a popup.  Previously WinBoard would exit with no message on
such errors.

* WinBoard resizing with mouse improved; now accurately picks the largest
size that fits in the new area.

* Added option to turn off error message popups.

* Added sizes slim, dinky, and teeny.

* Fixed some minor problems with error message wording.

3.6.3 -- Mon Feb 23 19:08:57 PST 1998  Tim Mann

xboard beta test release only.  Man page is updated for the changes, but info
file is not.

* Bug fix: LoadGame could not load a PGN game whose first move was
castling (which is possible from setup positions).

* Bug fix: we were ignoring illegal move messages from chess engines in
modes where the engine is refereeing but not participating (EditGame,
LoadGame, AnalyzeFile).  The problem was in a workaround for a Crafty bug,
where Crafty generates a bogus illegal move message if a "." (used by
the PeriodicUpdates feature) is sent in analysis mode when the current
analysis reveals a forced mate.  Installed a different workaround (that
works in most but not all cases) and reported the Crafty bug.  Bob Hyatt
replied with a fix, so the Crafty bug should be gone in Crafty 14.12 or so.

* WinBoard only: enabled resizing board with the mouse.  It snaps to the
nearest (but not too much larger) predefined size.

* The xboard default font is now sized according to piece size, just as
clockFont and coordFont have always been.

* Added more sizes: bulky, moderate, average, middling, mediocre, petite.

* xboard only: Added Animate Moves and Click-Click Moving to Options menu.

* xboard only: Added code to animate piece movement, from Hugh Fisher.

* New feature: autoflag is implemented in MachineWhite, MachineBlack, and
TwoMachines modes.  If it is on and either a chess program or the user
oversteps his time, xboard will automatically call the flag and end the
game.  This feature was requested by someone who runs matches between
programs and wants to penalize GNU Chess for its habit of running slightly
over at the end of a time control.  I personally think it's pointless.

* Fixed a bug in Zippy's pattern matching; he can now reply to ICC
messages again.

* Generate prettier notation for illegal moves.  If a move is illegal only
because it leaves the player in check, generate notation as if that were
not illegal.  For instance, if two knights are a knight's move away from
f3, one on g1 and one on e5 that is pinned, the notation would be Nf3 to
move the g1 knight, Nef3 to move the e5 knight.  (Suggested by Philippe
Schnoebelen.)  In addition, if a move is illegal because the type of piece
moved cannot go that way, would be jumping over another piece, etc., we
give fully disambiguated coordinate notation; for example, Ng1g3, Ke1xe8,
d2xd8=Q, etc.  An alternative would be to still write Ng3 if there is only
one knight on the board, or Ngg3 if the other knight is not on the g file,
but life is too short to code up all this stuff, and perhaps the way I did
it is better as it emphasizes that this move was really made despite being
illegal.  I wonder if the new PGN standard revision will speak to notation
of illegal moves?

* Fixed gross bug from 3.6.2: if a chess program said "checkmate" and
White was left on move, the PGN outcome was "1-0 {Black mates}" instead
of "0-1 {Black mates}"!  The bug occurred only for that specific string.

3.6.2 -- Wed Jul 23 16:47:29 PDT 1997  Tim Mann

* There was a bug in backing up from the end of a game against a chess
engine, introduced when -reuse mode was added.  Fixed.

* Recognize "{" as terminating an ICS move list.  Previously we needed to
see a prompt (containing %), but occasionally ICC can send more stuff
right after a move list with no prompt in between.

* In WinBoard, -mm now implies -cp, so you don't get the startup dialog.

* WinBoard startup dialog no longer sets -scp.  People used to get
confused because they would give the -fcp and -scp arguments, but omit
-cp.  This would bring up the startup dialog, which would set both -fcp
and -scp to the value in the engine name box.  Now you can change -scp
only with the command-line argument.  That will confuse some people too,
but hopefully fewer.  I think overall it's better than putting spaces for
both -fcp and -scp in the dialog, which would puzzle newbies.

* Bug fix: Analyze File mode now works in WinBoard.

* Bug fix: WinBoard window no longer cuts off part of the bottom row if
the menu bar wraps to a second line.

* Accept game end messages of the form "PGN-result {comment}" from the
chess engine, where PGN-result is 0-1, 1-0, or 1/2-1/2.  Accept "resign"
or "computer resigns" from the chess engine as a synonym for "0-1 {White
resigns}" or "1-0 {Black resigns}". Accept any message from the chess
engine containing "game is a draw" as a synonym for "1/2-1/2 {Draw}".
Accept "White resigns" or "Black resigns".

* Enable "Action / Draw" menu item in chess engine mode.  It sends the
command "draw" to the engine.  Accept any message from the chess engine
containing "offers a draw" as a draw offer.  WARNING: Draw offers from the
user and the engine (or from two engines) are not yet matched up by xboard
in chess engine mode.  Two engines could get into a loop offering each
other draws.

* Bug fix: Game end messages from the chess engine are always ignored in
Zippy mode.  Previously they could sometimes be processed, which was
sometimes making Zippy hang at the start of a new game that followed
quickly after an old one.

* Zippy can now respond to titled players in channels.  Zippy will avoid
talking to himself in a channel if he knows his own name.

* Bug fix: in colorization arguments, the bold setting was being ignored
if the background color was defaulted.  (xboard only.)

* Extended ParseFEN to accept Crafty 12.2's interpretation of FEN.
If fewer than 8 squares are given in a row, or fewer than 8 rows are
given, the uncovered squares are empty.  Also, there can be a / after the
8th row.

3.6.1 -- Sat May 17 01:02:33 PDT 1997  Tim Mann

* Bug fix: Hitting escape while entering a password on WinBoard no longer
sets the font color back to black (which made further typing visible).

* Bug fix: On Windows NT 4.0, WinBoard /ics /icshelper=timestamp would
often hang if you tried to exit with the Exit menu item, the [X] button,
etc.  The same fix may also have corrected the problem where running a
chess program with /xreuse would sometimes crash Windows 95 (but not NT)
when the chess program was killed and quickly restarted.

* Bug fix: Periodic Updates would not work if turned on after having been
off.  Also, the default was needlessly "off" in WinBoard.

* Zippy bug fix: Continuing an adjourned game was totally broken.  The
wrong moves, or no moves at all, were being fed to the chess program.

* WinBoard change: Giving -ics without -icshost now pops up the startup
dialog with "Use an Internet Chess Server" pre-selected, so that you get a
menu of chess servers instead of going directly to ICC.

* Bug fix: WinBoard's SaveSettings was saving -icshost, -icsport, and
-icshelper in winboard.ini.  This causes a problem if you use a different
icshost later that needs the default values for icsport (5000) and
icshelper ("", meaning none).

* Disabled complaints about unexpected "[Ii]llegal move" messages from
the chess program; we still get them at times.

* Greatly simplified the code for Move Now and SIGINT (ATTENTION).  Fixes
the bug where Move Now did not work with GNU Chess in WinBoard, and
several more obscure bugs as well.  Reintroduces a minor bug: GNU Chess might
not think on your time after a Move Now command.  Trying to fix this
causes too many other problems.  Documented change in engine-intf.txt.

* Cleaned up code for obtaining ratings from ICS.  It was kludgey and may
have had bugs on systems with no "Creating:" message.  It should fail
gracefully there, just not finding the ratings.

3.6.0 -- Thu May  8 19:55:58 PDT 1997  Tim Mann

* WinBoard now has right-button context menus in the ICS Interaction
window.  Some of the items do immediate commands on the player name you
have selected or pointed to.  (Suggested by Paolo Casaschi.)  Also, the
middle button or shift+right does a immediate Copy and Paste.

* Fixed a bug in Zippy's wild rejection.  The bug was causing Zippy to
reject all forms of wild.  Now it rejects only 1, 9, 16, 17, and 24, as
was intended.  These variants have different rules, while the other
variants defined so far only have different starting positions.
(Actually, wild 2, 3, and 4 never allow castling, but may sometimes by
chance have king and rook start on squares where castling appears legal.
This could cause a problem later.)

* Zippy now resumes adjourned games by feeding the chess program
the move list instead of the position.  Setting -getMoveList to False
restores the old behavior.  Feeding in the move list is better because
it enables the chess program to correctly handle en passant legality,
castling legality, draw by repetition, and draw by the 50 move rule.

* Added a WinBoard startup dialog for people who run WinBoard.exe without
using the Start menu or reading the help file.  Instead of being dumped
directly into GNU Chess mode, you now get a menu of choices.  You now have
to give the new WinBoard -cp option to go directly into chess engine mode.
I did not add this feature to xboard.

* Handling of "illegal move" from Crafty is now back on.  (It was turned
off in 3.4.6; see below.)  Crafty 12.0 doesn't seem to send bogus ones
anymore.  I did have to suppress sending time and otim in analyze mode to
make this work, but there is no harm in that.

* Zippy now sends "gameend" to ICS at the end of each game.  You can alias
this to "seek" or whatever you like.

* Added Crafty support for Move Now, using the "?" command.  We test
whether this command exists by trying it once at the start of the first
game, before it really makes sense.  If we don't get a message like
"Illegal move ... ?", we assume it's OK.  (We're careful about this
because sending a "?" to GNU Chess on Move Now keeps it from pondering the
next move as it should.)

* Added support for a tellusererror command from the chess engine.  See
engine-intf.txt.

* Attempted to make engine-intf.txt complete.

* Minor fixes/cleanup to GameEnds code, to be sure we always interrupt
when needed, and always undo an extra move generated by stopping the chess
program while it is thinking.

3.5.7 -- Sat May 03 22:37:44 PDT 1997  Tim Mann

Beta release of both xboard and WinBoard.

* Updated xboard documentation.  I really wish the man page was built from
the info file instead of being separate!  It's a pain to update them both.

* Updated documentation of the interface between XBoard/WinBoard and chess
programs, and renamed it to engine-intf.txt.

* Added support for tellics, telluser, and askuser commands from the chess
engine.  See engine-intf.txt.

* Various bug fixes.  On WinBoard, 256 color displays are finally handled
right; no more color flashing when you switch windows unless the colors
really need to be updated.  Also, I think the problem of the console font
failing to change or changing back by itself is finally fixed.

3.5.6 -- Tue Apr 29 03:08:00 PDT 1997

Beta release, WinBoard only.  ChangeLog was out of date in release,
updated here.

* Added ICC timestamp and FICS timeseal to WinBoard distribution.  These
are my own ports to Win32, based on and used by permission of the owners
of the proprietary source code (Daniel Sleator for timestamp, Henrik Gram
for timeseal).  The owners permit these programs to be distributed only in
binary form (to help prevent cheating), so to avoid running afoul of the
GPL, I have kept them as separate programs, not linked into the WinBoard
address space.  Updated Start menu icons to use them.

* Miscellaneous smaller changes.

3.5.5 -- Fri Apr 25 03:06:00 PDT 1997

Beta release, WinBoard only.  ChangeLog was out of date in release;
updated here.

* Added simple sound support to WinBoard.

* Updated WinBoard documentation.

* Internal implementation of the telnet protocol is now more complete.
You can now hop through a VMS host on the way to ICS.  For example, do
"xboard -ics -icshost vms.host.edu -icsport 23", then log in.  Do not use
the -telnet flag; that says to use an *external* telnet program.  To avoid
double echoes, you need to force character mode in VMS telnet after
connecting from VMS to ICS.  Do "^]^Mset mode char^M^M".

* Display opponent names in the title bar for MachineWhite, MachineBlack,
and TwoMachines modes.

* WinBoard now has an installer, built with InstallShield.  The installer
works with a binary-only distribution.  Sources are still freely
available, but now separately.

* Added SaveSettings to WinBoard, which saves current option settings to
winboard.ini.  Made sure all options can be saved and loaded, including
fonts and com port settings.

* If the game ends while you are dragging a piece, we now don't let you
finish the move.  Formerly the move was accepted and your opponent's clock
would start running again.

3.5.4 -- Fri Apr 18 01:15:24 PDT 1997  Tim Mann

Beta test release of WinBoard and xboard.  The documentation remains
out of date.

* Many fixes and improvements to new WinBoard user interface code.

* In Zippy mode, avoid sending another copy of the same move to the chess
program if ICS sends us another copy of the board image.  Hard to believe
it took me until now to diagnose and fix this problem!

3.5.3 -- Sat Apr 12 19:49:33 PDT 1997  Tim Mann

Beta test release of WinBoard and xboard.

* Fixed fatal bug in WinBoard input handling.

* Made code to stop chess program for reuse a bit smarter.  Removed kludge
of "white" in initString; it didn't work well, and is unneeded
with Crafty 11.21 and later.

3.5.2 -- Sat Apr 12 15:40:01 PDT 1997  Tim Mann

Beta test release of WinBoard.

* Ignore check and permit promotion to King during suicide games; no need
to turn off TestLegality.

* Renamed CheckLegality to TestLegality to avoid confusion with the chess
term "check".

* Added Rematch to Action menu.

* WinBoard now has a custom ICS interaction window with scrollback, a
separate line for input, and colorization.  Accelerators that conflict
with normal editing keys were changed (by requiring Alt+) so they can work
in both the console and the main window.

* WinBoard error popups are now non-modal and disappear when you make a
new move, as in xboard.

* Configure now defaults to --disable-ptys on all systems.  If anyone has
an ancient SysV system where pipes don't work with select, they can still
do "configure --enable-ptys" explicitly.  I would appreciate getting a bug
report if this happens to anyone, with complete output from configure and
"uname -a".

* "make install" now makes the installation directories too.

* Fixed a bug that would cause an "Illegal move" message for Black from
GNU Chess to be incorrectly considered bogus.

* Handle name changes during an ICS game (FICS bname and wname commands).

* You can force both chess programs to be killed at the end of each game
by turning off the reuseChessPrograms option.  There are still some
problems with reusing Crafty even in version 11.20.

* Now the second chess program stays around by default too, if it ever
gets started.

3.5.1 -- Sat Apr  5 16:47:48 PST 1997  Tim Mann

Beta test release.

* Don't kill off and restart the chess program for each game; keep the
same one running, using the "new" command to start a new game.  This
change works around the problem in Windows 95 that makes WinBoard crash it
at times, and is generally desirable to make new games start faster.  The
second chess program (for TwoMachines) is still killed at the end of the
game, and unfortunately this can still crash Windows 95.  Temporarily
added "white" to the initString to make this work with Crafty 11.20, which
has a minor bug in "new".  Older versions of Crafty have worse bugs in
"new"; they should not be used with this version of xboard.

* Support for FICS suicide chess: Parse illegal moves (that leave King in
check) in game history.  If CheckLegality is off, allow promotion to King
and illegal moves in game files.  We still generate e2e4 style notation
for illegal moves.

* Handle FICS "has timeseal; checking" message.

* Changed the coords from white back to black; this was a bug.

* Fixed problems compiling with K&R compilers.

* Fixed an old bug in RegisterMove that was crashing cmail on some systems
(notably linux).

3.5.0 -- Thu Jan  2 16:59:49 PST 1997  Tim Mann

Thanks to Frank McIngvale for much of the work on versions 3.4.4 and above!

* Fix Crafty resumed game time bug (frankm)

* Word wrap text in Analysis window (frankm)

* More debug info for XPM loading (frankm)

* Replaced config.sub, config.guess, etc., with up-to-date versions from
autoconf 2.12.  Hopefully this will fix problems on Pentium Pro machines.

* Removed some Makefile gunk that was causing looping for one person.

3.4.7 -- Thu Dec 19 14:22:41 PST 1996  Tim Mann

All changes from Frank:

* Retrieve ratings from ICC (and FICS, etc., when they add the Creating:
message), save them in the PGN tags, and pass them to Crafty in Zippy mode.

* Add settable time delay between characters in ICS login script.

* Colorize messages like personal tells.  Fix false recognition of channel
tells.

* Pass "tells" from Crafty through to ICS (in Zippy mode).

* Implement ~/ filename convention from C shell for game and position file
names.

* ZIPPYACCEPTONLY feature for testing.

3.4, patchlevel 6 -- Sat Nov 23 16:58:50 PST 1996  Tim Mann

* Put recognition of "illegal move" messages from Crafty for
illegal castling, etc., inside an #if that is currently turned off,
because of a bug in Crafty that generates bogus "illegal move" messages
after some moves that are actually legal and accepted by Crafty.

* Added -checkLegality option; previously this could not be turned off.

* Fixed an old bug in finding default board size parameters.

* Differentiated among channel tell, kibitz/whisper, and personal tell/say.

* Fixed a bug in detecting Xpm in the configure script.

3.4, patchlevel 5 -- Mon Nov 18 16:22:53 PST 1996  Tim Mann

* Added zic2xpm to the kit; it had been omitted by mistake.

* Added some default colors for -colorize

3.4, patchlevel 4 -- Sat Nov 16 18:10:17 PST 1996  Tim Mann

This is meant to be a beta release in preparation for version 3.5.

* Added InfoXBoard and ManXBoard to the Help menu.

* Made Frank's ICS input box optional, defaulting to off.

* Merged in Frank McIngvale's XbKit.  Many new features, including
-clickClick mode, the Analysis modes, piece flashing, ZIICS import,
ICS text colorization, and the ICS input box.  Many thanks to Frank for
supplying and documenting this code.

3.4, patchlevel 3 -- Mon Nov 11 18:23:14 PST 1996  Tim Mann

Small set of changes made while Frank McIngvale was working on XbKit in
parallel.  Unreleased in this form.

* Updated zippy.README.

* Removed useless X event handler and removed strange code for copying
form translation table to board that worked around the bug it caused.
This makes changing bindings in .Xdefaults more straightforward.

* Now pressing the Control key steps back one move, and releasing it steps
forward again.

* Moved quit from "q" to "Q" for greater safety.

* Use "unobserve" instead of "observe" to stop observing; needed on FICS.

* Support for interface variable.

* Strip titles from people who are talking to us, so (for example) Zippy
won't try things like "tell Darooha(*) hello".  Needed on FICS.

3.4, patchlevel 2 -- Tue Jul  9 19:06:42 PDT 1996  Tim Mann

This patchlevel is not planned to be an announced release.  It's in
preparation for integrating Frank McIngvale's XbKit.  It mostly contains
minor fixes I've accumulated since 3.4.pl1.

* WinBoard /telnet option now fires up an external program, as
with xboard, instead of trying to use a feature of NT 3.1 that does not
exist in later versions of NT or in Windows 95.  ChangeLog for 3.4.pl1
said this had been implemented there, but it really wasn't.

* Indicating player to move by the icon color now works under Windows 95.

* WinBoard now kills the chess program when you exit using the system menu
or the [X] button.  Thanks to Michael Lowe.

* Minor changes to Zippy, including: Now understands wild challenges on
FICS; these used to crash it.  Removed limit on how fast a game will be
accepted.  Use "set formula ..." on the chess server to limit this if you
are using GNU Chess.  Now sends correct opponent name to Crafty.

* Added some missing default values to documentation.  Thanks to Stuart
Cracraft.

* Bugfix: Trying to print "No fonts match pattern" error message would
crash.  This can happen to Linux users who don't install Helvetica, for
example.

* Bugfix: Defaulting feature in -size n,n,n,n,n,n would put us in an
infinite loop.

* Added more directories to search for Athena widgets on HPUX.

* New cmail (3.12) from Evan Welsh; includes small fix from Kayvan Sylvan.

* Recognize "illegal move" messages from Crafty for illegal castling, etc.

* Bugfix: "name" command added to zippy.c for Crafty was producing error
message if GNU Chess was in use.

* In bughouse mode, suppress holding messages from console window; show
holdings only in banner.

* Minor fixes/cleanup to Makefile.in and configure.in.

3.4, patchlevel 1 -- Mon Dec 11 13:43:12 PST 1995  Tim Mann

* This patchlevel updates WinBoard to match xboard, and includes a few
fixes and minor improvements.  "-size tiny" and "-size n,n,n,n,n,n"
are still not implemented for WinBoard.

* Installed support for Crafty based on code from Bob Hyatt.
Currently the only documentation for this is in the FAQ, and a few
things don't work with Crafty 8.23.  Please do not report these
problems as bugs in either xboard or Crafty.  Bob and I know about
them.  The worst ones (if not all of them) should be fixed in Crafty
8.24.

* Changed the kludge command we send when gnuchess wants to print
something that doesn't end with a newline, from "help" to "bogus".
This works because the error message gnuchess prints ends with a
newline.  It also improves compatibility with Crafty, which doesn't
need the kludge, but for which sending "help" causes a problem.

* Don't draw grid at all if lineGap is 0; previously we drew the grid
with X "0-width" lines (usually 1 pixel wide) and then overwrote it.

* Makefile: Removed xboard.info from "all" target so we won't try to
rebuild it, because this fails on hosts that don't have makeinfo
installed.  Other minor fixes to "clean" targets, etc.

* Fixes and cleanup to Auto Comment code that handles continuation
lines and highlighting.

* Auto Observe now tries to observe the game from the point of view of
the player who was on your gnotify list.  Requested by rng.
Limitations: We can't tell which player it was unless you have ICS
highlighting turned on.  Also, currently "observe foo" works as
required (observing from foo's point of view) only on ICC, but FICS
will probably implement this soon.

* "-size tiny" now makes the default font smaller automatically.  This
was implemented by introducing an extra Form widget in the hierarchy
for all xboard windows, named either normalLayout, smallLayout, or
tinyLayout.  So you can have resource specifications that apply only
to certain layouts; in particular, XBoard*tinyLayout*font.

* Bug fix: EditGame or EditPosition while playing or examining still was
not really being permitted.

* WinBoard bug fix: On the EditPosition menu, King did not work.

* Added text catalog of WinSock error messages to WinBoard, because
Microsoft still has not put them in the system message catalog.

* Removed support for older ICS game-ending messages that do not have
a PGN result token (*, 0-1, 1-0, or 1/2-1/2) after the closing '}'.
The code for older messages was sometimes firing on the newer
messages, due to parsing ambiguity.  If the current code sees an old
message, it will understand that the game is over, but will always
display * as a result token instead of trying to guess the result by
interpreting the text message.

3.4, patchlevel 0 -- Tue Nov 21 01:02:50 PST 1995  Tim Mann

* This patchlevel was released for xboard only.

* Updated the info file.  It should now be as up-to-date as the man page,
with good English except in the parts that pertain only to AmyBoard.

* Added "-size tiny", requested by Bob Hyatt.  Also cleaned up bitmap
support and added "-size n,n,n,n,n,n" to allow arbitrary-sized bitmaps,
if the actual bitmaps are supplied by the user.

* Updated bughouse support.

3.3, patchlevel 4 -- Sat Nov 18 02:27:21 PST 1995  Tim Mann

* Unreleased beta that works with preliminary FICS bughouse code.  Will
need changes before release to track FICS message changes.

* Removed use of .EX macro from man page.  It is not supported by some
nroff -man macro packages, notably the one on Slackware Linux.  Switched
to boldface for references to xboard and other commands within the man
page, as this seems to be the modern way.

* Bug fix: If ICS rejected a move, it was correctly undone on the board,
but the message widget still displayed the bad move.  Reported by DAV.

* Normally, xboard in ICS mode fetches the move list whenever the board
display switches to a new game.  Doing this is now an option
(getMoveList) that can be turned off, which is useful if you are watching
multiple blitz games.  Requested by rng.

* Move list fetching code is now smarter: it ignores a move list if it is
not for the right game.

* Added support for bughouse as implemented on FICS.  Holdings are shown
in the window title in place of the strength numbers.  A menu on mouse
buttons 2 and 3 (same on both) lets you drop pieces.  There is no checking
as to whether you actually hold the piece you are trying to drop; we rely
on ICS to check that.  Notation of the form P@f7 is generated and parsed.
The mate detector does not understand that non-contact mate is not really
mate in bughouse, but this does no real harm.  It results in a "#"
suffix being displayed on the move notation, but xboard does not assume the
game is over.

* Bug fix: Promotion to a knight was not working with ICC!  Thanks to
Wendigo for the report.

* Bug fix: Special pty code for host types *-*-aix3* and *-*-irix3*
(supplied from configure.in) had a bug that would cause childio.c to
fail to compile, due to a "continue" that was not within a loop.

* Bug fix: In pgntags.c, memory was being freed while still in use.  One
symptom this caused was that on some machines, cmail would fail with a
message that it could not find the BlackNA tag.  The error was in some
submitted code that I included in version 3.2.pl3 without reading
carefully enough.  Anders Forberg noticed the symptoms, and Evan Welsh
(who had nothing to do with causing the bug) found the bug and submitted a
fix; thanks to them both.

* Removed restriction against using EditGame while playing, observing,
or examining on ICS.  You still get a warning popup.

3.3, patchlevel 3 -- Sat Sep 16 11:44:05 PDT 1995  Tim Mann

* Bug fix: Going directly from MachineWhite to TwoMachines mode would kill
off the second chess program after Black's first move.

* Added -timeIncrement feature.  Thanks to Joel Rivat.

* Deleted code that tries to keep you from observing more than one game,
or observing while playing or examining.  There is actually no problem in
doing this, except that every time an update comes in from a different
game than is currently being displayed, xboard fetches the history of the
new game, which may be time-consuming if you are on a slow link.

* Fixed configure so as not to crash when neither lex nor flex is found.
lex or flex is needed only if the user wants to rebuild parser.c.  Thanks
to Phil Humpherys for reporting the crash.

* Bug fix: config.h.in used #define instead of #undef for some macros used
in the pty code in childio.c.  This causes the code to fail to compile on
some architectures, because the symbols are supposed to be undefined, not
defined to empty, when they are not set in configure.  Bug originated in
3.3.pl0 when config.h was introduced.  Thanks to Phil Humpherys for report.

* Bug fix: ShowThinking would not show anything when current position had
no move to display in the move window.  E.g., if position was created by
LoadPosition or EditPosition.

3.3, patchlevel 2 -- Mon Aug 28 11:11:11 PDT 1995  Tim Mann

* Zippy code was omitted from xboard-3.3.pl1 by mistake; now included.

* For WinBoard, added hint to help file that you may need to turn off
LocalLineEditing while typing dialing commands to your modem.

3.3, patchlevel 1 -- Sat Aug 19 15:13:30 PDT 1995  Tim Mann

* Zippy distribution is no longer separate from regular xboard distribution.

* Deal properly with Show Thinking output from GNU Chess when it is
thinking on its opponent's time.  In TwoMachines mode this output is
suppressed to avoid interfering with the output from the machine that is
on move; in other modes it is displayed (including the move that GNU Chess
is predicting the user will make next).  GNU Chess produces this output
only if it is built without -DQUIETBACKGROUND defined; this symbol is
defined by default in patchlevels before pl75, but undefined by default in
pl75.

* Bug fix: Handling of initial board position in move list for wild games
was broken, so wild games could not be observed and adjourned wild games
could not be continued.  Thanks to "Maximum Entropy" for the bug report.

* Added feature: algebraic notation now shows "+" indicator for check
and "#" for checkmate, as called for in PGN standard.  Thanks to Kevin
Maher for the suggestion.

3.3, patchlevel 0 -- Thu Jul 27 22:21:07 PDT 1995  Tim Mann

* Changed configuration to use a config.h file instead of passing zillions
of -D options on the cc command line.

* Merged a small fix and some updates to the texinfo file from Jochen
Wiedmann.  The texinfo file still needs work.

3.2, patchlevel 5 -- Tue Jul 18 20:29:39 PDT 1995  Tim Mann

* Beta test release of xboard only.

* Updated WinBoard code to include new xboard features.

* Added texinfo file from Jochen Wiedmann to the release, but not as the
primary documentation.  It needs updating, and the English needs work.
I did make a few improvements, mostly to change incorrect uses of @var to
either @samp or @code as appropriate.

* Merged in code changes to 3.2.pl4beta from Jochen Wiedmann.

* Fixed EditComment; did not pop up window in previous beta.

* Added AutoComment feature.

* Added GameListDestroy to disable the outdated game list popup in cases
where we load a new game file without building a new popup.

* Added yyskipmoves feature to parser.l to speed up building of gamelist.

* gamelist.c wouldn't compile with a non-ANSI compiler.  Fixed.

* Change to yy_text handling in patchlevel 3 still had problems.  Can't
use AC_DECL_YYTEXT in configure.in, because that defines YYTEXT_POINTER
according to whether the lexer on the current host makes yytext a pointer.
But most people will be using a parser.c that was generated on another
host and shipped with the package.

3.2, patchlevel 4 -- Sun Jun 25 19:13:43 PDT 1995  Tim Mann

* Beta test release of xboard only.

* Added FIREWALLS section to man page.

* Changed -icsport to be a string.  Now with the -telnet option,
specifying -icsport "" suppresses the second argument to telnet.

* Added EditTags feature.  Removed AboutGame from menu, because EditTags
subsumes it.  EditTags suggested by Jochen Wiedmann and first implemented by
him in AmyBoard.  xboard implementation is my own.

* Fixed some missing or incorrect prototypes.

3.2, patchlevel 3 -- Sat Jun  3 18:57:38 1995  Tim Mann

* Beta test release of xboard only.

* New version of cmail from Evan Welsh, to fix compatibility problems with
perl 5.0.

* Added game list feature on Load Game, based on code from Jochen
Wiedmann.  Integrated it with cmail.

* Several bug fixes from Jochen Wiedmann, including one to my yy_text
workaround for the difference in the type of yytext between lex and flex.

* Handle clock pause on FICS.

* Suppress clocks in untimed FICS games (time control 0 0).

* Rebuilt configure script with autoconf 2.3.  This fixes a bug in
configuring for X11R6, where -lSM -lICE would not be added when needed.

* Fixed inconsistent type declarations on IntSigHandler and
CmailSigHandler.  Bug report from Josh Daynard.

* backend.c wouldn't compile with a non-ANSI compiler.  Fixed.

3.2, patchlevel 2 -- Tue Feb  7 14:50:30 1995  Tim Mann

* Minor release of both xboard and WinBoard.

* Added recognition of some FICS messages.  On the other hand FICS is also
changing some of its messages to match what xboard already recognizes.

* Temporarily went back to using "promote" command on ICS instead of
"a7a8=Q", because FICS doesn't implement the latter yet.

* We now avoid using overlapped I/O on pipes in WinBoard, to make Windows
95 beta 2 happy.  This lets WinBoard work with GNU Chess on Windows 95!

* Installed patches from Jochen Wiedmann to coordinate with Amiga XBoard.

* Installed patch to cmail bug in LoadGame from Evan Welsh.

* Bugfix: checkmate and stalemate moves entered with EditGame in ICS mode
were not being handled correctly.  Bug was in GameEnds().

* Implemented EchoOn and EchoOff for xboard, using system("stty echo\n").
Now passwords won't be echoed when you connect directly to ICS.  Also,
telnet negotiation characters aren't displayed (when possible).

* Implemented more of the telnet protocol.  Now connecting to a telnet
server with "-icsport 23" should work even without giving the -telnet
option.  The telnet is in "old line-by-line mode".

3.2, patchlevel 1 -- Sat Dec 10 13:50:46 1994  Tim Mann

* This patchlevel released for WinBoard only.

* winboard.c: Fixed ConsoleInputThread().  Needed to change CRLF to LF,
not to CR.  This was stopping normal /ics mode from working.  Thanks to
Asher Kobin for the bug report.

* winboard.c: Fixed Raw(), EchoOn(), EchoOff().  Now they take effect
immediately, not on the next console read after the one in progress.

* winboard.c: Attempted to make WinBoard work with gnuchessx running
directly on Windows (not remotely via rsh).  It now works on NT, but only
if gnuchess is told not to think on its opponent's time ("easy\n" removed
from initString).  The problem seems to be that GenerateConsoleCtrlEvent
is not doing anything.  On Windows 95 beta 2, we get error messages on
both reading and writing to gnuchessx; I didn't investigate why.

3.2, patchlevel 0 -- Wed Dec  7 13:23:36 1994  Tim Mann

* Thanks to all the beta testers who gave me feedback: Josef Nelissen,
Steve Booth, Evan Welsh, Dima Dakhnovsky, Chris Petroff, Peter Jansen,
Derek Terveer, Michel van der List, Richard Lloyd, Shelly Mistry, and Mike
Lee.  Sorry if I forgot anyone.  Thanks to Virendra Kumar Mehta for
information about DYNIX/ptx.

* Don't exit on keyboard EOF unless we get two in a row.

* WinBoard only: added -localLineEdit switch to allow turning off local
line editing if you really want to.  It is still a bad idea to let the
echoing be done remotely, however; see below.

* Fixed some configure problems on HP-UX.  [Steve Booth]

* Fixed (I hope) configure problem on SunOS 5.3/Solaris 2.3.  [Josef Nelissen]

* cmail bugfix from Evan Welsh (cmail 3.4).

3.1, patchlevel 9 -- Fri Dec  2 23:54:56 1994  Tim Mann

* Beta distribution only

* Always do local echo/edit of user typing in ICS mode.  Doing the echo
downstream may seem nicer in some modes, and it can be hard to turn that
echo off, but the echoed characters can be interleaved with ICS output
and make it impossible to parse correctly.  For xboard this involved only
a change to recommendations in the man page, as Raw() isn't implemented.
For WinBoard, removing Raw() made a real difference.  Added code in
WinBoard to change /r/n back into /r on keyboard input, as we get the
former when Raw() is not called.

* Do not issue ICS "refresh" command after we start to observe a game
unless we get to the next prompt without seeing a board image.  Newest
version of ICS doesn't require this refresh, but old versions around still
do.

* cmail bugfix and small code cleanup in LoadGame, from Evan Welsh.

* Added keyboard accelerators N/P for LoadNextGame/LoadPreviousGame.  Evan
Welsh request.

* Using "-" on the command line as a filename for loading (saving) games
or positions specifies the standard input (standard output).  Alain Picard
suggestion.

* On WinBoard only, a command line option without a leading '-' or '/' is
now taken as the value of -lgf.

* Changed to not use stdin, stdout, stderr as initializers in backend.c;
needed for GNU libc compatibility.  You also must build parser.c with flex
(not lex) if you are using GNU libc, to avoid having the same problem
there.

* Changed WinBoard to avoid using "overlapped" input on the console.  It
now seems to fully work on Windows 95 beta 2.

* Improved comment popups on WinBoard.  Now newlines are handled properly,
and the plain Comment popup window doesn't disappear and reappear when we
step to a new move with a new comment.

* Fixed bugs in detecting the absence of the time and otim commands.

* Added built-in implementation of rcmd protocol to WinBoard.  Windows NT
does not implement passing signals through rsh, and Windows 95 does not
have rsh at all.

* Added -remoteUser option.

3.1, patchlevel 8 -- Mon Nov 28 15:26:07 1994  Tim Mann

* Beta distribution only

* Rearranged ChangeLog file into reverse chronological order to be closer
to GNU standards.

* Integrated new cmail code from Evan Welsh (including cmail RCS rev 3.2).
Includes a bug fix to TruncateGame.

* Updated ICS address to be chess.lm.com.

* Bug fixes to handling the aftermath of FatalError.  Thanks to Chris
Petroff for the bug report.

* Test for remsh before rsh, other fixes for HP-UX.  Thanks to Richard
Lloyd.  I wasn't able to do all the things he suggested, so there may
still be some rough edges in building on HP-UX.  See the FAQ file for hints.

* Bug fix; added missing check for HAVE_SYS_SYSTEMINFO.  Thanks to Josef
Nelissen for testing on Solaris 2.x.

* Updated WinBoard to match xboard.  (WinBoard still has a few option
dialogs that don't exist in xboard.)

* Changed Hint output to a popup.

* ShowThinking output and move output no longer overwrite each other.
ShowThinking output won't appear if the displayed position is not current.
ShowThinking output in TwoMachines mode made clearer and documented.

* Implemented --enable-ptys and --disable-ptys arguments to configure.

* Fixed Book and Hint code to work over a pty with echo enabled and tabs
expanded to spaces.  Thanks to Dima Dahknovsky for the bug report.

* Moved Attention calls from all over xboard to one place, inside
SendToProgram.

* Added bulletproofing to ShowThinkingEvent.

* Added code to handle "refresh N" boards that come in from ICS properly,
assuming ICS is changed to mark them with a new relation code (-3).

3.1, patchlevel 7 -- Sun Nov 13 22:16:01 PST 1994 -- Tim Mann

* Beta distribution only

* Changed ShowThinking to just show the current best line in the
DisplayMessage area, instead of dumping everything to stdout.

* Installed new cmail (RCS rev 3.1) and cmail.man (RCS rev 1.10), and
changes to cmail code in backend.c, from Evan Welsh.

* Miscellaneous minor fixes.

3.1, patchlevel 6 -- Fri Nov  4 12:53:53 PST 1994 -- Tim Mann

* This patchlevel was not actually released to anyone.

* Updated the pty code to be based on GNU Emacs 19.24, and moved it to a
separate file.  It was hard to split out just the pty configuration from
all the stuff emacs does with its custom configure script and .h files,
but I did my best.

* Converted from imake to GNU autoconf.  This was a serious upheaval.

* Put in code to help trap "error gathering move list" problem reported by
Michel van der List if it recurs.  I couldn't reproduce it.

3.1, patchlevel 5 -- Mon Oct 31 21:12:00 PST 1994 -- Tim Mann

* Beta distribution only.

* We now test for checkmate or stalemate in EditGame mode after every user
move, and in LoadGame mode whenever we hit the end of a game without
seeing a PGN end marker.  cmail needs an update to deal with this
correctly; Evan promises one.

* Bugfixes in new move generator.  Thanks to Mike Lee for reporting one of
the bugs.

* Imakefile was omitted from patchlevel 4.

3.1, patchlevel 4 -- Mon Sep 19 18:19:46 PDT 1994 -- Tim Mann

* Beta distribution only.

* The move generator includes a mate tester.  Initially this is used only
by cmail, and even that usage needs further work.

* Wrote a true move generator and used it to replace all the move
disambiguation and legality checking code in parser.l.  The move generator
is capable of dealing correctly with en passant and castling availability,
but the rest of the program still does not keep track of this information.

* Bug fix: xboard did not handle "foo has made you an examiner of game 23"
message.  Thus you could not use examine features until the next board
came in, showing your new relation to the game.  Thanks to POOKIEWOOKIE on ICS
for the bug report.

* Added AutoObserve feature.  Thanks to Chris Petroff for the idea.

* Added Book feature to use new gnuchess "bk" command.  Mike McGann request.

* Redid code to handle missing "time" command in gnuchess, because latest
gnuchess no longer sends a response to this command.

* Eliminated need for -DFLEX.  Thanks to Michael Shields (Vladimir?) for
the idea.

* Added missing code to implement MoveNow in TwoMachines mode.

* Added ShowThinking feature.  Thanks to Richard Lloyd for the idea.

* Applied patches from Evan Welsh; some fixes and improvements to the
cmail code.

* Fixed bug in moving from EndOfGame mode to MachineWhite or MachineBlack,
introduced in previous patchlevel.  Also fixed related bug in ending a
game in ICS mode; was entering EndOfGame mode instead of IcsIdle.

* Added patch to implement internetChessServerLogonScript flag, from Kevin
O'Connor.  Thanks!

3.1, patchlevel 3 -- Wed Sep  7 13:22:07 PDT 1994 -- Tim Mann

* Beta distribution only.

* Merged in new cmail code from Evan Welsh.  He added the ability to have
more than one game per message, needed for official IECG matches.  I added
the ability to resign or offer/accept/decline a draw in a cmail game.

* Bugfix: invalid -tc option caused segmentation fault; DisplayFatalError
was called too early in initialization.  Georges Honore reported this bug.

* Decided to keep EndOfGame mode as an element of the user interface---it
means that a gnuchess game or loaded game has ended, and the user must
explicitly select EditGame to edit it, rather than just being able to
enter more moves freely.  But internally there is no longer an invariant
tying this mode to whether the chess program is running.

* Zippy bugfix: Was saving only the final position in the -sgf file when
the game ended by something other than resignation or flag.  Also fixed
the longstanding bug that Zippy would think the final board of such a game
was a new game and restart the chess program.

* Now does a better job of faking castling availability in FEN.  We still
don't really keep track of it, but now at least we don't say that castling
is still available when the king or rook is not on its home square.

* Bugfix: Initial board of game history for wild games was going through
too much processing, causing us to forget the game length, which is now
needed by ParseGameHistory.  This was causing problems with resuming
adjourned wild games.

* Updated ICS host to ics.onenet.net.

* Zippy now accepts challenges where the opponent specified his color.

* Added ZIPPYPASSWORD2 to let operator give commands directly to gnuchess.

* Bitmap directory can include alternative icons now, too.

* Handle "Game * (*) has no examiners" message from ICS.

* Revamped window title and icon name selection.

3.1, patchlevel 2 -- Sun Jun 12 17:16:28 PDT 1994 -- Tim Mann

* "Beta" distribution for Zippy users only.

* Bugfix: common.h was assuming that X11 type Boolean is char, which is
not always true.  This might have caused all sorts of obscure bugs!

* Installed new bitmaps from Elmar Bartel as the default.  Many thanks!
The old bitmaps can be used by changing the "bitmaps" symbolic link before
compiling xboard, or by using the -bitmapDirectory option at runtime.

* Loading a game that ends with the PGN unfinished symbol ("*") now always
leaves you in EditGame mode.

* Added documentation of -icscomm to man page.  Thanks to Maarten Remkes
for the linux script.

* ^C now kills gnuchess as well as xboard.  Thanks to Dima Dakhnovsky for
reminding me how to do this.

* Bitmap icon color now indicates player to move.  Stuart Cracraft
suggestion.

* Changed piece bitmap flags to have just one flag, which points to a
directory full of bitmaps, instead of a flag for each bitmap.  Also
changed bitmap naming convention.

* "Connection closed by ICS" is no longer a FatalError popup.  This was
too annoying in the normal case where the user typed "quit".

* Changed default font to 14 pixels instead of 10 points.  This seems to
make it close to the size I want it to be on more displays.

* Major mode (GNU Chess, etc.) appears in title bar.  Stuart Cracraft
request.

* Bug fix: EditGameEvent, MachineBlackEvent, MachineWhiteEvent, and
TwoMachinesEvent were calling PauseEvent to get out of pause mode, which
now has undesired side effects, such as advancing the display to the
forwardMostMove.  It works fine to just set pausing = FALSE instead.

* IcsExamining mode now lets you access ICS edit position commands using
the same popup menus as xboard's EditPosition mode.  Thanks to DAV on ICS
for inspiring the idea.

* Corrected test for gcc on HP in Imakefile; thanks to Richard Lloyd.

3.1, patchlevel 1 -- Wed Jun  1 16:25:11 PDT 1994 -- Tim Mann

* Added parser.c.lex and parser.c.flex to the distribution.

* Added HP gcc options to Imakefile, from Mats Nylen.

* EndOfGame mode no longer highlights EditGame mode indicator, because the
modes really do differ.  I would like to get rid of EndOfGame mode in the
future, at least as far as users can see.

* Larger %a in parser.l, needed for RS/6000 users.

* Minor improvements to Mail Move error messages.

* When -debug flag is given to xboard, -v is passed to cmail.

* Old Save Style uses "1. ..." instead of "1..." when black moves after a
comment; more like xboard 3.0's actual style.

* New version of cmail from Evan Welsh.  Looks for UCB Mail in a more
portable way and has some minor bug fixes.

* Bug fix: Saving a FEN position while in EditPosition mode with black to
play was showing white to play in the saved position.

3.1, patchlevel 0 -- Fri May 20 16:36:15 PDT 1994 -- Tim Mann

* This is the first general release since 3.0, patchlevel 9.  Releases
since then have been limited-distribution or beta releases.

* Thanks to my version 3.1 beta testers: Dmitry Dakhnovsky, Ed Hanway,
Richard Lloyd, Mike McGann, Shelly Mistry, Josef Nelissen, Chris Petroff,
Jack Robertson, Michel van der List, Ky Macpherson, Derek Terveer, and
Evan Welsh.  Sorry if I've forgotten anyone who gave me feedback.

* Updated man page.

* Minor cleanup on menu sensitivity code.

* Integrated another even better version of cmail from Evan Welsh,
including some code he supplied in xboard itself.

* A few more fixes to cmail support.

* Automatically update clocks after an ICS "moretime" command.

* Handle ICS automatic examine mode (set examine 1) after a game.

3.0, patchlevel 14 -- Tue May 17 13:41:44 PDT 1994 -- Tim Mann

* Beta test release only.

* Don't suppress prompt on first board of game being examined; otherwise
it looks like nothing happened at all (i.e., like you're lagged).

* Added StopExamining and StopObserving (Chris Petroff suggestion).

* Made Reset do a refresh on ICS.  John Chanak's original ICS code for
xboard tried to do this; I finally decided it was a good idea after all.

* Fixed bugs in handling updates that come in while you are pausing in
examine mode.  This is pretty tricky to do right.

* Made un-Pausing immediately pop you to the current position.  This is
always necessary in examine mode, since the game may have changed under
you; your remembered moves might no longer be right.  So I made it do the
same in all modes.

* Took Detach Examine mode back out...used Pause mode for this instead!

* Put in a trap for the GNU Chess bug of printing an Illegal Move message
when its own hint move is illegal.

* Attempted to fix a Zippy bug; bogus "exited unexpectedly" messages after
it checkmates its opponent.  This involved adding an argument to GameEnds
to say who says it ended (ICS, GNU, etc.)  and taking different actions in
different cases.  Unfortunately, this just restored an older Zippy bug, where
Zippy restarts gnuchess when it gets the board with the final position,
because GameEnds still puts xboard in EndOfGame mode.  Sigh.

* We now capture elapsed time on last move when getting game history.
(Josef Nelissen bug report)

* Rewrote code to redisplay last file title so it really works.

* Fixed bug in oldSaveStyle.

* Larger %a and %o were needed for lex.

3.0, patchlevel 13 -- Mon May 16 16:26:22 PDT 1994 -- Tim Mann

* Beta test release only.

* FatalError popups stay on the screen now.  If the error is really fatal,
all functions are disabled, and the program exits when you press OK.

* Redisplay last file title when using Load (Next/Previous/Same) Game.

* Zippy understands new match challenge message format on ICS.

* Added Revert command.

* When examining a game on ICS, < > buttons do ICS backward/forward
commands, unless you set the Detach Examine option.  Thanks to Dima
Dakhnovsky for the idea.

* Fixed various minor problems in cmail mode.

* cmail generates the tags now.  New version of cmail from Evan Welsh.

* cmail mode won't let you do MailMove unless the currently displayed
position is exactly one move past the end of the game you loaded.

* Fixed building of man pages in Imakefile

* Updates to INSTALL file

3.0, patchlevel 12 -- Sat May  7 21:10:03 PDT 1994 -- Tim Mann

* Beta test release only.

* Brought man page up to date.

* Added Shift+R to resign from keyboard.

* Some items on Action menu available in GNU Chess mode now.

* Revamped Action menu.

* Reordered functions in backend.c as a small step toward reorganizing
this whole mess.

* Generate TimeControl PGN tag.

* Get type of ICS game (e.g., rated blitz) and save in PGN tags.

* Bug fix: Clocks were not redisplayed when entering EditGame mode.

* Bug fix: Clocks were not being redisplayed after loading a game file
with -td 0, so they could show the wrong color active.

* Bug fix: Chess programs would be killed and match mode would exit
prematurely when loading a PGN game fragment ending with "*".

* ICS command "sposition" no longer confuses xboard.

* Integrated new version of cmail (with support code in xboard) from Evan
Welsh.

* Added TruncateGame, MoveNow, RetractMove, and QuietPlay.

* Bug fix: switching between MachineWhite and MachineBlack was not calling
Attention().  Reported by Dino Dini.

* More improvements to INSTALL and Imakefile.

* Pack moves into 79 character lines in PGN output.  We don't generate
check indications, and we always break the line before the result,
so this is not quite PGN export format.

* Use FEN tag in PGN.

* Improved finding and counting of game starts in save files.

* Negative position or game numbers in -lpi/-lgi mean to seek to that byte
offset.  Hook for possible future features, not in man page.

* Detect and handle absence of either "time" or "otim" commands in
gnuchess.

* Don't use "promote" command to ICS anymore.

* Handle switching sides and taking back moves on FICS.

* Handle flip state flag in style 12 board.

* Handle examine mode on ICS.

* Improved error popups for various kinds of illegal moves.

* Suppress unasked-for hints from gnuchess (which it generates in post
mode).

* Load/save position functions use FEN.  Old style also supported.

* Added detailed error messages if loading a bitmap file fails.

* Small board has 2-pixel lines between squares instead of 3-pixel.

* Added OldSaveStyle and AboutGame.

* Renamed ForceMoves to EditGame.

3.0, patchlevel 11 -- Tue Sep 21 15:25:36 PDT 1993 -- Tim Mann

* The following changes were present in xboard 3.0, patchlevel 11, but the
first group did not make it into WinBoard 3.0 until later.  xboard
3.0.pl11 was a limited-distribution release only, mostly to Zippy users.

* Man page minor fixes.

* Added a missing file close.

* Removed automatic error popdown on Reset, which was destroying some
error messages before they could be read.

* Fixed char vs. unsigned char warnings on bitmaps.

* Use ICS board style 12.  Some improvements to ICS parsing.

* Comment window is now labelled with the move the comment is on, and
comments don't pop down when you step to the next move.

* Save files now in PGN format.

* Support for loading PGN files.  PGN tags pop up when a PGN game file
is loaded.

* More info in INSTALL and Imakefile about building for Suns (and
other systems).

* WinBoard 3.0 patchlevel 11 split off from an early version of xboard
3.0 patchlevel 11, so it does not have all the features of that
patchlevel.  The following changes made it into both xboard and
WinBoard:

* Made Comment dialog non-modal in WinBoard.

* EndOfGame mode is now more transparent.  It looks like ForceMoves
mode except that there is no chess program running.

* Small bug fixes in clock management.  Most noticeably, pausing when
it is gnuchess's move now works as documented (again).

* Add minimal support for -icscomm option.  Not documented yet because
I haven't sorted out the issues with setting the tty modes on the comm
port device, or with locking it properly.  But it's usable by wizards.

* Don't restart the chess program upon Backward event from EndOfGame mode.

* Suppress extra prompt after ICS sends us a board.

3.0, patchlevel 10 -- Sat Sep 11 18:44:03 PDT 1993 -- Tim Mann

* Beta test release only.

* Zippy now plays chess.  zippy.c and zippy.h are still not included
in the standard distribution, but are available on request.

* Switched to using style 12 on ICS.

* Updated man page, and documented use of XBoard*form.translations to
add more shortcut keys.

* Added shortcut keys "d" to claim/offer/accept a draw, and "t" to
call flag.  Suggested by venu on ICS.

* More explicit instructions in INSTALL file.

3.0, patchlevel 9 -- Tue Sep  7 14:02:00 PDT 1993 -- Tim Mann

* General release, minor update to 3.0.pl8.

* Loosened checking on whether it's okay to start a move, to satisfy
ICS ultra-blitz players.  Now we don't check whether it's your turn
until you let go of the piece.

* Parser now recognizes "+-+" as meaning the game ended in a draw.

* Got rid of S_NONE symbol, which seems to conflict with some symbol
Sun defines.

* Tweaked the man page.  Clarified that there is currently no way for
two people running copies of xboard to play each other without going
through the Internet Chess Server.

* Fixed a bug in color name conversion.  Asking for two different
colors whose names were the same in the first four characters would
get you two copies of the first one.  Thanks to Volker Zink for the
bug report.

* Improved confusing Usage() message.

* Added a bunch of Sun information to the Imakefile and INSTALL file.
Thanks to Ed Hanway, Arik Klingensmith, and others who responded.

* Test for defined(WIN32) instead of !defined(unix).

* Avoid using (void *) type with non-ANSI C compilers.  Thanks to
James Altucher for the bug report.

3.0, patchlevel 8 -- Thu Sep  2 12:23:01 PDT 1993 -- Tim Mann

* Note: Patchlevel 8 was the first non-beta release of xboard 3.0

* Added cmail to distribution.  Contributed (and still maintained) by
Evan Welsh.

* Bug fix: -queen option wasn't initializing menu check.  Reported by
Pat Surry.

3.0, patchlevel 7 -- Thu Aug 26 13:23:24 PDT 1993 -- Tim Mann

* Sent WinBoard 3.0.pl7 to Torre on ICS

* Added parser.h to hold the interface to parser.l

* Upgraded COPYING file and copyright notices to GNU GPL version 2.

3.0, patchlevel 6 -- Tue Aug 24 15:16:13 PDT 1993 -- Tim Mann

* We no longer display intermediate positions or intermediate comments
while loading a game file with -timeDelay 0 or loading an opening to
start up a -matchMode game.

* Loading an empty game from an xboard save file now gives a status
message "No moves in game" instead of an error popup saying "Game not
found in file."

* Added comment.awk to distribution.

3.0, patchlevel 5 -- Tue Aug 17 16:45:54 PDT 1993 -- Tim Mann

* Bug fix:  xboard would crash if it couldn't get all its colors; now
it switches to monoMode instead.  Also, xboard was trying to convert
color resources even when using a b/w display.  Reported by Larry
Rogers.

* Bug fix: Declared fields of TimeMark as signed so that we get signed
instead of unsigned arithmetic.  SubtractTimeMarks was breaking on
Alpha AXP (which has 64-bit longs) with old declarations.  Reported by
Michel van der List.

* Bug fixes:  Keyboard accelerators now work after EditComment window is
popped down.  Iconize keyboard accelerator now works even if xboard
was started with -iconic flag and later deiconized.

* Bug fix:  The routine that tests whether a move is illegal because it
would leave you in check was not handling e.p. captures properly.
Reported by Patrick Surry.

* Bug (?) fix:  Was adding time to clocks at time control even when
loading a game file.  Actually it's not entirely clear how time
controls should be dealt with when some moves are loaded from a file
or clicked in with ForceMoves.  For now ForceMoves mode does add the
time (because it can be used to change moves during a live game), but
LoadGame mode does not.

* Updated usage message.

* Previous attempted fix to matchMode had broken TwoMachines mode and
generally needed more work.  Also simplified command line interface to
matchMode.

3.0, patchlevel 4 -- Thu Aug  5 14:17:18 PDT 1993 -- Tim Mann

* Thanks again to the beta testers listed for 3.0 patchlevel 3, and also
Desnogues, Steve Cariglia, Niklas Engsner, Mark Silver, and Roger Rowe.

* Reorganized man page, splitting OPTIONS into subsections.

* matchMode was very broken; fixed.

* Changed convention for turning off command line options from --opt
to -xopt, to be less inconsistent with GNU standards.  Also changed
the long command line options to take True/False arguments like
resources; seems to make more sense this way.

* Added AlwaysQueen option -- suppresses promotion dialog and always
promotes to a queen if you move a pawn to the last rank.  Has no
effect on gnuchess (or your ICS opponents!) -- they can still
underpromote.

* Subtracted an extra fudge term when determining how wide message and
title widgets should be.  This fixes a problem some beta testers had.
Wish I knew why it's needed.

* Bugfix in parser; symptom was that you couldn't do LoadGame after
observing a game on ICS.

* Bugfix in Forward; didn't work after game ended while Pause was turned on.

* Removed bogus execute bits on .h files.

* Use REMOTE_SHELL and TELNET_PROGRAM definitions.

* MachineWhite and MachineBlack now work from TwoMachines mode.

* Popping down an error message with the [ok] button was not turning off
the errorUp flag, so the next move would cause xboard to try to pop it
down again, resulting in a wild memory reference and sometimes a crash.

3.0, patchlevel 3 -- Tue Aug  3 17:40:27 1993  -- Tim Mann

* Thanks to my beta testers: Patrick Surry, Takuya Kojima, Robert J. Luoma,
Chris L.  Petroff, Richard K. Lloyd, Michel van der List, Craig Metz,
Antoon Frehe, Simon Clift, Shelly, Eric Peterson, Christopher Mitchell,
Martin Koch, Ed Hanway, Steve Booth, Udo, Ken Hobday, and Joseph Duhamel.

* Improved error messages for trying to move the wrong color pieces or
to move when it's not your turn.

* Special code for monoMode on 1-bit displays now understands displays
where 1=white and 0=black.

* Declare getenv() if <stdlib.h> not included; avoids a compiler warning.

* Documented borderXoffset and borderYoffset.

* Added -titleInWindow option for use with X window managers that
don't let us set the title in the window banner.

* Fixed error message printing in WinBoard; system error messages no
longer appear as numeric codes.

* The error message popup is now non-modal; you don't have to press the
[ok] button before you can do something else.  In addition, the popup is
positioned so that it doesn't cover up the board (too much), and making a
move or otherwise clicking on the board pops it down.  (Not implemented in
WinBoard.)

* You can now call your opponent's flag in ICS mode by clicking on his
clock.

* Fixed minor bugs in -flipView option and documented exactly how xboard
decides which way to flip the view.

3.0, patchlevel 2 -- Fri Jul 30 22:20:23 PDT 1993 -- Tim Mann

* Added Autosave to Options menu.  Would be better to have Save
Options dialog as in WinBoard, but this was quick to do and gives the
most-needed functionality.

* Changed "Reload Game" on menu to "Reload Same Game".

3.0, patchlevel 1 -- Thu Jul  8 21:22:59 PDT 1993 -- Tim Mann

* Sent a copy of patchlevel 1 to Patrick Surry to beta-test.

* Added -cmail option that sets appData.cmailMode.  Currently a no-op.
In the future this may set special modes for use by the cmail script
for playing chess by email.

* Added LoadNextGame, LoadPreviousGame, and ReloadGame to File menu.
ReloadGame suggested by Patrick Surry.

* Added -flipView command-line option.  Suggested by Patrick Surry.

* Fixed bugs in parser.l:  (1) Pattern for "# xboard game file ..."
needed to match to end of line.  (2) Start of a new file was not matching
the ^ start-of-line character.  The fix for this is a kludge.

* Made game counting code in LoadGame more robust, and made LoadGame
able to detect the end of a saved partial game (by noticing the start
of the next game) in game files created by XBoard itself.  We don't
try to find the start of the next game that way in other kinds of game
files, because the only way I can think of to do that is to look for
another move #1, and that technique gets too many false hits.

* Fixed recently introduced bug in LoadGame when game starts with a
position diagram.

3.0, patchlevel 0 -- Fri Jun 25 14:17:17 PDT 1993 -- Tim Mann

* Changes in this patchlevel were too numerous to list.  Larger ones are
listed below.

* Added a popup dialog to enter and edit comments.  Inspired by some
code from Patrick Surry.  Changed the normal read-only comment popup
to the same style.

* Added ICS init script feature from Karl Schwamb.

* Added some ESIX fixes and OMIT_SOCKETS ifdef option, from Kayvan Sylvan.

* Revamped code to allow use of flex instead of lex on parser.l.
Using flex requires adding -DFLEX to defines in Imakefile.

* Source code is split into front end (xboard.c), which knows about X
and Unix, and back end (backend.c), which knows about chess, gnuchess,
and the ICS.  There is also a front end for Windows NT.

* Boolean command line options now use "-foo" to turn on and "--foo"
to turn off instead of "-foo true" and "-foo false".  [Later -xfoo;
see above.]

* Added menu commands to control autoflag, bell, and coords options.

* User interface has a new look: (1) Menu bar instead of array of
buttons.  A few very commonly used features have small buttons in
addition to being on the menus. (2) Large font for clock.  (3) Pop-up
dialogs for errors.

2.1, patchlevel 11 -- Sat Jun  5 00:01:01 PDT 1993 -- mann@src.dec.com

* Added code to deal with "wild" games on ICS.  This includes allowing
castling with the king on d1 or d8, which is allowed in wild(1) games
if the king started there.  Notation is o-o to castle "short"---to
whichever side the king is closer to---and o-o-o to castle "long."
Right now wild castling is always allowed by xboard; we rely on ICS or
gnuchess to reject it when we aren't really in wild mode.

* memcpy call had arguments in wrong order.

* Removed April Fool code

2.1, patchlevel 10 -- Mon Feb 15 10:19:31 PST 1993 -- mann@src.dec.com

* Avoid trying to select on a pipe when using System V.  Needed to
copy some code from InitChessProgram() up into establish().

* Bug fix in disambiguating pawn moves like "ed".

* Fix to error handling in ReceiveFromProgram.

* Bug fix: entering EditPosition mode with black to play highlighted
White's clock instead of Black's.

* Added telnetProgram resource in case "telnet" is not the name of the
telnet program.

2.1, patchlevel 9 -- Fri Jan 22 19:08:27 PST 1993 -- mann@src.dec.com

* Entering Force Moves mode clears "flag has fallen" messages from display.

* ICS host name can now be in numeric format; for example 128.2.232.4.

* Bug fix: LegalityTest was failing to test whether a pawn move was
illegal because the move would discover a check.

* Handle ICS message "mann asserts a win over manntest, who disconnected."

* Bug fix: A recent change to PromotionCallBack had broken
underpromotion to a knight.

* Bug fix: In EditPosition mode, dragging a piece onto a square border
would make it vanish.  xboard wasn't distinguishing this case from
dragging the piece off the board.  Thanks to Matthew Kidd.

* Removed "static" declaration from yywrap for compatibility with IRIX
version of lex.  Thanks to stiller@blaze.cs.jhu.edu.

* Added substitutes for bzero, bcopy, and gethostname for Solaris
SVR4.  Thanks to Michael Grant.

* Bug fixes to queen move disambiguation.  Bugs showed up only when
promotion resulted in more than one queen on the board.

2.1, patchlevel 8 -- Fri Dec 11 17:54:18 PST 1992 -- mann@src.dec.com

* parser bug fix: It now really works to leave off the piece a pawn is
promoting to and let it default to queen.

* When starting to observe or play an ICS game, don't draw board in
initial position and then immediately redraw it in the current
position.

* Handle ICS messages when an "abuser" forfeits a game by
disconnecting and when a game is aborted ("removed") by an
administrator.

* Bug fix: A user move when in LoadGame+Pause mode was resuming the
game load instead of putting us in force mode.

* It seems that crashes inside sscanf when xboard is compiled with gcc
(as on IBM PS/2 AIX, mentioned below, and also on VAX Ultrix 3.1) are
caused by an incompatibility between gcc and the sscanf implementation
on these platforms.  A workaround is to specify -fwritable-strings to
gcc (see the gcc documentation).  Added info on how to do this to the
Imakefile.  Thanks to Tom McConnell for this information.

* Clocks are allowed to go negative.  This is mostly for ICS
compatibility, but it affects gnuchess mode too.  Also, we give the
time bonus when a player hits the time control boundary even if his
flag is already down.  This choice is a bit debatable, but it makes
things look better when you are in TwoMachines mode and gnuchess's
time management screws up causing it to exceed its time limit.

* Implemented move legality checking code.  Moves made with the mouse
or parsed from a file are checked for legality before being made.
This is mostly in preparation for future extensions, such as
human-human play.  For now it makes -noChessProgram mode more useful.

* If the user takes back moves, we restore the clocks to the earlier
settings.

* We now handle the output of the ICS oldmoves command, including
parsing the game end condition.

* Added autoCallFlag mode.

* Fixed glitches in the medium size outline king and rook bitmaps, and
touched up the medium size solid king and outline queen.

* bug fix: DisplayMove would not display backwardMostMove - 1.

* Added CallFlag button and removed AcceptMatch.  CallFlag is more
important with new ICS, and accepting the current match offer is easy
with the new ICS command "accept" (can be abbreviated "ac").

* LoadGame and LoadPosition display tail of file name (plus index
number, if any) as title.

* MachineWhite, MachineBlack, and TwoMachines now work properly from
LoadGame and LoadGame+Pause mode.

* Use o-o and o-o-o to castle on ICS, not 00 and 000.

* Stripped out code for old ICS messages; new ICS is now installed.

* Bug fix: don't offer autosave when paused during LoadGame.

2.1, patchlevel 7 - Fri Dec 11 17:40:56 PST 1992 - mann@src.dec.com

* Track change to "Illegal move" message in new ICS.

2.1, patchlevel 6 -- Tue Dec  8 10:48:44 PST 1992 -- mann@src.dec.com

* Kludged around bug in keeping comment popup where you put it by
adding borderXoffset and borderYoffset resources that give the width
of the borders added by the window manager.  Yucch.

* Changed searchDepth kludge back to using "help" instead of "bd"; the
latter didn't work because the output contains a line starting with
"White", so we think gnuchess is telling us that White won.  Oops.

* Removed some code that uses an X11R5 feature, XrmGetDatabase.
Without this, the auto font sizing code is harder to make work, so to
keep my sanity I had to change it to affect only the fonts that appear
in the main window and the comment popup, not the other popups.  Maybe
this is better anyway.

* AcceptMatch button now works after a counterchallenge, too.

* Added code for more variants of messages about games being adjourned
or aborted.  These messages need to be unified in new version of ICS.

* Added workaround for minor bug in ICS; game number on first board
can be wrong.

* Removed code to say "refresh n" instead of "refresh"; was broken and
wasn't needed anyway.

* Added missing casts for compilers that distinguish enums from ints
and missing cast in connect call.

* Added code to recognize "both sides are out of time" draw message
proposed for next version of ICS.

* Thanks to Danny Sleator and Joe Peterson for bug reports.

2.1, patchlevel 5 -- Sun Dec  6 19:52:40 PST 1992 -- mann@src.dec.com

* Removed gcc and CDEBUGFLAGS from Imakefile.

* Corrected setting of mode to ForceMoves when game file ends or
contains an AmbiguousMove or BadMove.  Previous bug was harmless.

* Added AcceptMatch button and mention of 50-move rule for Draw button
to man page.

2.1, patchlevel 4 -- Sun Dec  6 02:55:42 PST 1992 -- mann@src.dec.com

* Now handles revised messages from new version of ICS.  New ICS is
not released yet, so this code might change further.  Next patchlevel
will remove support for old ICS; both are there now.

* Initial processing for a new game being watched or played now
happens when we see the first board image.  Removes the need to parse
some messages and unifies some code.

2.1, patchlevel 3 -- Tue Dec  1 19:40:40 PST 1992 -- mann@src.dec.com

* Handles ICS messages "Draw : neither player has mating
material" and "Draw : White has no material, Black has no time."

* Added AcceptMatch button for ICS mode.

* Fixed bug in previous fix to yylexstr().

* Fixed bugs in code for loading old position files that don't start
with "#" and for handling case where user asked for nth position in
file but there aren't that many.

* Handles ICS message "* has restored your old game"

* ResetProc always clears title line now.

* Don't issue just "refresh" when watching a game; use game number.
Upcoming new version of ICS may need this.

* Added code to try to prevent user from watching and/or playing more
than one game at a time.  There is a race condition inherent here; if
we get more than one board from the game before our command to stop
watching it takes effect, we'll think the user started it again.  Not
clear how to fix this.

* Redid ParseBoard8 to use sscanf.  Code is a good deal cleaner now.
Also, we now parse out the game number too, though we don't make much
use of it yet.

* (Tried to put in a feature that recognizes the current game in a
game file must have ended when we see the start of a new one, but had
to disable it because we have too many false hits with the current
parser, especially in gnuchess listing files.)

* Moves read from game files or received from ICS are now translated
into canonical algebraic form just like all other moves.  Minor nit:
If you use Reset while playing or observing a game in ICS mode, the
game history (including the current board position) is lost, so the
next move of the current game can't be translated.

* Default fonts now vary with board size, and are chosen by pixel size
instead of point size (since piece bitmaps have a fixed pixel size).

* Bug fix: An extra Forward was required to skip over time indications
in game files.

2.1 patchlevel 2 -- Fri Nov 27 23:30:00 PST 1992 -- mann@src.dec.com

* If you move the comment popup, the next time it pops up it will come
back where you put it.

* Fixed yylexstr() so calls to it can be interspersed with calls to
yylex().

* Fixed bugs in Forward/Backward while in LoadGame mode.

* Changed Save{Game,Position} functions to append instead of
overwriting if file exists.  Changed Load{Game,Position} functions to
deal with multiple games/positions per file.

* Changed load{Game,Position}File resources to trigger automatic load
on program startup.  Changed save{Game,Position}File resources to
trigger automatic save after every completed game and on program exit.

* Added autoSaveGames mode.

* Fixed bug with PromoPiece in call to MakeAlg from MakeMove.

* Many changes to get rid of picky compiler warnings and generally
clean up the code.

2.1 patchlevel 1 -- Fri Nov 27 02:45:00 PST 1992 -- mann@src.dec.com

* A last minute change before patchlevel 0 went out broke
ParseGameHistory().  Immediately fixed in patchlevel 1.

Version 2.1, patchlevel 0 -- Fri Nov 27 02:00:00 PST 1992 -- mann@src.dec.com

* Uses "time" command of gnuchess 4.0 and following to keep clocks in
sync.  Still works with older versions without this command; we test
whether the command is present the first time each chess program is
started.

* File name dialog pops up under the mouse cursor, so that it's got the
keyboard focus if the window manager is using pointer focus.

* Attempts to move the wrong color piece or an empty square are filtered
out in xboard instead of being passed on to GNU Chess or the ICS.

* The reason a game ended is now remembered even if you move backward
and forward after it ends.  It is forgotten only if you make a move
(which is as it should be---this is now a different game, which hasn't
ended yet).  The message saying why the game ended no longer wipes out
the last move.

* Pause, Backward, Forward, ForceMoves, and EditPosition now work from
TwoMachines mode.

* Forward and Backward now change only the board display unless you
are in ForceMoves mode.  Pause mode keeps new moves that are received
from being displayed on your screen until you unpause (or use
Forward).

* Added option to ring the bell after opponents' moves.

* Saved games that start from other than the standard initial position
now begin with a postion diagram as in saved position files.  The
loader is modified to understand such save files.

* Improved error checking when trying to read from gnuchess.

* Parser understands things that look like time indications, e.g., (0:12),
instead of popping them up as comments.

* Send "quit" to gnuchess before trying to kill it.  I needed this
locally because sending a SIGTERM to rsh was not killing the remote
program on some internal field test systems we have.

* Merged in code from John Chanak to make xboard a front end to the
Internet Chess Server, and added several improvements of my own.
(These include parsing end of game messages, loading the current state
and previous history of a game that's joined in progress via "watch"
or "load", automatic switch from board style 1 to 8 when needed,
removing irrelevant buttons and adding some new ones, adding the
useTelnet and gateway resources, and miscellaneous code cleanup, bug
fixes, and documentation.)  Many thanks to John for writing and
contributing the initial version of this code.

Fri Oct 30 20:16:40 PST 1992 (patchlevel 25) mann@src.dec.com

* gnuchess now castles by sending us "o-o" or "o-o-o" (starting with a
preliminary version of 4.0.pl60 that I have).  Added code to handle
this.  The old format ("e1g1", etc.) still works too.

* Added code to format moves in normal abbreviated algebraic notation
(for example, e4, exd4, f8Q, Nf6, 0-0) instead of coordinate algebraic
(for example, e2e4, e3d4, f7f8q, g1f6, e1g1).  Moves entered with the
mouse or received from gnuchess are translated into this canonical
format for display on the message line or in saved game files.  Moves
read from game files are not translated, however; they are shown and
saved just as they appear in the file.

Mon Sep 14 13:19:01 PDT 1992 (patchlevel 24) mann@src.dec.com

* It's not really correct to write an ep capture of a pawn on e5 as
fxe5; this should be written as fxe6 because e6 is where the capturing
pawn ends up.  Nevertheless, the parser now interprets fxe5 as the ep
capture f5xe6 unless there is a pawn on f4, in which case it
interprets fxe5 as f4xe5.  By design, the parser does not flag fxe5 as
ambiguous if there are pawns on both f4 and f5; instead it prefers the
more legitimate f4xe5 interpretation.

* A move like fxe6 or fe6 is now interpreted as an e.p. capture of the
pawn on e5 if there is one there and e6 is empty.

* A move like fxe5 can no longer be interpreted as an e.p. capture if
there isn't a pawn on e5 to be captured.  Previously this could happen
erroneously if there were pawns on both f4 and f5, and the f4 pawn was
capturing a piece on e5.

* The parser no longer munges the move it is parsing; in the past, for
instance, it would remove the "x" from a move like dxc5 before echoing
it to the screen.

* The parser now detects when a move is ambiguous and returns an
error, instead of arbitrarily choosing one possibility as it used to.

Mon Aug 10 18:40:47 PDT 1992 (patchlevel 23) mann@src.dec.com

* Added code so parser can handle fully qualified algebraic, e.g.,
Ng1-f3, N/g1-f3, Ng1f3, or even Pe2-e4.  The "P" and "/" work only for
fully qualified moves, not generally.

* Fixed parser bugs in handling moves with rank or file disambiguator,
e.g. N1f3 or Ngf3.

Mon Jul  6 17:55:32 PDT 1992 (patchlevel 22) mann@src.dec.com

* AIXV3 patch from Tom McConnell; thanks!

* After hitting the Backward button we see the last move made instead of
the word "Pausing" displayed.

* Fixed a couple of problems compiling on IRIX; thanks to Michel Arsenault
and Alan Walsh for bug reports and help with fixes.

* Added optional display of algebraic notation coordinates along left and
bottom edges of board.  This was inspired by some code from Jean-Christophe
Engel; thanks!

* Swapped EditPosition and Pause buttons to reduce danger of losing the
game in progress by hitting EditPosition when you wanted Backward.  Thanks
to Ove Lundberg for complaining (though it bugged me too).

* Despite one complaint, I kept the feature of changing both clocks when black
makes time control, rather than changing each individually when the player
involved makes it.  This is to avoid having it look like White is way ahead on
time while Black is thinking about the last move of the time control period
(i.e., when White has made time control but Black hasn't yet).

* Corrected clocks to work as in real tournaments.  Time is *added* when you
reach time control; previously the clocks were simply set to the length of the
new time period.  Also, when a player's flag falls, he still does not receive a
new time allotment at the next time control, but his opponent does still
receive more time if *his* flag has not fallen; previously, time controls were
ignored for both players if either flag fell.  I forget who reported this bug.

* Added a small ESIX patch from Kayvan Sylvan.

Mon Jun 22 13:24:38 PDT 1992 (patchlevel 21)

* Added some SVR4 support code from Ronald Cole.  It's Greek to me.

* Note:  Stephen Meatheringham reports a bug causing xboard to crash with an
error from the X server when run on a Sun Sparcstation IPX with Solaris 1.0.1
and OpenWindows 3.0.  This bug has not been tracked down yet.

* Fixed a problem with ATTENTION code.  On some operating systems, you have to
be even more cautious about when you send a SIGINT to gnuchess, because the
signal handler gets deinstalled each time it is used, and gnuchess does not
reinstall it immediately.  In particular, if you send a SIGINT and make an
illegal move or ask for a hint, gnuchess does not reinstall the handler until
*after* you make your next move, so you had better not send a SIGINT before
it.  I put a workaround for this case into xboard; I hope there are no more.

* The ATTENTION code is needed when compiling for the ESIX operating system,
because ESIX has a bug in the FIONREAD ioctl, so the code in gnuchess that
lets you interrupt its thinking on your time just by typing in your move does
not work.  Perhaps gnuchess will have a workaround for this eventually.

* Fixed yet another bug in using XtGetValues; code to inhibit shell resizing
was leaving a null pointer as the place to store the current sizes.

* Man page fixes: corrected -sl to -sd, updated LIMITATIONS.

* Added include of <sys/time.h> conditional on HAS_GETTIMEOFDAY.  I hope this
works for all systems; on mine, <time.h> and <sys/time.h> are the same file,
but with an #ifndef that makes it harmless to include both.

* Thanks for reports from Mike Pearlman, Stephen Meatheringham, Kayvan Sylvan,
d87-mal@nada.kth.se, Urban Koistinen, and Ronald Cole.

Mon Jun  8 11:39:18 PDT 1992 (patchlevel 20)

* Documented default value of initString and explained what it means.  This
paragraph also serves to inform the user that xboard by default will tell
gnuchess to think on his time, something one user apparently didn't understand.

* Redid -searchDepth (formerly -searchLevel) and -searchTime code.  They both
work correctly with gnuchess 3.1 now.  The -searchDepth option also works
correctly with gnuchess 4.0.  The -searchTime option does not work with
gnuchess 4.0.pl50 or earlier because those gnuchess versions do not have a
working searchTime feature.  Instead of having xboard do a half-baked emulation
of this feature by using a 1-move time control, I will be submitting a patch to
the gnuchess folks to restore the feature as in 3.1.

* Improved clock code.  It now keeps accurate track of fractional seconds of
clock running time, if your system has gettimeofday(); if not, it is generous
about them---if a clock has been going for n.m seconds when it is stopped, only
n seconds are charged.  Previously, xboard would charge one second immediately
when a clock was started, so if n.m had elapsed when it was stopped, n+1 would
be charged.  This should stop xboard from thinking gnuchess has let its flag
fall on the last move of a time control, as it often did before.  I also
improved the comments and condensed the code a little.  I hope there are no
systems that have X11 and don't have gettimeofday(), but if there are, I'd like
to know what to replace it with.

* "Flag dropped" messages now show up on the top line, beside the clocks, so
that they don't obscure more interesting messages on the second line.

* Fixed confusion of NULL and '\000'.

* Include time.h to get ctime() declaration.

* Fix to "parser bug" messages in parser.l.

* Changed code to work with old-fashioned tolower() macro that requires its
argument to be an uppercase letter.

* Minor fix to some usage error messages; was reversing program name and
erroneous argument value.

* Thanks to Mitch Wright, Ranier Orth, and Henrik Schmiediche for bug reports.

Fri Jun  5 13:06:08 PDT 1992 (patchlevel 19)

* Note: xboard does not seem to work when compiled with gcc 1.40 on a
PS/2 running AIX.  It crashes at the sscanf in line 768 of xboard.c.
You can work around the problem by specifying the -timeControl option
on the command line instead of defaulting it.  This does not seem to
be a bug in xboard itself; it runs okay on PS/2 AIX when compiled with
MetaWare High C.  [But see 2.1.pl8 above.]

* Removed bogus files from distribution.

* Changed variable name that conflicted with SVR4 ttyname function.

* Thanks to Christoph Strozyk for another bug report, and to several
of the folks mentioned under patchlevel 18 for testing it.

Wed Jun  3 17:50:37 PDT 1992 (patchlevel 18) mann@src.dec.com

* Added an include of sys/fcntl.h to pick up the definition of O_RDWR for
System V users.

* Fixed a bug in CatchPipeSignal; was testing the wrong variable to determine
which chess program got the signal.

* Removed the declaration of strrchr, which was causing problems for some
people, and added an include of <string.h> or <strings.h> instead.

* Fixed a bunch of type errors uncovered by compilers that check more carefully
than the one I was using.  I just patched many of them with casts---typically
cases where a function didn't take the same number and type of arguments as the
X header file prototype said it should---because I didn't see any other way to
fix them.  The versions of the X header files that I have don't actually have
full prototypes for these function types; they declare only the return type and
just give the argument types as comments.

* InitChessProgram returns immediately if chess program died while we were
waiting for it to say "Chess".  I think this fixes a bug that could make xboard
crash or go into an infinite loop printing "Warning: Select failed; error code
9" if gnuchess crashed there.

* Removed code that tries to put the file descriptor used to read messages from
gnuchess into nonblocking mode.  I don't see how this kludge could ever have
fixed the problem it was intended to (see below), and it seemed to be causing
a race condition when we were waiting for the initial message from gnuchess
after it started up.

* Thanks to Richard K. Lloyd, Konstantinos Konstantinides, Mark
Seiden, Erik Schoenfelder, Andreas Stolcke, Rainer Orth, Henry Thomas,
and Kris Van Hees for bug reports and help with fixes.

Sun May 31 08:00:00 PDT 1992 (patchlevel 17) Bart Massey bart@cs.uoregon.edu

*  'xboard' suffered from a couple of serious bugs.  An initial
   size needed to be given to the message label to avoid a race
   condition (!) so I gave it some text (otherwise occasionally
   xboard would fail because the message widget was 0 width under
   MIT X11R4).  The sizes needed to be Dimension, not int, because
   they were written in by Xt -- on my big-endian box Dimension
   is short, causing chaos.  Also, I hacked a declaration in for
   strrchr() to shut the compiler up -- this is arguably a kludge,
   but I couldn't think of anything better; maybe you can.

Fri May 22 13:40:50 PDT 1992 (patchlevel 16)

* First real (non-beta) release of version 2.0.

* Added GNU copyleft notices covering version 2.0 enhancements.

Thu May 21 12:30:09 PDT 1992 (patchlevel 15)

* Removed -g from Imakefile.

* Added casts in parser.l to prevent warning messages from some C compilers.

* Bugfix: code to exit if chess program couldn't be started had bug in error
message printing.

Tue May 19 11:58:06 PDT 1992 (patchlevel 14)

* Fixes one small bug: If LoadGame does not find a game in the file, it resets
xboard to BeginningOfGame mode (as if the Reset button was pressed), instead of
leaving it in LoadGame mode.

Mon Apr 13 18:32:27 PDT 1992 (patchlevel 13)

* Improved error handling when gnuchessx crashes.  Now displays a message and
enters EndOfGame state without exiting.  This should help with diagnosing
gnuchessx problems, since the position and move history are not lost.

* Debugged man page.

Version 2.0 -- Thu Apr  2 16:04:54 PST 1992 (patchlevel 12)

* Added small 40x40 pixel pieces; board size now specified as small, medium, or
large.

* Improved man page.

* Saved position files now say "white to play" if it's white's move.

* SavePosition while in EditPosition mode now gets side to play right.

* Made "Pawn" the default on edit position menus.

* Removed "To play" from edit position menus, since it's redundant.  Left
support code in so it can be restored if someone wants it.

* Tightened parser's definition of a move number to help further with skipping
over stuff before the first move.

* Put back feature of skipping over stuff in game files before a start of game
marker.  This helps when loading electronic mail messages that have things
like "00" in the header (looks like castling), or that talk about moves in
running text before the actual game score.  Tradeoff is that we can't load
games that don't either have move numbers or say "gnuchess game" just before
the moves.

* Changed version number to 2.0 because others have used "1.3" for patched
versions of 1.2.  Display version number and patchlevel at startup.

Thu Apr  2 15:30:22 PST 1992 (patchlevel 11)

* Bugfix:  Match started with TwoMachines button now handles the case where
user loaded/edited a position *and* forced some moves.

* added error message feedback to many cases where the user's button press is
rejected because it isn't allowed in the current mode.

* added -noChessProgram option to allow use as a passive chessboard without
gnuchess, replacing old buggy scheme that tried to do this automatically when
gnuchess was not found on the search path.

* parser accepts "=" in front of promotion piece

* parser accepts ":" notation for captures

* Removed SwitchSides button to make room for EditPosition.  Left code in
place, ifdef'ed out.

* Added EditPosition mode.

* Reformatted xboard.c to eliminate long lines.

* Promotion popup now appears near rank to which pawn is moving.

* UI improvement: Button representing current program mode is kept highlighted.

* Bug fix:  Hint button is now disabled when machine is on move.

Sat Mar 21 14:57:37 PST 1992 (patchlevel 10)

* TwoMachines now works from MachineWhite or MachineBlack mode.

* ForceMoves and Backward/Forward now work at the end of a game started by
the TwoMachines button.

* Sends o-o or o-o-o to gnuchess instead of O-O or O-O-O.

* Bug fix:  SwitchSides button is now disabled when machine is on move.

* Added -searchLevel option and corrected handling of -searchTime to reflect
the way gnuchess really handles command line options instead of what the
documentation used to say.  Allowed optional ":seconds" on times.

Tue Mar 17 21:00:35 PST 1992 (patchlevel 9)

* Removed non-working code that tried to recover when a remote chess program
could not be started; now exits with a message instead.

* Now waits for chess program to print its first message (normally "Chess")
before sending it any commands.

* Matches between two machines can now start from a black-to-play position or
black-to-play opening.

* Bug fix: The program would sometimes lose track of the board position after
the end of the game, drawing a board full of white pawns next time it got an X
redraw request.  Now fixed.

* Cleaned up handling of illegal moves in game files.  Now we just stop reading
and go into ForceMoves mode.

* Saved games against gnuchess indicate who won (restored and debugged 1.2
feature).

* Setting -searchTime turns off -clockMode.

* My trick for setting up a black-to-play position broke in the transition from
gnuchess 3.1+ to 4.0.  Installed a different trick that works with both.

* Bug fix: Was clobbering memory by mallocing one byte too few for the file
name in SetupPositionFromFileProc.  This usually resulted in a crash on the
second attempt to load a position from a file.

Mon Mar 16 16:49:00 PST 1992 (patchlevel 8)

* Game and position files are saved in CHESSDIR as well as loaded from there.
We actually chdir there, so gnuchess listing files also wind up there.

* Underpromotion moves from gnuchess really work now.

Sat Mar 14 14:55:24 PST 1992 (patchlevel 7)

* Cleaned up lots of bugs and kruft in parser.l.  It's a wonder the old version
worked at all.  Improved rejection of random text interspersed with the moves.

* Relabeled buttons to reduce confusion (Play From File --> Load Game;
Setup From File --> Load Position).

* Bug fix:  Doesn't exit at the end of a game that was started by pressing
the Two Machines button.

* Bug fix:  Doesn't get confused if you hit Machine Black (White) while
the machine is already playing black (white) and is on move.

* Prints "White to play" or "Black to play" after loading a position file.

* Bug fix:  No longer hangs if no start-of-game is found in a game file.

* More permissive about game file format.  The first line is not assumed
to be a header comment unless it starts with "#".  We don't insist on
seeing a "1." before the first move.

* Added pop-up dialog to allow underpromotion.  Moving a pawn to the last rank
pops up a dialog to let you select what piece to promote to.  Also added code
to handle underpromotion moves from gnuchess or from a game file correctly.

* Added code to send SIGINT to gnuchess before trying to move, if gnuchess
might be busy thinking on our time.  The code is ifdef'ed out because it's
not necessary; only beta-test versions of gnuchess 4.0 at patchlevel 19 or
below require it.

Mon Feb 24 20:10:22 PST 1992

* Merged fixes received from Stuart Cracraft and Mike McGann, to iconic mode
and to ShutdownChessPrograms.  (They both sent the same fixes.)  I did not
install the change that removed "easy" from the initialization string, so
xboard will still try to run gnuchessx in "hard" mode (thinking on opponent's
time) by sending this command.

Version 1.3 -- Thu Dec 19 18:19:00 PST 1991  mann@src.dec.com (Tim Mann)

* I've fixed a slew of bugs in this version of xboard:

* You can now back up from the end of a game, even if gnuchess was playing
against you.  Since gnuchess exits upon mate or draw (when it's not in force
mode), this feature works by starting up a new copy of gnuchess and feeding it
the saved starting position and moves.  Drawback: the new gnuchess starts with
clocks at the beginning of a fresh time control.

* Note: the "force" command to gnuchess is a toggle.  I fixed a couple of
places in xboard where "force" was being issued when gnuchess was already in
force mode, which resulted in chaos.  I don't know if they were in 1.2 or if I
added them myself in the course of putting in new features.

* ForceMoves button is now legal in PlayFromFile mode.  It closes the game file
and lets you force moves (or go Backward) from whatever position you've
reached.

* The parser now recognizes "white resigns" and "black resigns" (in any
combination of upper and lower case, with or without the closing "s").  These
used to be misinterpreted as meaning "white wins" or "black wins" respectively!
Added "1 - 0" and "0 - 1" as equivalents for "1-0" and "0-1".

* I removed the parser feature of considering "!" as a comment delimiter.
"!" is so common as an annotation in game scores that this feature seems like a
very bad idea.

* Added a wait() after each successful call to kill() to avoid leaving zombie
processes around.

* Removed the feature of putting an indication of how the game ended into the
internal move list when playing from a file.  The only benefit of this was that
it would get written back out if you saved the game at that point.  This
feature doesn't seem too useful, since you are unlikely to save a game you've
read in without making any changes, and it caused a lot of problems in the code
and user interface.  The end condition is still displayed as a message when
it's first read in from the file.  End conditions when playing against gnuchess
are still saved, too.

* programName is now the last file name component of argv[0], not all of it.

* xboard.c got three compiler warnings due to arguments that didn't match the
prototypes on X toolkit functions.  I got rid of them by adding some casts, and
adding extra unused arguments to the ReceiveFromProgram function.

* As I received it, the distribution had an extra period glued on the front
of every line that started with a period.  This broke the manpage in an
obvious way.  It also broke parser.l in a nonobvious way that stopped
PlayFromFile from working.

* Fixed one or two bugs where the clock was started when it shouldn't have
been.  I think one example was if you tried an illegal move in ForceMoves mode.

* Now starts the machine's clock if you hit MachineWhite when white is on move
or MachineBlack when black is on move.

* Now updates the to-move indicator (highlight on clock display) when you use
Forward/Backward or ForceMoves.

* gnuchess 3.1+ has a bug that makes it try to think on its opponent's time
even when in force mode; this causes problems with xboard's SetupFromFile
command because gnuchess's saved hint move is garbage after the new position is
loaded, so gnuchess prints out an error message when it tries to think about
what it would do if the user made this move.  Here is a patch for gnuchess
3.1+:

*** nondsp.c~   Mon Dec  2 12:37:18 1991
*-- nondsp.c    Thu Dec 19 15:36:06 1991
***************
*** 1223,1229 ****
    ok = flag.quit = false;
    player = opponent;
    ft = 0;
!   if (hint > 0 && !flag.easy && Book == NULL)
      {
        fflush (stdout);
        time0 = time ((long *) 0);
*-- 1223,1229 ----
    ok = flag.quit = false;
    player = opponent;
    ft = 0;
!   if (hint > 0 && !flag.easy && Book == NULL && !flag.force)
      {
        fflush (stdout);
        time0 = time ((long *) 0);

* SavePosition/SetupFromFile now handle black-to-play positions.  If it's
black's move in a saved position, the line "black to play" is printed
immediately after the board display.  Upon loading a position, xboard
looks for "black" at the beginning of this line to determine whether it's
black's move.

* SetupFromFile now leaves you (effectively) in ForceMoves mode.  This
eliminates some cases where the program would get into an inconsistent state,
and hopefully is more intuitive for the user, too.

* PlayFromFile now leaves xboard in ForceMoves mode after playing through all
the moves in the file.  You can use Backward/Forward, make moves, get gnuchess
to join the game with MachineWhite or MachineBlack, etc.  The game file can end
with either white or black to play.

* Backward/Forward now seem to work in all cases.  Previously using these
buttons during a game against the machine would get xboard out of sync with
gnuchess's idea of what was going on, resulting in chaos.  Now using these
buttons puts xboard in ForceMoves mode; you can bring gnuchess back into the
game using the MachineWhite or MachineBlack buttons.

Thu Jun 27 15:06:25 PDT 1991

  * Remove comment popups during a reset.

  * Bug in my forward move fix.  Didn't work for playgamefile mode.

Thu Jun 20 15:04:06 PDT 1991

  * Can't do a backward move when it isn't your turn because gnuchess
    gets confused.  Similar bug for forward move.  Do a bunch of moves,
    back up move and go forward.  These get filtered out now.

  * Put easy back into the initString.  This DISABLES easy mode which by
    default is ON.

  * New-line wasn't always being added to forward move strings sent to gnuchess.

  * Parsed comments as [ ..............text follows ] into d7d5

  * Long game file comments cause core dumps on HP systems.

  * Multiple uses of the get positition file button got confused
    on the second click.

  Minor fixes to the 1.2 release

Version 1.2 -- Tue Jun 11 17:14:12 PDT 1991

  * For version 1.2, Jeff Kenton, Richard LLoyd, David Jensen, Martin D.,
    Bill Schmidt, Scott Hemphill, Paul Vaughan and Bill Shauck all found
    a lot of bugs that we put into xboard just to see if they were paying
    attention.  They were.

  * Changed the protocol that xboard uses to work with the new version of
    gnuchessr.

  * There was an off by one error with the clock resetting code.  Also,
    the clock display highliting was wrong.  Thanks to Bill Shauck for
    pointing these out.

  * enumerations are not really integers on some C compilers.  I added casting.
    The new version of gnuchess expects the "go" command for two machine
    and machine plays white cases.  The whiteString resource is for
    compatibility with previous gnuchess versions which get confused by go.
    Thanks to Martin D. for catching these.

  * Fixed a bug where the checkmate message wasn't being parsed and xboard
    kept playing.  Also, the message was added to game file if saved.
    Thanks to Scott Hemhill for pointing this out.

  * Fixed a bug where saving a long game, resetting and saving a short game
    resulted in appending the end of the long game to the short one.
    If a game is just being played out and there is no reason for gnuchessr
    to be used, ignore pipe signals.  This allows people to use xboard
    as a chess board without need for gnuchess.  Also, trivially bad moves
    such as e2e2 are not passed on to gnuchessr but instead ignored out of
    hand.  This allows people using xboard as a chessboard with gnuchessr
    to pick a piece up, think and put it back down without making a move.
    Thanks to Jeff Kenton for pointing these out.

  * Added the CHESSDIR environment variable.  Game and position files are
    found in this directory.  If this variable is not declared, then the
    current directory is used.  File names starting with / are treated
    specially.

  * The bitmap file names were changed so that none exceeded 14 characters.
    This is necessary for R5.

        fcntl(from_prog[0], F_SETFL, O_NDELAY);

    The xboard fix was to set non-blocking i/o on the read pipe for gnuchessr

        printz ("Illegal move (no matching move generated)");

  * fixed a problem with the new version of gnuchessr where xboard wasn't
    getting gnuchessr error messages for illegal moves.  The problem seems
    to be fixed *without* any gnuchess changes but this is likely to be
    highly system dependant.  There should be a new line on line 246 of nondsp.c

  * -iconic doesn't work at all now.  The Iconify() does work.  This was
    a tradeoff and it is really an Xt bug.

  * Fixed a compiler warning for gcc and an error for the IBM RT compilers.
    This is the VOID_PROC macro in xboard.h.  Thanks to David Jensen for this.

  * If the DisplayWidth or DisplayHeight is less than 800, use small size mode.
    Also the size of the name widget was reduced from 500 pixels to 400 pixels
    because in small size mode there was a gap on the right.
    Changed the default font from fixed to helvetica_oblique14 to:
        **-helvetica-bold-r-normal--14-*-*-*-*-*-*-*
    helvetica_oblique14 is a font alias not on all R4 systems.
    Curiously enough, the 17 point is not available on 75dpi systems
    and the 18 point font is not available on 100dpi systems.
    Thanks to Richard K. Lloyd for pointing these out.

  * Minor hacks to work with R5 alpha.  Had to add an event handler to the
    boardWidget to get translations to work.  This may go away with the real R5.
    Added <Message>WM_PROTOCOLS: QuitProc() for R5 ICCCM compatibility.

  * If the first character of the file is not `1' then the first line
    of a game or position file is displayed as the name in a label widget.

  * Added a PopUp dialog for getting file names.

  * Modified the code to use the R4 routines rather than R3 compatibility.

  * Changed the forwards/backwards/readgamefile code to allow a play to step
    back and forth in a game.  If he steps all the way to the beginning
    he has to restart the game.  If he gets into a mated position, same problem.

  * Moved the man page from xboard.1 to xboard.man.  This makes imake man page
    installs work correctly.  Thanks to Richard K. Lloyd for pointing this out.

  * Corrected the queening code.  XBoard was sending the wrong syntax.
    It was sending for example h8(Q) when it should have been sending h8q.
    Thanks to Paul Vaughan and Mike McGann for pointing this out.

  * Added a lex parser for algebraic games.  It should be easy to use the parser
    for other interfaces such as the Microsoft Windows version.
    It parses comments of the form [anything] and ! to the end of a line.

Version 1.1 -- Mon Jan  7 14:46:03 PST 1991

  * Roger Dubar, Konstantinos Konstantinides, Wolfgang S. Rupprecht,
    Paul Scowen, Mvh Smidt and Kayvan Sylvan all helped immensely during
    beta-testing.

  * older non-ANSI versions of Sun compilers complain vociferously.

  * the remoteShell resource was added for HP-UX systems
    and other systems where the remoteShell isn't rsh.

  * -iconic doesn't work properly.  If XBoard is opened iconic then
    iconifying it later with a keystroke doesn't work.  I think
    this is an Xt bug.

  * For systems with smaller screens, XBoard can use smaller pieces,
    and a smaller board.  -bigSizeMode False uses a smaller set of pieces.
    These are scaled versions of the large pieces.  They look ok but could
    be improved.

  * getlogin() does not work in all cases.
    It was replaced by getpwuid(getuid())->pw_name).

  * Warning messages get displayed in the message box.

  * Any button restarts a paused game.

  * Kayvan Sylvan contributed a patch for ESIX.
    It seems that select() on pipes is broken on his system.  We declined
    to incorporate his patch though, because it was a work-around for
    something that was broken on one system, and selfishly, that system
    was not my own.  Nevertheless, it is likely that other System V users
    on PC's may need to use this patch and it is is included as the file
    ESIX.patch.  To use it, type

        patch xboard.c ESIX.patch

  * Fixed a bug where hint didn't work.  The local version of gnuchessr
    had been hacked.  The fix was to clone stderr and stdout for gnuchessr.

  * Fixed a bug where a player could play after a game had been finished.

  * The bitmaps have been pushed into the bitmaps directory.

  * Substantially rewrote and simplified the Two Machine code.

  * Added StrStr() because many systems don't have this ANSI function.

  * Added keyboard equivalents.  Added an iconify keystroke, C or c.

  * Works with gcc now.  gcc complained about casting float constants
    as XtPointers.

  * Detect if the visual doesn't support color.  If so, run in monoMode.
    An alternative would be to detect grayscale visual and use a collection
    of gray user interface colors.

        XBoard.clockMode:    False

  * For people who don't like or use chess clocks a clockMode switch
    has been added.  It is on by default.  It can be turned off in the
    .Xdefaults file with

  * Added a declaration, xtVersion, which will quickly break on R3 Intrinsics.

  * Hal Peterson contributed a new Imakefile.

  * Rewrote DisplayClocks().

  * Rewrote TwoMachinesPlay mode.

  * Konstantinos Konstantinides added the -searchTime option.

  * Substantially rewrote and simplified the clock code.  If a game was paused
    and then resumed, the clocks were out of sync.

  * Fixed a bug in HandleUserMove() where the user could make a move while the
    machine was thinking.  The fix detects and ignores these moves.  onMove
    was not being used and was removed.
